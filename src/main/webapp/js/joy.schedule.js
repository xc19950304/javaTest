/*! by joyone.cn 厦门展网信息技术有限公司  joyone 2015-04-30  1.0.20 */
!function(a,b){function c(a,b){var c;return 0!==a&&b>a?c=b-a:(c=a%b,c&&(c=b-c)),c}function d(a){var b=a.getMonth(),c=q(a)?R[b]:S[b];return c+a.getDate()}function e(a,c){var d,e;return a=new Date(a.getFullYear(),a.getMonth(),a.getDate()),O(a,0),d=a.getFullYear(),c!==b?(N(a,c,-1),a.setDate(a.getDate()+4)):a.setDate(a.getDate()+(4-(a.getDay()||7))),O(a,0),e=Math.floor((a.getTime()-new Date(d,0,1,-6))/864e5),1+Math.floor(e/7)}function f(a,b){var c=P(a).getDay(),d=7-(c+7-(b||7))||7;return 0>d&&(d+=7),Math.ceil((a.getDate()-d)/7)+1}function g(a,b){return a+(b>a?7:0)}function h(a,b,c){var d=b.offset;if(!d)return f(a,c);var e=new Date(a.getFullYear(),a.getMonth()+1,0),h=f(e,c),i=g(b.day,c),j=i<g(new Date(a.getFullYear(),a.getMonth(),1).getDay(),c),k=i>g(e.getDay(),c);return 0>d?d=h+(d+1-(k?1:0)):j&&(d+=1),h-=k?1:0,(j?1:0)>d||d>h?null:d}function i(a,b){return f(new Date(a.getFullYear(),a.getMonth()+1,0),b)}function j(a,b,c){return f(a,c)===h(a,b,c)}function k(a,b,c){for(var d,e,i,j,k=g(b.getDay(),c),l=a.length,m=[],n=0;l>n;n++)if(e=a[n],j=f(b,c),d=h(b,e,c),null!==d)if(d>j)m.push(e);else if(j===d)if(i=g(e.day,c),i>k)m.push(e);else if(k===i)return null;return m}function l(a,b,c){for(var d,e=0,f=a.length,g=[];f>e;e++){if(d=a[e],c&&(d=c(d)),b===d)return null;d>b&&g.push(d)}return g}function m(a,b){for(var c,d=0,e=a.length;e>d;d++){if(c=parseInt(a[d],10),isNaN(c)||c<b.start||c>b.end||0===c&&b.start<0)return null;a[d]=c}return a.sort(r)}function n(a){for(var c,d,e,f=0,g=a.length;g>f;f++){if(c=a[f],d=c.length,e=c.substring(d-2).toUpperCase(),e=V[e],e===b)return null;a[f]={offset:parseInt(c.substring(0,d-2),10)||0,day:e}}return a}function o(a){for(var b,c,d=0,e=a.length,f=[];e>d;d++)b=a[d],"string"==typeof b?c=b:(c=""+U[b.day],b.offset&&(c=b.offset+c)),f.push(c);return f.toString()}function p(a){var b=a.getMonth();return 1===b?1===new Date(a.getFullYear(),1,29).getMonth()?29:28:T[b]}function q(a){return a=a.getFullYear(),a%4===0&&a%100!==0||a%400===0}function r(a,b){return a-b}function s(a,b){var c,d,e=0,f=[];if(a)for(a=a.split(";"),c=a.length;c>e;e++)d=z(a[e],b),d&&f.push(d);return f}function t(b,c,d){for(var e=a.isArray(b)?b:s(b,d),f=c.getTime()-c.getMilliseconds(),g=0,h=e.length;h>g;g++)if(e[g].getTime()===f)return!0;return!1}function u(a,b){var c,d,e=0,f=[].concat(a);for(c=f.length;c>e;e++)d=f[e],d=E.timezone.convert(d,b||d.getTimezoneOffset(),"Etc/UTC"),f[e]=E.toString(d,Z);return f.join(";")+";"}function v(a,b){var c=new Date(a);switch(b.freq){case"yearly":c.setFullYear(c.getFullYear(),0,1);break;case"monthly":c.setFullYear(c.getFullYear(),c.getMonth(),1);break;case"weekly":N(c,b.weekStart,-1)}return b.hours&&c.setHours(0),b.minutes&&c.setMinutes(0),b.seconds&&c.setSeconds(0),c}function w(a,b){var c=new Date(a);switch(b.freq){case"yearly":c.setFullYear(c.getFullYear(),11,31);break;case"monthly":c.setFullYear(c.getFullYear(),c.getMonth()+1,0);break;case"weekly":N(c,b.weekStart,-1),c.setDate(c.getDate()+6)}return b.hours&&c.setHours(23),b.minutes&&c.setMinutes(59),b.seconds&&c.setSeconds(59),c}function x(a,b,c){for(var d,e,f=a.slice(c._startIdx),g=f.length,h=c.positions,i=[],j=0,k=h.length;k>j;j++)d=h[j],0>d?d=g+d:d-=1,e=f[d],e&&e.start>=b&&i.push(e);return a=a.slice(0,c._startIdx).concat(i),c._startIdx=a.length,a}function y(a,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,y,z,A,C,D,F,G,H,I=B(a.recurrenceRule,e),J=[];if(!I)return[a];if(G=I.positions,H=G?0:1,o=I.start,p=I.end,(o||p)&&(a=a.clone({start:o?new Date(o.value[0]):b,end:p?new Date(p.value[0]):b})),C=a.start,A=C.getTime(),z=Q(C),y=s(a.recurrenceException,e),!y[0]&&I.exdates&&(y=I.exdates.value,a.set("recurrenceException",u(y,e))),m=c=new Date(c),d=new Date(d),r=I.freq,F=fa[r],D=I.count,I.until&&I.until<d&&(d=new Date(I.until)),q="yearly"===r||"monthly"===r||"weekly"===r,A>c||D||I.interval>1||q?c=new Date(A):(i=c.getHours(),j=c.getMinutes(),k=c.getSeconds(),I.hours||(i=C.getHours()),I.minutes||(j=C.getMinutes()),I.seconds||(k=C.getSeconds()),c.setHours(i,j,k,C.getMilliseconds())),I._startPeriod=new Date(c),G){c=v(c,I),d=w(d,I);var K=Q(d)-Q(c);0>K&&(i=c.getHours(),d.setHours(i,c.getMinutes(),c.getSeconds(),c.getMilliseconds()),E.date.adjustDST(d,i)),I._startPeriod=new Date(c),I._endPeriod=w(c,I),I._startIdx=0}for(l=a.duration(),I._startTime=f=E.date.toInvariantTime(c),F.setup&&F.setup(I,C,c),F.limit(c,d,I);d>=c;)if(h=new Date(c),M(h,l),n=c>=m||h>m,(n&&!t(y,c,e)||G)&&(g=new Date(I._startTime),M(g,l),A!==c.getTime()||z!==Q(f)?J.push(a.toOccurrence({start:new Date(c),startTime:new Date(f),end:h,endTime:g})):(a.startTime=new Date(f),a.endTime=g,J.push(a))),G){if(F.next(c,I),F.limit(c,d,I),c>I._endPeriod&&(J=x(J,C,I),I._endPeriod=w(c,I),H=J.length),D&&D===H)break}else{if(D&&D===H)break;H++,F.next(c,I),F.limit(c,d,I)}return J}function z(a,b){return a=E.parseDate(a,W),a&&b&&(a=G.convert(a,a.getTimezoneOffset(),b)),a}function A(a,b){for(var c,d,e,f,g,h,i=a.split(";"),j=0,k=i.length;k>j;j++)if(c=i[j].split(":"),d=c[0],e=c[1],-1!==d.indexOf("TZID")&&(f=d.substring(d.indexOf("TZID")).split("=")[1]),e)for(e=e.split(","),g=0,h=e.length;h>g;g++)e[g]=z(e[g],f||b);return e?{value:e,tzid:f}:void 0}function B(c,d){var e,f,g,h,i,j,k,l,o,p={},q=0,r=!1,s=function(a,b){var c=a.day,d=b.day;return l>c&&(c+=7),l>d&&(d+=7),c-d};if(!c)return null;for(j=c.split("\n"),j[1]||-1===c.indexOf("DTSTART")&&-1===c.indexOf("DTEND")&&-1===c.indexOf("EXDATE")||(j=c.split(" ")),q=0,g=j.length;g>q;q++)i=j[q],-1!==i.indexOf("DTSTART")?p.start=A(i,d):-1!==i.indexOf("DTEND")?p.end=A(i,d):-1!==i.indexOf("EXDATE")?p.exdates=A(i,d):h=-1!==i.indexOf("RRULE")?i.substring(6):i;for(h=h.split(";"),q=0,g=h.length;g>q;q++)switch(k=h[q],e=k.split("="),f=a.trim(e[1]).split(","),a.trim(e[0]).toUpperCase()){case"FREQ":p.freq=f[0].toLowerCase();break;case"UNTIL":p.until=z(f[0],d);break;case"COUNT":p.count=parseInt(f[0],10);break;case"INTERVAL":p.interval=parseInt(f[0],10);break;case"BYSECOND":p.seconds=m(f,{start:0,end:60}),r=!0;break;case"BYMINUTE":p.minutes=m(f,{start:0,end:59}),r=!0;break;case"BYHOUR":p.hours=m(f,{start:0,end:23}),r=!0;break;case"BYMONTHDAY":p.monthDays=m(f,{start:-31,end:31}),r=!0;break;case"BYYEARDAY":p.yearDays=m(f,{start:-366,end:366}),r=!0;break;case"BYMONTH":p.months=m(f,{start:1,end:12}),r=!0;break;case"BYDAY":p.weekDays=o=n(f),r=!0;break;case"BYWEEKNO":p.weeks=m(f,{start:-53,end:53}),r=!0;break;case"BYSETPOS":p.positions=m(f,{start:-366,end:366});break;case"WKST":p.weekStart=l=V[f[0]]}return p.freq===b||p.count!==b&&p.until?null:(p.interval||(p.interval=1),l===b&&(p.weekStart=l=F.calendars.firstDay),o&&(p.weekDays=o.sort(s)),p.positions&&!r&&(p.positions=null),p._hasRuleValue=r,p)}function C(a,b){for(var c,d=a.value,e=a.tzid||"",f=d.length,g=0;f>g;g++)c=d[g],c=G.convert(c,e||b||c.getTimezoneOffset(),"Etc/UTC"),d[g]=E.toString(c,"yyyyMMddTHHmmssZ");return e&&(e=";TZID="+e),e+":"+d.join(",")+" "}function D(a,c){var d=a.weekStart,e="FREQ="+a.freq.toUpperCase(),f=a.exdates||"",g=a.start||"",h=a.end||"",i=a.until;return a.interval>1&&(e+=";INTERVAL="+a.interval),a.count&&(e+=";COUNT="+a.count),i&&(i=G.convert(i,c||i.getTimezoneOffset(),"Etc/UTC"),e+=";UNTIL="+E.toString(i,"yyyyMMddTHHmmssZ")),a.months&&(e+=";BYMONTH="+a.months),a.weeks&&(e+=";BYWEEKNO="+a.weeks),a.yearDays&&(e+=";BYYEARDAY="+a.yearDays),a.monthDays&&(e+=";BYMONTHDAY="+a.monthDays),a.weekDays&&(e+=";BYDAY="+o(a.weekDays)),a.hours&&(e+=";BYHOUR="+a.hours),a.minutes&&(e+=";BYMINUTE="+a.minutes),a.seconds&&(e+=";BYSECOND="+a.seconds),a.positions&&(e+=";BYSETPOS="+a.positions),d!==b&&(e+=";WKST="+U[d]),g&&(g="DTSTART"+C(g,c)),h&&(h="DTEND"+C(h,c)),f&&(f="EXDATE"+C(f,c)),(g||h||f)&&(e=g+h+f+"RRULE:"+e),e}var E=window.joy,F=E.getPluginLang(),G=E.timezone,H=E.Class,I=E.ui,J=I.Widget,K=I.DropDownList,L=E.date,M=L.setTime,N=L.setDayOfWeek,O=L.adjustDST,P=L.firstDayOfMonth,Q=L.getMilliseconds,R=[0,31,60,91,121,152,182,213,244,274,305,335,366],S=[0,31,59,90,120,151,181,212,243,273,304,334,365],T=[31,28,30,31,30,31,30,31,30,31,30,31],U={0:"SU",1:"MO",2:"TU",3:"WE",4:"TH",5:"FR",6:"SA"},V={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6},W=["yyyy-MM-ddTHH:mm:ss.fffzzz","yyyy-MM-ddTHH:mm:sszzz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mm","yyyy-MM-ddTHH","yyyy-MM-dd","yyyyMMddTHHmmssfffzzz","yyyyMMddTHHmmsszzz","yyyyMMddTHHmmss","yyyyMMddTHHmm","yyyyMMddTHH","yyyyMMdd"],X=["months","weeks","yearDays","monthDays","weekDays","hours","minutes","seconds"],Y=X.length,Z="yyyyMMddTHHmmssZ",$={months:function(a,b,c){var d=c.months,e=l(d,a.getMonth()+1),f=!1;return null!==e&&(e.length?a.setMonth(e[0]-1,1):a.setFullYear(a.getFullYear()+1,d[0]-1,1),f=!0),f},monthDays:function(a,b,c){for(var d,e,f,g=!1,h=a.getHours(),i=function(a){return 0>a&&(a=d+a),a};b>=a;){if(e=a.getMonth(),d=p(a),f=l(c.monthDays,a.getDate(),i),null===f)return g;if(g=!0,f.length){if(a.setMonth(e,f.sort(r)[0]),O(a,h),e===a.getMonth())break}else a.setMonth(e+1,1)}return g},yearDays:function(a,b,c){for(var e,f,g=!1,h=a.getHours(),i=function(a){return 0>a&&(a=e+a),a};b>a;){if(e=q(a)?366:365,f=l(c.yearDays,d(a),i),null===f)return g;if(g=!0,e=a.getFullYear(),f.length){a.setFullYear(e,0,f.sort(r)[0]),O(a,h);break}a.setFullYear(e+1,0,1)}return g},weeks:function(a,b,c){for(var d,f,g,h=c.weekStart,i=!1,j=a.getHours(),k=function(a){return 0>a&&(a=53+a),a};b>a;){if(f=l(c.weeks,e(a,h),k),null===f)return i;if(i=!0,d=a.getFullYear(),f.length){g=7*f.sort(r)[0]-1,a.setFullYear(d,0,g),N(a,h,-1),O(a,j);break}a.setFullYear(d+1,0,1)}return i},weekDays:function(a,b,c){var d,e,g=c.weekDays,h=c.weekStart,l=k(g,a,h),m=a.getHours();if(null===l)return!1;if(d=l[0],d||(d=g[0],N(a,h)),e=d.day,d.offset)for(;b>=a&&!j(a,d,h);)f(a,h)===i(a,h)?(a.setMonth(a.getMonth()+1,1),O(a,m)):(a.setDate(a.getDate()+7),O(a,m),N(a,h,-1));return a.getDay()!==e&&N(a,e),!0},hours:function(a,b,c){var d=c.hours,e=c._startTime,f=e.getHours(),g=l(d,f),h=!1;return null!==g&&(h=!0,a.setHours(f),O(a,f),g.length?(g=g[0],a.setHours(g)):(g=a.getHours(),a.setDate(a.getDate()+1),O(a,g),g=d[0],a.setHours(g),O(a,g)),c.minutes&&a.setMinutes(0),e.setHours(g,a.getMinutes())),h},minutes:function(a,b,c){var d=c.minutes,e=a.getMinutes(),f=l(d,e),g=c._startTime.getHours(),h=!1;return null!==f&&(h=!0,f.length?f=f[0]:(g+=1,f=d[0]),c.seconds&&a.setSeconds(0),a.setHours(g,f),g%=24,O(a,g),c._startTime.setHours(g,f,a.getSeconds())),h},seconds:function(a,b,c){var d=c.seconds,e=c._startTime.getHours(),f=l(d,a.getSeconds()),g=a.getMinutes(),h=!1;return null!==f&&(h=!0,f.length?a.setSeconds(f[0]):(g+=1,a.setMinutes(g,d[0]),g>59&&(g%=60,e=(e+1)%24)),c._startTime.setHours(e,g,a.getSeconds())),h}},_=H.extend({next:function(a,b){var c,d,e=b._startTime,f=e.getDate();if(b.seconds)d=a.getSeconds()+1,a.setSeconds(d),e.setSeconds(d),e.setDate(f);else{if(!b.minutes)return!1;c=a.getMinutes()+1,a.setMinutes(c),e.setMinutes(c),e.setDate(f)}return!0},normalize:function(a){var b=a.rule;4===a.idx&&b.hours&&(b._startTime.setHours(0),this._hour(a.date,b))},limit:function(a,c,d){for(var e,f,g,h,i,j=d.interval;c>=a;){for(g=f=b,i=a.getDate(),h=0;Y>h;h++){if(e=X[h],d[e]){if(g=$[e](a,c,d),f!==b&&g)break;f=g}g&&this.normalize({date:a,rule:d,day:i,idx:h})}if((1===j||!this.interval(d,a))&&h===Y)break}},interval:function(a,b){var d,f,g=new Date(a._startPeriod),h=new Date(b),i=b.getHours(),j=a.weekStart,k=a.interval,l=a.freq,m=!1,n=0,o=0,p=1;return"hourly"===l?(d=h.getTimezoneOffset()-g.getTimezoneOffset(),f=a._startTime.getHours(),h=h.getTime(),i!==f&&(h+=(f-i)*E.date.MS_PER_HOUR),h-=g,d&&(h-=d*E.date.MS_PER_MINUTE),d=Math.floor(h/E.date.MS_PER_HOUR),n=c(d,k),0!==n&&(this._hour(b,a,n),m=!0)):"daily"===l?(E.date.setTime(h,-g),d=Math.floor(h/E.date.MS_PER_DAY),n=c(d,k),0!==n&&(this._date(b,a,n),m=!0)):"weekly"===l?(d=52*(b.getFullYear()-g.getFullYear()),n=e(b,j)-e(g,j)+d,n=c(n,k),0!==n&&(E.date.setDayOfWeek(b,a.weekStart,-1),b.setDate(b.getDate()+7*n),O(b,i),m=!0)):"monthly"===l?(d=b.getFullYear()-g.getFullYear(),d=b.getMonth()-g.getMonth()+12*d,n=c(d,k),0!==n&&(p=a._hasRuleValue?1:b.getDate(),b.setFullYear(b.getFullYear(),b.getMonth()+n,p),O(b,i),m=!0)):"yearly"===l&&(d=b.getFullYear()-g.getFullYear(),n=c(d,k),a.months||(o=b.getMonth()),a.yearDays||a.monthDays||a.weekDays||(p=b.getDate()),0!==n&&(b.setFullYear(b.getFullYear()+n,o,p),O(b,i),m=!0)),m},_hour:function(a,b,c){var d=b._startTime,e=d.getHours();c&&(e+=c),a.setHours(e),e%=24,d.setHours(e),O(a,e)},_date:function(a,b,c){var d=a.getHours();a.setDate(a.getDate()+c),O(a,d)||this._hour(a,b)}}),aa=_.extend({next:function(a,b){_.fn.next(a,b)||this._hour(a,b,1)},normalize:function(a){var b=a.rule;4===a.idx&&(b._startTime.setHours(0),this._hour(a.date,b))}}),ba=_.extend({next:function(a,b){_.fn.next(a,b)||this[b.hours?"_hour":"_date"](a,b,1)}}),ca=ba.extend({setup:function(a,b){a.weekDays||(a.weekDays=[{day:b.getDay(),offset:0}])}}),da=_.extend({next:function(a,b){var c,d;if(!_.fn.next(a,b))if(b.hours)this._hour(a,b,1);else if(b.monthDays||b.weekDays||b.yearDays||b.weeks)this._date(a,b,1);else{for(c=a.getDate(),d=a.getHours(),a.setMonth(a.getMonth()+1),O(a,d);a.getDate()!==c;)a.setDate(c),O(a,d);this._hour(a,b)}},normalize:function(a){var b=a.rule,c=a.date,d=c.getHours();0!==a.idx||b.monthDays||b.weekDays?_.fn.normalize(a):(c.setDate(a.day),O(c,d))},setup:function(a,b,c){a.monthDays||a.weekDays||c.setDate(b.getDate())}}),ea=da.extend({next:function(a,b){var c,d=a.getHours();if(!_.fn.next(a,b))if(b.hours)this._hour(a,b,1);else if(b.monthDays||b.weekDays||b.yearDays||b.weeks)this._date(a,b,1);else if(b.months){for(c=a.getDate(),a.setMonth(a.getMonth()+1),O(a,d);a.getDate()!==c;)a.setDate(c),O(a,d);this._hour(a,b)}else a.setFullYear(a.getFullYear()+1),O(a,d),this._hour(a,b)},setup:function(){}}),fa={hourly:new aa,daily:new ba,weekly:new ca,monthly:new da,yearly:new ea},ga="click";E.recurrence={rule:{parse:B,serialize:D},expand:y,dayInYear:d,weekInYear:e,weekInMonth:f,numberOfWeeks:i,isException:t,toExceptionString:u};var ha=function(a){for(var b=F.calendars.days.namesShort,c=b.length,d="",e=0,f=[];c>e;e++)f.push(e);for(b=b.slice(a).concat(b.slice(0,a)),f=f.slice(a).concat(f.slice(0,a)),e=0;c>e;e++)d+='<label class="k-check"><input class="k-recur-weekday-checkbox" type="checkbox" value="'+f[e]+'" /> '+b[e]+"</label>";return d},ia=E.template('# if (frequency !== "never") { #<div class="k-edit-label"><label>#:messages.repeatEvery#</label></div><div class="k-edit-field"><input class="k-recur-interval"/>#:messages.interval#</div># } ## if (frequency === "weekly") { #<div class="k-edit-label"><label>#:messages.repeatOn#</label></div><div class="k-edit-field">#=weekDayCheckBoxes(firstWeekDay)#</div># } else if (frequency === "monthly") { #<div class="k-edit-label"><label>#:messages.repeatOn#</label></div><div class="k-edit-field"><ul class="k-reset"><li><label><input class="k-recur-month-radio" type="radio" name="month" value="monthday" />#:messages.day#</label><input class="k-recur-monthday" /></li><li><input class="k-recur-month-radio" type="radio" name="month" value="weekday" /><input class="k-recur-weekday-offset" /><input class="k-recur-weekday" /></li></ul></div># } else if (frequency === "yearly") { #<div class="k-edit-label"><label>#:messages.repeatOn#</label></div><div class="k-edit-field"><ul class="k-reset"><li><input class="k-recur-year-radio" type="radio" name="year" value="monthday" /><input class="k-recur-month" /><input class="k-recur-monthday" /></li><li><input class="k-recur-year-radio" type="radio" name="year" value="weekday" /><input class="k-recur-weekday-offset" /><input class="k-recur-weekday" />#:messages.of#<input class="k-recur-month" /></li></ul></div># } ## if (frequency !== "never") { #<div class="k-edit-label"><label>#:end.label#</label></div><div class="k-edit-field"><ul class="k-reset"><li><label><input class="k-recur-end-never" type="radio" name="end" value="never" />#:end.never#</label></li><li><label><input class="k-recur-end-count" type="radio" name="end" value="count" />#:end.after#</label><input class="k-recur-count" />#:end.occurrence#</li><li><label><input class="k-recur-end-until" type="radio" name="end" value="until" />#:end.on#</label><input class="k-recur-until" /></li></ul></div># } #'),ja=[{day:0,offset:0},{day:1,offset:0},{day:2,offset:0},{day:3,offset:0},{day:4,offset:0},{day:5,offset:0},{day:6,offset:0}],ka=[{day:1,offset:0},{day:2,offset:0},{day:3,offset:0},{day:4,offset:0},{day:5,offset:0}],la=[{day:0,offset:0},{day:6,offset:0}],ma=J.extend({init:function(a,b){var c,d=this,e=b&&b.frequencies;J.fn.init.call(d,a,b),d.wrapper=d.element,b=d.options,b.start=c=b.start||L.today(),e&&(b.frequencies=e),"string"==typeof c&&(b.start=E.parseDate(c,"yyyyMMddTHHmmss")),null===b.firstWeekDay&&(b.firstWeekDay=F.calendars.firstDay),d._namespace="."+b.name},options:{value:"",start:"",timezone:"",spinners:!0,firstWeekDay:null,frequencies:["never","daily","weekly","monthly","yearly"],mobile:!1,messages:{frequencies:{never:"Never",hourly:"Hourly",daily:"Daily",weekly:"Weekly",monthly:"Monthly",yearly:"Yearly"},hourly:{repeatEvery:"Repeat every: ",interval:" hour(s)"},daily:{repeatEvery:"Repeat every: ",interval:" day(s)"},weekly:{interval:" week(s)",repeatEvery:"Repeat every: ",repeatOn:"Repeat on: "},monthly:{repeatEvery:"Repeat every: ",repeatOn:"Repeat on: ",interval:" month(s)",day:"Day "},yearly:{repeatEvery:"Repeat every: ",repeatOn:"Repeat on: ",interval:" year(s)",of:" of "},end:{label:"End:",never:"Never",after:"After ",occurrence:" occurrence(s)",on:"On "},offsetPositions:{first:"first",second:"second",third:"third",fourth:"fourth",last:"last"},weekdays:{day:"day",weekday:"weekday",weekend:"weekend day"}}},events:["change"],_initInterval:function(){var a=this,b=a._value;a._container.find(".k-recur-interval").joyNumericTextBox({spinners:a.options.spinners,value:b.interval||1,decimals:0,format:"#",min:1,change:function(){b.interval=this.value(),a._trigger()}})},_weekDayRule:function(a){var b=this,c=(b._weekDay.element||b._weekDay).val(),d=Number((b._weekDayOffset.element||b._weekDayOffset).val()),e=null,f=null;a||("day"===c?(e=ja,f=d):"weekday"===c?(e=ka,f=d):"weekend"===c?(e=la,f=d):e=[{offset:d,day:Number(c)}]),b._value.weekDays=e,b._value.positions=f},_weekDayView:function(){var a,b,c,d,e=this,f=e._value.weekDays,g=e._value.positions,h=e._weekDayOffset;f&&(c=f.length,g&&(7===c?(b="day",a=g):5===c?(b="weekday",a=g):2===c&&(b="weekend",a=g)),b||(f=f[0],b=f.day,a=f.offset||""),d=h.value?"value":"val",h[d](a),e._weekDay[d](b))},_initWeekDay:function(){var b,c=this,d=c.options.messages.weekdays,e=c.options.messages.offsetPositions,f=c._container.find(".k-recur-weekday"),g=function(){c._weekDayRule(),c._trigger()};f[0]&&(c._weekDayOffset=new K(c._container.find(".k-recur-weekday-offset"),{change:g,dataTextField:"text",dataValueField:"value",dataSource:[{text:e.first,value:"1"},{text:e.second,value:"2"},{text:e.third,value:"3"},{text:e.fourth,value:"4"},{text:e.last,value:"-1"}]}),b=[{text:d.day,value:"day"},{text:d.weekday,value:"weekday"},{text:d.weekend,value:"weekend"}],c._weekDay=new K(f,{value:c.options.start.getDay(),change:g,dataTextField:"text",dataValueField:"value",dataSource:b.concat(a.map(F.calendars.days.names,function(a,b){return{text:a,value:b}}))}),c._weekDayView())},_initWeekDays:function(){var b=this,c=b._value,d=b._container.find(".k-recur-weekday-checkbox");if(d[0]&&(d.on(ga+b._namespace,function(){c.weekDays=a.map(d.filter(":checked"),function(a){return{day:Number(a.value),offset:0}}),b.options.mobile||b._trigger()}),c.weekDays))for(var e,f,g=0,h=d.length,i=c.weekDays.length;h>g;g++)for(f=d[g],e=0;i>e;e++)f.value==c.weekDays[e].day&&(f.checked=!0)},_initMonthDay:function(){var a=this,b=a._value,c=a._container.find(".k-recur-monthday");c[0]&&(a._monthDay=new E.ui.NumericTextBox(c,{spinners:a.options.spinners,min:1,max:31,decimals:0,format:"#",value:b.monthDays?b.monthDays[0]:a.options.start.getDate(),change:function(){var c=this.value();b.monthDays=c?[c]:c,a._trigger()}}))},_initCount:function(){var a=this,b=a._container.find(".k-recur-count"),c=a._value;a._count=b.joyNumericTextBox({spinners:a.options.spinners,value:c.count||1,decimals:0,format:"#",min:1,change:function(){c.count=this.value(),a._trigger()}}).data("joyNumericTextBox")},_initUntil:function(){var a=this,b=a._container.find(".k-recur-until"),c=a.options.start,d=a._value,e=d.until;a._until=b.joyDatePicker({min:e&&c>e?e:c,value:e||c,change:function(){d.until=this.value(),a._trigger()}}).data("joyDatePicker")},_trigger:function(){this.options.mobile||this.trigger("change")}}),na=ma.extend({init:function(a,b){var c=this;ma.fn.init.call(c,a,b),c._initFrequency(),c._initContainer(),c.value(c.options.value)},options:{name:"RecurrenceEditor"},events:["change"],destroy:function(){var a=this;a._frequency.destroy(),a._container.find("input[type=radio],input[type=checkbox]").off(ga+a._namespace),E.destroy(a._container),ma.fn.destroy.call(a)},value:function(a){var c=this,d=c.options.timezone;return a===b?c._value.freq?D(c._value,d):"":(c._value=B(a,d)||{},c._frequency.value(c._value.freq||""),void c._initView(c._frequency.value()))},_initContainer:function(){var b=this.element,c=a('<div class="k-recur-view" />'),d=b.parent(".k-edit-field");d[0]?c.insertAfter(d):b.append(c),this._container=c},_initFrequency:function(){var b,c=this,d=c.options,e=d.frequencies,f=d.messages.frequencies,g=a("<input />");e=a.map(e,function(a){return{text:f[a],value:a}}),b=e[0],b&&"never"===b.value&&(b.value=""),c.element.append(g),c._frequency=new K(g,{dataTextField:"text",dataValueField:"value",dataSource:e,change:function(){c._value={},c._initView(c._frequency.value()),c.trigger("change")}})},_initView:function(a){var b=this,c=b._value,d=b.options,e={frequency:a||"never",weekDayCheckBoxes:ha,firstWeekDay:d.firstWeekDay,messages:d.messages[a],end:d.messages.end};return E.destroy(b._container),b._container.html(ia(e)),a?(c.freq=a,"weekly"!==a||c.weekDays||(c.weekDays=[{day:d.start.getDay(),offset:0}]),b._initInterval(),b._initWeekDays(),b._initMonthDay(),b._initWeekDay(),b._initMonth(),b._initCount(),b._initUntil(),b._period(),void b._end()):void(b._value={})},_initMonth:function(){var b,c=this,d=c._value,e=d.months||[c.options.start.getMonth()+1],f=c._container.find(".k-recur-month");f[0]&&(b={change:function(){d.months=[Number(this.value())],c.trigger("change")},dataTextField:"text",dataValueField:"value",dataSource:a.map(F.calendars.months.names,function(a,b){return{text:a,value:b+1}})},c._month1=new K(f[0],b),c._month2=new K(f[1],b),e&&(e=e[0],c._month1.value(e),c._month2.value(e)))},_end:function(){var a,b=this,c=b._value,d=b._container,e=b._namespace,f=function(a){b._toggleEnd(a.currentTarget.value),b.trigger("change")};b._buttonNever=d.find(".k-recur-end-never").on(ga+e,f),b._buttonCount=d.find(".k-recur-end-count").on(ga+e,f),b._buttonUntil=d.find(".k-recur-end-until").on(ga+e,f),c.count?a="count":c.until&&(a="until"),b._toggleEnd(a)},_period:function(){var a=this,b=a._value,c="monthly"===b.freq,d=c?a._toggleMonthDay:a._toggleYear,e=".k-recur-"+(c?"month":"year")+"-radio",f=a._container.find(e);(c||"yearly"===b.freq)&&(f.on(ga+a._namespace,function(b){d.call(a,b.currentTarget.value),a.trigger("change")}),a._buttonMonthDay=f.eq(0),a._buttonWeekDay=f.eq(1),d.call(a,b.weekDays?"weekday":"monthday"))},_toggleEnd:function(a){var b,c,d,e,f=this;"count"===a?(f._buttonCount.prop("checked",!0),d=!0,e=!1,b=f._count.value(),c=null):"until"===a?(f._buttonUntil.prop("checked",!0),d=!1,e=!0,b=null,c=f._until.value()):(f._buttonNever.prop("checked",!0),d=e=!1,b=c=null),f._count.enable(d),f._until.enable(e),f._value.count=b,f._value.until=c},_toggleMonthDay:function(a){var b,c=this,d=!1,e=!0,f=!1;"monthday"===a?(c._buttonMonthDay.prop("checked",!0),b=[c._monthDay.value()],d=!0,e=!1,f=!0):(c._buttonWeekDay.prop("checked",!0),b=null),c._weekDay.enable(e),c._weekDayOffset.enable(e),c._monthDay.enable(d),c._value.monthDays=b,c._weekDayRule(f)},_toggleYear:function(a){var b,c=this,d=!1,e=!0;"monthday"===a?(d=!0,e=!1,b=c._month1.value()):b=c._month2.value(),c._month1.enable(d),c._month2.enable(e),c._value.months=[b],c._toggleMonthDay(a)}});I.plugin(na);var oa=E.template('<div class="k-edit-label"><label>#:headerTitle#</label></div><div class="k-edit-field k-recur-pattern k-scheduler-toolbar"></div><div class="k-recur-view"></div>'),pa=E.template('# if (frequency !== "never") { #<div class="k-edit-label"><label>#:messages.repeatEvery#</label></div><div class="k-edit-field"><input class="k-recur-interval" pattern="\\\\d*"/>#:messages.interval#</div># } ## if (frequency === "weekly") { #<div class="k-edit-label"><label>#:messages.repeatOn#</label></div><div class="k-edit-field">#=weekDayCheckBoxes(firstWeekDay)#</div># } else if (frequency === "monthly") { #<div class="k-edit-label"><label>#:messages.repeatBy#</label></div><div class="k-edit-field k-scheduler-toolbar k-repeat-rule"></div><div class="k-monthday-view" style="display:none"><div class="k-edit-label"><label>#:messages.day#</label></div><div class="k-edit-field"><input class="k-recur-monthday" pattern="\\\\d*"/></div></div><div class="k-weekday-view" style="display:none"><div class="k-edit-label"><label>#:messages.every#</label></div><div class="k-edit-field"><select class="k-recur-weekday-offset"></select></div><div class="k-edit-label"><label>#:messages.day#</label></div><div class="k-edit-field"><select class="k-recur-weekday"></select></div></div># } else if (frequency === "yearly") { #<div class="k-edit-label"><label>#:messages.repeatBy#</label></div><div class="k-edit-field k-scheduler-toolbar k-repeat-rule"></div><div class="k-monthday-view" style="display:none"><div class="k-edit-label"><label>#:messages.day#</label></div><div class="k-edit-field"><input class="k-recur-monthday" pattern="\\\\d*"/></div></div><div class="k-weekday-view" style="display:none"><div class="k-edit-label"><label>#:messages.every#</label></div><div class="k-edit-field"><select class="k-recur-weekday-offset"></select></div><div class="k-edit-label"><label>#:messages.day#</label></div><div class="k-edit-field"><select class="k-recur-weekday"></select></div></div><div class="k-edit-label"><label>#:messages.month#</label></div><div class="k-edit-field"><select class="k-recur-month"></select></div># } #'),qa=E.template('# if (endPattern === "count") { #<div class="k-edit-label"><label>#:messages.after#</label></div><div class="k-edit-field"><input class="k-recur-count" pattern="\\\\d*" /></div># } else if (endPattern === "until") { #<div class="k-edit-label"><label>#:messages.on#</label></div><div class="k-edit-field"><input type="date" class="k-recur-until" /></div># } #'),ra=E.template('<ul class="k-reset k-header k-toolbar k-scheduler-navigation">#for (var i = 0, length = dataSource.length; i < length; i++) {#<li class="k-state-default #= value === dataSource[i].value ? "k-state-selected" : "" #"><a role="button" href="\\#" class="k-link" data-#=ns#value="#=dataSource[i].value#">#:dataSource[i].text#</a></li>#}#</ul>'),sa=ma.extend({init:function(a,b){var c=this;ma.fn.init.call(c,a,b),b=c.options,c._optionTemplate=E.template('<option value="#:value#">#:text#</option>'),c.value(b.value),c._pane=b.pane,c._initRepeatButton(),c._initRepeatEnd(),c._defaultValue=c._value},options:{name:"MobileRecurrenceEditor",animations:{left:"slide",right:"slide:right"},mobile:!0,messages:{cancel:"Cancel",update:"Save",endTitle:"Repeat ends",repeatTitle:"Repeat pattern",headerTitle:"Repeat event",end:{patterns:{never:"Never",after:"After...",on:"On..."},never:"Never",after:"End repeat after",on:"End repeat on"},daily:{interval:""},hourly:{interval:""},weekly:{interval:""},monthly:{interval:"",repeatBy:"Repeat by: ",dayOfMonth:"Day of the month",dayOfWeek:"Day of the week",repeatEvery:"Repeat every",every:"Every",day:"Day "},yearly:{interval:"",repeatBy:"Repeat by: ",dayOfMonth:"Day of the month",dayOfWeek:"Day of the week",repeatEvery:"Repeat every: ",every:"Every",month:"Month",day:"Day"}}},events:["change"],value:function(a){var c=this,d=c.options.timezone;return a===b?c._value.freq?D(c._value,d):"":void(c._value=B(a,d)||{})},destroy:function(){this._destroyView(),E.destroy(this._endFields),this._repeatButton.off(ga+this._namespace),ma.fn.destroy.call(this)},_initRepeatButton:function(){var b=this,c=b.options.messages.frequencies[this._value.freq||"never"];b._repeatButton=a('<a href="#" class="k-button k-scheduler-recur">'+c+"</a>").on(ga+b._namespace,function(a){a.preventDefault(),b._createView("repeat"),b._pane.navigate("recurrence",b.options.animations.left)}),b.element.append(b._repeatButton)},_initRepeatEnd:function(){var b=this,c=a('<div class="k-edit-label"><label>Ends</label></div>').insertAfter(b.element.parent(".k-edit-field")),d=a('<div class="k-edit-field"><a href="#" class="k-button k-scheduler-recur-end"></a></div>').on(ga+b._namespace,function(a){a.preventDefault(),b._value.freq&&(b._createView("end"),b._pane.navigate("recurrence",b.options.animations.left))}).insertAfter(c);b._endFields=c.add(d).toggleClass("k-state-disabled",!b._value.freq),b._endButton=d.find(".k-scheduler-recur-end").text(b._endText())},_endText:function(){var a=this._value,b=this.options.messages.end,c=b.never;return a.count?c=E.format("{0} {1}",b.after,a.count):a.until&&(c=E.format("{0} {1:d}",b.on,a.until)),c},_initFrequency:function(){var b=this,c=b.options.messages.frequencies,d=ra({dataSource:a.map(this.options.frequencies,function(a){return{text:c[a],value:"never"!==a?a:""}}),value:b._value.freq||"",ns:E.ns});b._view.element.find(".k-recur-pattern").append(d).on(ga+b._namespace,".k-scheduler-navigation li",function(c){var d=a(this);c.preventDefault(),d.addClass("k-state-selected").siblings().removeClass("k-state-selected"),b._value={freq:d.children("a").attr(E.attr("value"))},b._initRepeatView()})},_initEndNavigation:function(){var b=this,c=b.options.messages.end.patterns,d=b._value,e="";d.count?e="count":d.until&&(e="until");var f=ra({dataSource:[{text:c.never,value:""},{text:c.after,value:"count"},{text:c.on,value:"until"}],value:e,ns:E.ns});b._view.element.find(".k-recur-pattern").append(f).on(ga+b._namespace,".k-scheduler-navigation li",function(c){var e=a(this),f=null,g=null;c.preventDefault(),e.addClass("k-state-selected").siblings().removeClass("k-state-selected"),b._initEndView(e.children("a").attr(E.attr("value"))),b._count?(f=b._count.value(),g=null):b._until&&(f=null,g=b._until.val?E.parseDate(b._until.val(),"yyyy-MM-dd"):b._until.value()),d.count=f,d.until=g})},_createView:function(b){var c=this,d=c.options,e=d.messages,f=e["repeat"===b?"repeatTitle":"endTitle"],g='<div data-role="view" class="k-popup-edit-form k-scheduler-edit-form k-mobile-list" id="recurrence"><div data-role="header" class="k-header"><a href="#" class="k-button k-scheduler-cancel">'+e.cancel+"</a>"+e.headerTitle+'<a href="#" class="k-button k-scheduler-update">'+e.update+"</a></div>",h=c._pane.view().id;c._view=c._pane.append(g+oa({headerTitle:f})),c._view.element.on(ga+c._namespace,"a.k-scheduler-cancel, a.k-scheduler-update",function(b){b.preventDefault(),b.stopPropagation(),a(this).hasClass("k-scheduler-update")?(c.trigger("change"),c._defaultValue=a.extend({},c._value)):c._value=c._defaultValue;var d=c._value.freq;c._endButton.text(c._endText()),c._endFields.toggleClass("k-state-disabled",!d),c._repeatButton.text(e.frequencies[d||"never"]),c._pane.one("viewShow",function(){c._destroyView()}),c._pane.navigate(h,c.options.animations.right)}),c._container=c._view.element.find(".k-recur-view"),"repeat"===b?(c._initFrequency(),c._initRepeatView()):(c._initEndNavigation(),c._initEndView())},_destroyView:function(){this._view&&(this._view.destroy(),this._view.element.remove()),this._view=null},_initRepeatView:function(){var a=this,b=a._value.freq||"never",c={frequency:b,weekDayCheckBoxes:ha,firstWeekDay:a.options.firstWeekDay,messages:a.options.messages[b]},d=pa(c),e=a._container,f=a._value;return E.destroy(e),e.html(d),d?("weekly"!==b||f.weekDays||(f.weekDays=[{day:a.options.start.getDay(),offset:0}]),a._initInterval(),a._initMonthDay(),a._initWeekDays(),a._initWeekDay(),a._initMonth(),void a._period()):void(a._value={});

},_initEndView:function(a){var c=this,d=c._value;a===b&&(d.count?a="count":d.until&&(a="until"));var e={endPattern:a,messages:c.options.messages.end};E.destroy(c._container),c._container.html(qa(e)),c._initCount(),c._initUntil()},_initWeekDay:function(){var b,c=this,d=c.options.messages.weekdays,e=c.options.messages.offsetPositions,f=c._container.find(".k-recur-weekday"),g=function(){c._weekDayRule(),c.trigger("change")};f[0]&&(c._weekDayOffset=c._container.find(".k-recur-weekday-offset").html(c._options([{text:e.first,value:"1"},{text:e.second,value:"2"},{text:e.third,value:"3"},{text:e.fourth,value:"4"},{text:e.last,value:"-1"}])).change(g),b=[{text:d.day,value:"day"},{text:d.weekday,value:"weekday"},{text:d.weekend,value:"weekend"}],b=b.concat(a.map(F.calendars.days.names,function(a,b){return{text:a,value:b}})),c._weekDay=f.html(c._options(b)).change(g).val(c.options.start.getDay()),c._weekDayView())},_initMonth:function(){var b=this,c=b._value,d=b.options.start,e=c.months||[d.getMonth()+1],f=b._container.find(".k-recur-month"),g=F.calendars.months.names;if(f[0]){var h=a.map(g,function(a,b){return{text:a,value:b+1}});f.html(b._options(h)).change(function(){c.months=[Number(this.value)]}),b._monthSelect=f,e&&f.val(e[0])}},_period:function(){var b=this,c=b._value,d=b._container,e=b.options.messages[c.freq],f=d.find(".k-repeat-rule"),g=d.find(".k-weekday-view"),h=d.find(".k-monthday-view");if(f[0]){var i=c.weekDays?"weekday":"monthday",j=ra({value:i,dataSource:[{text:e.dayOfMonth,value:"monthday"},{text:e.dayOfWeek,value:"weekday"}],ns:E.ns}),k=function(a){var d=b._weekDay.val(),e=b._weekDayOffset.val(),f=b._monthDay.value(),i=b._monthSelect?b._monthSelect.val():null;"monthday"===a?(c.weekDays=null,c.monthDays=f?[f]:f,c.months=i?[Number(i)]:i,g.hide(),h.show()):(c.monthDays=null,c.months=i?[Number(i)]:i,c.weekDays=[{offset:Number(e),day:Number(d)}],g.show(),h.hide())};f.append(j).on(ga+b._namespace,".k-scheduler-navigation li",function(b){var c=a(this).addClass("k-state-selected");b.preventDefault(),c.siblings().removeClass("k-state-selected");var d=c.children("a").attr(E.attr("value"));k(d)}),k(i)}},_initUntil:function(){var a=this,b=a._container.find(".k-recur-until"),c=a.options.start,d=a._value,e=d.until,f=e&&c>e?e:c;a._until=E.support.input.date?b.attr("min",E.toString(f,"yyyy-MM-dd")).val(E.toString(e||c,"yyyy-MM-dd")).on("change",function(){d.until=E.parseDate(this.value,"yyyy-MM-dd")}):b.joyDatePicker({min:f,value:e||c,change:function(){d.until=this.value()}}).data("joyDatePicker")},_options:function(a,b){var c=0,d="",e=a.length,f=this._optionTemplate;for(b&&(d+=f({value:"",text:b}));e>c;c++)d+=f(a[c]);return d}});I.plugin(sa)}(window.joy.jQuery),function(a){function b(a,b){function c(a,e){if(e=e[b])for(var f=d[a]=d[a]||[],g=0;g<e.length;g++)f.push(e[g]),c(a+1,e[g])}var d=[];return c(0,a),d}function c(){return t.support.cssBorderSpacing?"":'cellspacing="0"'}function d(b,d){return b.length?"<table "+c()+' class="'+a.trim("k-scheduler-table "+(d||""))+'"><tr>'+b.join("</tr><tr>")+"</tr></table>":""}function e(a,b){return a.length?"<div style='position:relative'>"+d(a,b)+"</div>":""}function f(b,c,e){var f=[];if(e>0)for(var g=0;b>g;g++)f.push("<th></th>");return c&&f.push('<th class="k-scheduler-times-all-day">'+c.text+"</th>"),1>e?a():a('<div class="k-scheduler-times">'+d(f)+"</div>")}function g(b,c,f){for(var g,h=[],i=0;i<b.length;i++){var j=b[i],k=[],l=c/j.length;for(g=0;g<j.length;g++)k.push('<th colspan="'+l+'" class="'+(j[g].className||"")+'">'+j[g].text+"</th>");h.push(k.join(""))}var m=[];if(f){var n=b[b.length-1],o=[],p=f.cellContent;for(g=0;g<n.length;g++)o.push('<td class="'+(n[g].className||"")+'">'+(p?p(g):"&nbsp;")+"</th>");m.push(o.join(""))}return a('<div class="k-scheduler-header k-state-default"><div class="k-scheduler-header-wrap">'+d(h)+e(m,"k-scheduler-header-all-day")+"</div></div>")}function h(b,c){for(var e,f=new Array(c).join().split(","),g=[],h=0;h<b.length;h++){var i,j=b[h],k=c/j.length;for(e=0;e<j.length;e++)i=j[e].className||"",j[e].allDay&&(i="k-scheduler-times-all-day"),f[k*e]+='<th class="'+i+'" rowspan="'+k+'">'+j[e].text+"</th>"}for(e=0;c>e;e++)g.push(f[e]);return 1>c?a():a('<div class="k-scheduler-times">'+d(g)+"</div>")}function i(){return a('<div class="k-scheduler-content"><table '+c()+' class="k-scheduler-table"/></div>')}function j(){return B=B?B:t.support.scrollbar()}function k(a,b,c){var d,e,f,g,h;for(d=a.length-1;d>=0;d--)e=l(a[d]),f=e.start,h=e.end,g=b>=f&&h>=b,(g||f>=b&&c>=h||f>=b&&c>=f)&&(b>f&&(b=f),h>c&&(c=h));return m(a,b,c)}function l(a){return{start:a.start,end:a.end}}function m(a,b,c){for(var d=[],e=0;e<a.length;e++){var f=l(a[e]);(f.start<b&&f.end>b||f.start>=b&&f.end<=c)&&d.push(a[e])}return d}function n(a){return p(a)}function o(a){return p(a)}function p(a){for(var b=[],c=0;c<a.length;c++){for(var d=a[c],e=l(d),f=null,g=0,h=b.length;h>g;g++){var i=e.start>b[g].end;if(e.start<b[g].start||i){f=b[g],f.end<e.end&&(f.end=e.end);break}}f||(f={start:e.start,end:e.end,events:[]},b.push(f)),f.events.push(d)}return b}function q(a,b,c){var d=b[0];if(d){for(var e=[],f=d.dataSource.view(),g=0;g<f.length;g++){var h={text:t.getter(d.dataTextField)(f[g]),className:"k-slot-cell"};h[a]=q(a,b.slice(1),c),e.push(h)}return e}return c}function r(b){return function(c){if(a.isArray(c)||c instanceof t.data.ObservableArray){for(var d=0;d<c.length;d++)if(c[d]==b)return!0;return!1}return c==b}}function s(a){a.className=a.className.replace(L,"")+" k-state-selected"}var t=window.joy,u=t.getPluginLang(),v=t.ui,w=v.Widget,x=t.keys,y=".joySchedulerView",z=Math,A='<div class="k-marquee k-scheduler-marquee"><div class="k-marquee-color"></div><div class="k-marquee-text"><div class="k-label-top"></div><div class="k-label-bottom"></div></div></div>';t.ui.scheduler={};var B,C=t.Class.extend({init:function(a){this._index=a,this._timeSlotCollections=[],this._daySlotCollections=[]},addTimeSlotCollection:function(a,b){return this._addCollection(a,b,this._timeSlotCollections)},addDaySlotCollection:function(a,b){return this._addCollection(a,b,this._daySlotCollections)},_addCollection:function(a,b,c){var d=new G(a,b,this._index,c.length);return c.push(d),d},timeSlotCollectionCount:function(){return this._timeSlotCollections.length},daySlotCollectionCount:function(){return this._daySlotCollections.length},daySlotByPosition:function(a,b){return this._slotByPosition(a,b,this._daySlotCollections)},timeSlotByPosition:function(a,b){return this._slotByPosition(a,b,this._timeSlotCollections)},_slotByPosition:function(a,b,c){for(var d=0;d<c.length;d++)for(var e=c[d],f=0;f<e.count();f++){var g=e.at(f);if(a>=g.offsetLeft&&a<g.offsetLeft+g.clientWidth&&b>=g.offsetTop&&b<g.offsetTop+g.clientHeight)return g}},refresh:function(){var a;for(a=0;a<this._daySlotCollections.length;a++)this._daySlotCollections[a].refresh();for(a=0;a<this._timeSlotCollections.length;a++)this._timeSlotCollections[a].refresh()},timeSlotRanges:function(a,b){var c=this._timeSlotCollections,d=this._startSlot(a,c),e=d;return b>a&&(e=this._endSlot(b,c)),this._continuousRange(E,c,d,e)},daySlotRanges:function(a,b,c){var d=this._daySlotCollections,e=this._startSlot(a,d,c),f=e;return b>a&&(f=this._endSlot(b,d,c)),this._continuousRange(F,d,e,f)},_continuousRange:function(a,b,c,d){for(var e=c.slot,f=d.slot,g=e.collectionIndex,h=f.collectionIndex,i=[],j=g;h>=j;j++){var k=b[j],l=k.first(),m=k.last(),n=!1,o=!1;j==g&&(o=!c.inRange),j==h&&(n=!d.inRange),l.start<e.start&&(l=e),m.start>f.start&&(m=f),h>g&&(j==g?n=!0:j==h?o=!0:n=o=!0),i.push(new a({start:l,end:m,collection:k,head:n,tail:o}))}return i},slotRanges:function(a,b){var c=t.date.toUtcTime(a.start),d=t.date.toUtcTime(a.end);return void 0===b&&(b=a.isMultiDay()),b?this.daySlotRanges(c,d,a.isAllDay):(a.startTime&&(c=t.date.getMilliseconds(a.startTime)+t.date.toUtcTime(t.date.getDate(a.start))),a.endTime&&(d=t.date.getMilliseconds(a.endTime)+t.date.toUtcTime(t.date.getDate(a.end))),this.timeSlotRanges(c,d))},ranges:function(a,b,c,d){return"number"!=typeof a&&(a=t.date.toUtcTime(a)),"number"!=typeof b&&(b=t.date.toUtcTime(b)),c?this.daySlotRanges(a,b,d):this.timeSlotRanges(a,b)},_startCollection:function(a,b){for(var c=0;c<b.length;c++){var d=b[c];if(d.startInRange(a))return d}return null},_endCollection:function(a,b,c){for(var d=0;d<b.length;d++){var e=b[d];if(e.endInRange(a,c))return e}return null},_getCollections:function(a){return a?this._daySlotCollections:this._timeSlotCollections},continuousSlot:function(a,b){var c=b?-1:1,d=this._getCollections(a.isDaySlot),e=d[a.collectionIndex+c];return e?e[b?"last":"first"]():void 0},firstSlot:function(){var a=this._getCollections(this.daySlotCollectionCount());return a[0].first()},lastSlot:function(){var a=this._getCollections(this.daySlotCollectionCount());return a[a.length-1].last()},upSlot:function(a,b){var c=this,d=function(a,d,e){var f=0===e;return!b&&!a&&f&&c.daySlotCollectionCount()?c._daySlotCollections[0].at(d):void 0};return this.timeSlotCollectionCount()||(b=!0),this._verticalSlot(a,-1,d)},downSlot:function(a,b){var c=this,d=function(a,d,e){return!b&&a&&c.timeSlotCollectionCount()?c._timeSlotCollections[e].at(0):void 0};return this.timeSlotCollectionCount()||(b=!0),this._verticalSlot(a,1,d)},leftSlot:function(a){return this._horizontalSlot(a,-1)},rightSlot:function(a){return this._horizontalSlot(a,1)},_horizontalSlot:function(a,b){var c=a.index,d=a.isDaySlot,e=a.collectionIndex,f=this._getCollections(d);d?c+=b:e+=b;var g=f[e];return g?g.at(c):void 0},_verticalSlot:function(a,b,c){var d=a.index,e=a.isDaySlot,f=a.collectionIndex,g=this._getCollections(e);if(a=c(e,f,d))return a;e?f+=b:d+=b;var h=g[f];return h?h.at(d):void 0},_collection:function(a,b){var c=b?this._daySlotCollections:this._timeSlotCollections;return c[a]},_startSlot:function(a,b,c){var d=this._startCollection(a,b),e=!0;d||(d=b[0],e=!1);var f=d.slotByStartDate(a,c);return f||(f=d.first(),e=!1),{slot:f,inRange:e}},_endSlot:function(a,b,c){var d=this._endCollection(a,b,c),e=!0;d||(d=b[b.length-1],e=!1);var f=d.slotByEndDate(a,c);return f||(f=d.last(),e=!1),{slot:f,inRange:e}},getSlotCollection:function(a,b){return this[b?"getDaySlotCollection":"getTimeSlotCollection"](a)},getTimeSlotCollection:function(a){return this._timeSlotCollections[a]},getDaySlotCollection:function(a){return this._daySlotCollections[a]}}),D=t.Class.extend({init:function(b){a.extend(this,b)},innerHeight:function(){for(var a=this.collection,b=this.start.index,c=this.end.index,d=0,e=b;c>=e;e++)d+=a.at(e).offsetHeight;return d},events:function(){return this.collection.events()},addEvent:function(a){this.events().push(a)},startSlot:function(){return this.start.offsetLeft>this.end.offsetLeft?this.end:this.start},endSlot:function(){return this.start.offsetLeft>this.end.offsetLeft?this.start:this.end}}),E=D.extend({innerHeight:function(){for(var a=this.collection,b=this.start.index,c=this.end.index,d=0,e=b;c>=e;e++)d+=a.at(e).offsetHeight;return d},outerRect:function(a,b,c){return this._rect("offset",a,b,c)},_rect:function(a,b,c,d){var e,f,g=this.start,h=this.end;if("number"!=typeof b&&(b=t.date.toUtcTime(b)),"number"!=typeof c&&(c=t.date.toUtcTime(c)),d)e=g.offsetTop,f=h.offsetTop+h[a+"Height"];else{var i=b-g.start;0>i&&(i=0);var j=g.end-g.start;e=g.offsetTop+g[a+"Height"]*i/j;var k=h.end-c;0>k&&(k=0);var l=h.end-h.start;f=h.offsetTop+h[a+"Height"]-h[a+"Height"]*k/l}return{top:e,bottom:f}},innerRect:function(a,b,c){return this._rect("client",a,b,c)}}),F=D.extend({innerWidth:function(){for(var a=this.collection,b=this.start.index,c=this.end.index,d=0,e=b!==c?"offsetWidth":"clientWidth",f=b;c>=f;f++)d+=a.at(f)[e];return d}}),G=t.Class.extend({init:function(a,b,c,d){this._slots=[],this._events=[],this._start=t.date.toUtcTime(a),this._end=t.date.toUtcTime(b),this._groupIndex=c,this._collectionIndex=d},refresh:function(){for(var a=0;a<this._slots.length;a++)this._slots[a].refresh()},startInRange:function(a){return this._start<=a&&a<this._end},endInRange:function(a,b){var c=b?a<this._end:a<=this._end;return this._start<=a&&c},slotByStartDate:function(a){var b=a;"number"!=typeof b&&(b=t.date.toUtcTime(a));for(var c=0;c<this._slots.length;c++){var d=this._slots[c];if(d.startInRange(b))return d}return null},slotByEndDate:function(a,b){var c=a;if("number"!=typeof c&&(c=t.date.toUtcTime(a)),b)return this.slotByStartDate(a,!1);for(var d=0;d<this._slots.length;d++){var e=this._slots[d];if(e.endInRange(c))return e}return null},count:function(){return this._slots.length},events:function(){return this._events},addTimeSlot:function(a,b,c){var d=new I(a,b,c,this._groupIndex,this._collectionIndex,this._slots.length);this._slots.push(d)},addDaySlot:function(a,b,c,d){var e=new J(a,b,c,this._groupIndex,this._collectionIndex,this._slots.length,d);this._slots.push(e)},first:function(){return this._slots[0]},last:function(){return this._slots[this._slots.length-1]},at:function(a){return this._slots[a]}}),H=t.Class.extend({init:function(a,b,c,d,e,f){this.element=a,this.clientWidth=a.clientWidth,this.clientHeight=a.clientHeight,this.offsetWidth=a.offsetWidth,this.offsetHeight=a.offsetHeight,this.offsetTop=a.offsetTop,this.offsetLeft=a.offsetLeft,this.start=b,this.end=c,this.element=a,this.groupIndex=d,this.collectionIndex=e,this.index=f,this.isDaySlot=!1},startDate:function(){return t.timezone.toLocalDate(this.start)},endDate:function(){return t.timezone.toLocalDate(this.end)},startInRange:function(a){return this.start<=a&&a<this.end},endInRange:function(a){return this.start<a&&a<=this.end},startOffset:function(){return this.start},endOffset:function(){return this.end}}),I=H.extend({refresh:function(){this.offsetTop=this.element.offsetTop},offsetX:function(a,b){return a?this.offsetLeft+b:this.offsetLeft+b},startInRange:function(a){return this.start<=a&&a<this.end},endInRange:function(a){return this.start<a&&a<=this.end},startOffset:function(b,c,d){if(d)return this.start;var e=a(this.element).offset(),f=c-e.top,g=this.end-this.start,h=Math.floor(g*(f/this.offsetHeight));return this.start+h},endOffset:function(b,c,d){if(d)return this.end;var e=a(this.element).offset(),f=c-e.top,g=this.end-this.start,h=Math.floor(g*(f/this.offsetHeight));return this.start+h}}),J=H.extend({init:function(a,b,c,d,e,f,g){H.fn.init.apply(this,arguments),this.eventCount=g,this.isDaySlot=!0,this.element.children.length?(this.firstChildHeight=this.element.children[0].offsetHeight+3,this.firstChildTop=this.element.children[0].offsetTop):(this.firstChildHeight=3,this.firstChildTop=0)},refresh:function(){this.clientHeight=this.element.clientHeight,this.offsetTop=this.element.offsetTop},startDate:function(){var a=new Date(this.start);return t.timezone.apply(a,"Etc/UTC")},endDate:function(){var a=new Date(this.end);return t.timezone.apply(a,"Etc/UTC")},startInRange:function(a){return this.start<=a&&a<this.end},endInRange:function(a){return this.start<a&&a<=this.end}});t.ui.SchedulerView=w.extend({init:function(b,c){w.fn.init.call(this,b,c),this._scrollbar=j(),this._isRtl=t.support.isRtl(b),this._resizeHint=a(),this._moveHint=a(),this._cellId=t.guid(),this._resourcesForGroups(),this._selectedSlots=[]},_isMobile:function(){var a=this.options;return a.mobile===!0&&t.support.mobileOS||"phone"===a.mobile||"tablet"===a.mobile},_isMobilePhoneView:function(){var a=this.options;return a.mobile===!0&&t.support.mobileOS&&!t.support.mobileOS.tablet||"phone"===a.mobile},_addResourceView:function(){var a=new C(this.groups.length);return this.groups.push(a),a},dateForTitle:function(){return t.format(this.options.selectedDateFormat,this.startDate(),this.endDate())},_changeGroup:function(a,b){var c=b?"prevGroupSlot":"nextGroupSlot",d=this[c](a.start,a.groupIndex,a.isAllDay);return d&&(a.groupIndex+=b?-1:1),d},_changeGroupContinuously:function(){return null},_changeViewPeriod:function(){return!1},_horizontalSlots:function(a,b,c,d){var e=d?"leftSlot":"rightSlot",f=b[0].start,g=b[b.length-1].end,h=this.groups[a.groupIndex];if(!c){var i=this._normalizeHorizontalSelection(a,b,d);i&&(f=g=i)}f=h[e](f),g=h[e](g),c||this._isVerticallyGrouped()||f&&g||(f=g=this._changeGroup(a,d));var j;return f&&g||(j=this._continuousSlot(a,b,d),j=this._changeGroupContinuously(a,j,c,d),j&&(f=g=j)),{startSlot:f,endSlot:g}},_verticalSlots:function(a,b,c,d){var e=b[0].start,f=b[b.length-1].end,g=this.groups[a.groupIndex];if(!c){var h=this._normalizeVerticalSelection(a,b,d);h&&(e=f=h)}var i=d?"upSlot":"downSlot";return e=g[i](e,c),f=g[i](f,c),c||!this._isVerticallyGrouped()||e&&f||(e=f=this._changeGroup(a,d)),{startSlot:e,endSlot:f}},_normalizeHorizontalSelection:function(){return null},_normalizeVerticalSelection:function(a,b,c){var d;return d=c?b[0].start:b[b.length-1].end},_continuousSlot:function(){return null},constrainSelection:function(a){var b,c=this.groups[0];this.inRange(a)?c.daySlotCollectionCount()||(a.isAllDay=!1):(b=c.firstSlot(),a.isAllDay=b.isDaySlot,a.start=b.startDate(),a.end=b.endDate()),this.groups[a.groupIndex]||(a.groupIndex=0)},move:function(a,b,c){var d=!1,e=this.groups[a.groupIndex];e.timeSlotCollectionCount()||(a.isAllDay=!0);var f,g,h,i,j=e.ranges(a.start,a.end,a.isAllDay,!1);if(b===x.DOWN||b===x.UP){if(d=!0,h=b===x.UP,this._updateDirection(a,j,c,h,!0),i=this._verticalSlots(a,j,c,h),!i.startSlot&&!c&&this._changeViewPeriod(a,h,!0))return d}else if((b===x.LEFT||b===x.RIGHT)&&(d=!0,h=b===x.LEFT,this._updateDirection(a,j,c,h,!1),i=this._horizontalSlots(a,j,c,h),!i.startSlot&&!c&&this._changeViewPeriod(a,h,!1)))return d;if(d){if(f=i.startSlot,g=i.endSlot,c){var k=a.backward;k&&f?a.start=f.startDate():!k&&g&&(a.end=g.endDate())}else f&&g&&(a.isAllDay=f.isDaySlot,a.start=f.startDate(),a.end=g.endDate());a.events=[]}return d},moveToEventInGroup:function(b,c,d,e){for(var f,g,h=b._continuousEvents||[],i=e?-1:1,j=h.length,k=e?j-1:0;j>k&&k>-1;){if(g=h[k],(!e&&g.start.startDate()>=c.startDate()||e&&g.start.startDate()<=c.startDate())&&(d.length&&(g=h[k+i]),g&&-1===a.inArray(g.uid,d))){f=!!g;break}k+=i}return g},moveToEvent:function(a,b){for(var c,d=a.groupIndex,e=this.groups[d],f=e.ranges(a.start,a.end,a.isAllDay,!1)[0].start,g=this.groups.length,h=b?-1:1,i=a.events;g>d&&d>-1&&(c=this.moveToEventInGroup(e,f,i,b),d+=h,e=this.groups[d],e&&!c);)i=[],f=b?e.lastSlot():e.firstSlot(!0);return c&&(a.events=[c.uid],a.start=c.start.startDate(),a.end=c.end.endDate(),a.isAllDay=c.start.isDaySlot,a.groupIndex=c.start.groupIndex),!!c},current:function(a){return void 0===a?this._current:(this._current=a,void this._scrollTo(a,this.content[0]))},select:function(a){this.clearSelection(),this._selectEvents(a)||this._selectSlots(a)},_selectSlots:function(a){var b=a.isAllDay,c=this.groups[a.groupIndex];c.timeSlotCollectionCount()||(b=!0),this._selectedSlots=[];for(var d,e,f=c.ranges(a.start,a.end,b,!1),g=0;g<f.length;g++)for(var h=f[g],i=h.collection,j=h.start.index;j<=h.end.index;j++)e=i.at(j),d=e.element,d.setAttribute("aria-selected",!0),s(d),this._selectedSlots.push({start:e.startDate(),end:e.endDate(),element:d});a.backward&&(d=f[0].start.element),this.current(d)},_selectEvents:function(b){var c,d=!1,e=b.events,f=this.groups[b.groupIndex]._continuousEvents||[],g=f.length;if(!e[0]||!f[0])return d;var h=a();for(c=0;g>c;c++)a.inArray(f[c].uid,e)>-1&&(h=h.add(f[c].element));return h[0]&&(h.addClass("k-state-selected").attr("aria-selected",!0),this.current(h.last()[0]),d=!0),d},inRange:function(a){var b=this.startDate(),c=t.date.addDays(this.endDate(),1),d=a.start,e=a.end;return d>=b&&c>d&&e>b&&c>=e},_resourceValue:function(a,b){return a.valuePrimitive&&(b=t.getter(a.dataValueField)(b)),b},_resourceBySlot:function(a){var b=this.groupedResources,c={};if(b.length)for(var d=a.groupIndex,e=b.length-1;e>=0;e--){var f=b[e],g=this._resourceValue(f,f.dataSource.view()[d%f.dataSource.total()]);f.multiple&&(g=[g]);var h=t.setter(f.field);h(c,g),d=Math.floor(d/f.dataSource.total())}return c},_createResizeHint:function(b,c,d,e){return a(A).css({left:b,top:c,width:d,height:e})},_removeResizeHint:function(){this._resizeHint.remove(),this._resizeHint=a()},_removeMoveHint:function(){this._moveHint.remove(),this._moveHint=a()},_scrollTo:function(a,b){var c=a.offsetTop,d=a.offsetHeight,e=b.scrollTop,f=b.clientHeight,g=c+d,h=0;h=e>c?c:g>e+f?f>=d?g-f:c:e,b.scrollTop=h},_shouldInverseResourceColor:function(a){var b=new K(a.color).isDark(),c=this.element.css("color"),d=new K(c).isDark();return b==d},eventResources:function(a){var b=[],c=this.options;if(!c.resources)return b;for(var d=0;d<c.resources.length;d++){var e=c.resources[d],f=e.field,g=t.getter(f)(a);if(g){e.multiple||(g=[g]);for(var h=e.dataSource.view(),i=0;i<g.length;i++){var j=null,k=g[i];e.valuePrimitive||(k=t.getter(e.dataValueField)(k));for(var l=0;l<h.length;l++)if(h[l].get(e.dataValueField)==k){j=h[l];break}if(null!==j){var m=t.getter(e.dataColorField)(j);b.push({field:e.field,title:e.title,name:e.name,text:t.getter(e.dataTextField)(j),value:k,color:m})}}}}return b},createLayout:function(d){var e=-1;d.rows||(d.rows=[]);for(var f=0;f<d.rows.length;f++)if(d.rows[f].allDay){e=f;break}var g=d.rows[e];e>=0&&d.rows.splice(e,1);var h=this.columnLevels=b(d,"columns"),i=this.rowLevels=b(d,"rows");this.table=a("<table "+c()+' class="k-scheduler-layout k-scheduler-'+this.name+'view"/>');var j=i[i.length-1].length;this.table.append(this._topSection(h,g,j)),this.table.append(this._bottomSection(h,i,j)),this.element.append(this.table),this._scroller()},refreshLayout:function(){for(var b=this,c=b.element.find(">.k-scheduler-toolbar"),d=b.element.innerHeight(),e=this._scrollbar,f=0,g=this._isRtl?"left":"right",h=0;h<c.length;h++)d-=c.eq(h).outerHeight();if(b.datesHeader&&(f=b.datesHeader.outerHeight()),b.timesHeader&&b.timesHeader.outerHeight()>f&&(f=b.timesHeader.outerHeight()),b.datesHeader&&b.timesHeader){var i=b.datesHeader.find("table:first tr");b.timesHeader.find("tr").height(function(b){a(this).height(i.eq(b).height())})}f&&(d-=f),b.footer&&(d-=b.footer.outerHeight());var j=function(a){var b,c;return a[0].style.height?!0:(b=a.height(),a.height("auto"),c=a.height(),b!=c?(a.height(""),!0):(a.height(""),!1))},k=b.content[0],l=t.support.kineticScrollNeeded?0:e;if(j(b.element)){b.content.height(d>2*e?d:2*e+1),b.times.height(k.clientHeight);var m=b.times.find("table");m.length&&m.height(b.content.find("table")[0].clientHeight)}k.offsetWidth-k.clientWidth>0?(b.table.addClass("k-scrollbar-v"),b.datesHeader.css("padding-"+g,l-parseInt(b.datesHeader.children().css("border-"+g+"-width"),10))):b.datesHeader.css("padding-"+g,""),k.offsetHeight-k.clientHeight>0||k.clientHeight>b.content.children(".k-scheduler-table").height()?b.table.addClass("k-scrollbar-h"):b.table.removeClass("k-scrollbar-h")},_topSection:function(b,c,d){this.timesHeader=f(b.length,c,d);var e=b[b.length-1].length;return this.datesHeader=g(b,e,c),a("<tr>").append(this.timesHeader.add(this.datesHeader).wrap("<td>").parent())},_bottomSection:function(b,c,d){return this.times=h(c,d),this.content=i(b[b.length-1],c[c.length-1]),a("<tr>").append(this.times.add(this.content).wrap("<td>").parent())},_scroller:function(){var b=this;this.content.bind("scroll"+y,function(){b.datesHeader.find(">.k-scheduler-header-wrap").scrollLeft(this.scrollLeft),b.times.scrollTop(this.scrollTop)});var c=t.touchScroller(this.content,{avoidScrolling:function(b){return a(b.event.target).closest(".k-event.k-event-active").length>0}});c&&c.movable&&(this._touchScroller=c,this.content=c.scrollElement,c.movable.bind("change",function(a){b.datesHeader.find(">.k-scheduler-header-wrap").scrollLeft(-a.sender.x),b.times.scrollTop(-a.sender.y)}))},_resourcesForGroups:function(){var a=[],b=this.options.group,c=this.options.resources;if(b=b&&b.resources?b.resources:[],c&&b.length)for(var d=0,e=c.length;e>d;d++)for(var f=0,g=b.length;g>f;f++)c[d].name===b[f]&&a.push(c[d]);this.groupedResources=a},_createColumnsLayout:function(a,b){return q("columns",a,b)},_groupOrientation:function(){var a=this.options.group;return a&&a.resources?a.orientation:"horizontal"},_isVerticallyGrouped:function(){return this.groupedResources.length&&"vertical"===this._groupOrientation()},_createRowsLayout:function(a,b){return q("rows",a,b)},selectionByElement:function(){return null},clearSelection:function(){this.content.find(".k-state-selected").removeAttr("id").attr("aria-selected",!1).removeClass("k-state-selected")},destroy:function(){var a=this;w.fn.destroy.call(this),a.table&&(t.destroy(a.table),a.table.remove()),a.groups=null,a.table=null,a.content=null,a.times=null,a.datesHeader=null,a.timesHeader=null,a.footer=null,a._resizeHint=null,a._moveHint=null},calendarInfo:function(){return u.calendars.standard},prevGroupSlot:function(a,b,c){var d,e=this.groups[b],f=e.ranges(a,a,c,!1)[0].start;return 0>=b?void 0:this._isVerticallyGrouped()?e.timeSlotCollectionCount()?(d=e._collection(c?f.index:f.collectionIndex,!1),d.last()):(d=e._collection(e.daySlotCollectionCount()-1,!0),d.at(f.index)):e.timeSlotCollectionCount()?(d=e._collection(c?0:e.timeSlotCollectionCount()-1,c),c?d.last():d.at(f.index)):(d=e._collection(f.collectionIndex,!0),d.last())},nextGroupSlot:function(a,b,c){var d,e,f=this.groups[b],g=f.ranges(a,a,c,!1)[0].start;return b>=this.groups.length-1?void 0:this._isVerticallyGrouped()?f.timeSlotCollectionCount()?(e=f.daySlotCollectionCount(),d=f._collection(e?0:g.collectionIndex,e),c?d.first():d.at(g.collectionIndex)):(d=f._collection(0,!0),d.at(g.index)):f.timeSlotCollectionCount()?(d=f._collection(0,c),c?d.first():d.at(g.index)):(d=f._collection(g.collectionIndex,!0),d.first())}});var K=function(a){var b,c,d,e,f,g=this,h=K.formats;if(1===arguments.length)for(a=g.resolveColor(a),e=0;e<h.length;e++)b=h[e].re,c=h[e].process,d=b.exec(a),d&&(f=c(d),g.r=f[0],g.g=f[1],g.b=f[2]);else g.r=arguments[0],g.g=arguments[1],g.b=arguments[2];g.r=g.normalizeByte(g.r),g.g=g.normalizeByte(g.g),g.b=g.normalizeByte(g.b)};K.prototype={resolveColor:function(a){return a=a||"#000","#"==a.charAt(0)&&(a=a.substr(1,6)),a=a.replace(/ /g,""),a=a.toLowerCase(),a=K.namedColors[a]||a},normalizeByte:function(a){return 0>a||isNaN(a)?0:a>255?255:a},percBrightness:function(){var a=this;return z.sqrt(.241*a.r*a.r+.691*a.g*a.g+.068*a.b*a.b)},isDark:function(){var a=this,b=a.percBrightness();return 180>b}},K.formats=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(a){return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],K.namedColors={aqua:"00ffff",azure:"f0ffff",beige:"f5f5dc",black:"000000",blue:"0000ff",brown:"a52a2a",coral:"ff7f50",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgray:"a9a9a9",darkgreen:"006400",darkorange:"ff8c00",darkred:"8b0000",dimgray:"696969",fuchsia:"ff00ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lightblue:"add8e6",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumblue:"0000cd",navy:"000080",olive:"808000",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",pink:"ffc0cb",plum:"dda0dd",purple:"800080",red:"ff0000",royalblue:"4169e1",salmon:"fa8072",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",steelblue:"4682b4",tan:"d2b48c",teal:"008080",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};var L=/\s*k-state-selected/;a.extend(v.SchedulerView,{createColumns:n,createRows:o,rangeIndex:l,collidingEvents:k,groupEqFilter:r})}(window.joy.jQuery),function(a,b){function c(a){var b=new Date(1980,1,1,0,0,0);return k(b,r(a)),b}function d(a,b,c){return a>=b&&c>=a}function e(a,b,c,d){return d=d?c>=a:c>a,a>b&&d}function f(a,b,c,d){var e=a._continuousEvents,f=e[e.length-1],g=o(b.start.startDate()).getTime();if(d&&f&&o(f.start.startDate()).getTime()==g){for(var i=e.length-1;i>-1&&!(e[i].isAllDay||o(e[i].start.startDate()).getTime()<g);i--);e.splice(i+1,0,{element:c,isAllDay:!0,uid:c.attr(h.attr("uid")),start:b.start,end:b.end})}else e.push({element:c,isAllDay:d,uid:c.attr(h.attr("uid")),start:b.start,end:b.end})}function g(a){var b=[],c=a.workWeekStart;for(b.push(c);a.workWeekEnd!=c;)c>6?c-=7:c++,b.push(c);return b}var h=window.joy,i=h.getPluginLang(),j=h.ui,k=h.date.setTime,l=j.SchedulerView,m=a.extend,n=a.proxy,o=h.date.getDate,p=h.date.MS_PER_MINUTE,q=h.date.MS_PER_DAY,r=h.date.getMilliseconds,s=".joyMultiDayView",t=h.template('<div title="(#=joy.format("{0:t} - {1:t}", start, end)#): #=title.replace(/"/g,"&\\#34;")#"><div class="k-event-template k-event-time">#:joy.format("{0:t} - {1:t}", start, end)#</div><div class="k-event-template">${title}</div></div>'),u=h.template('<div title="(#=joy.format("{0:t}", start)#): #=title.replace(/"/g,"&\\#34;")#"><div class="k-event-template">${title}</div></div>'),v=h.template("<span class='k-link k-nav-day'>#=joy.toString(date, 'ddd M/dd')#</span>"),w='<div role="gridcell" aria-selected="false" data-#=ns#uid="#=uid#"#if (resources[0]) { #style="background-color:#=resources[0].color#; border-color: #=resources[0].color#"class="k-event#=inverseColor ? " k-event-inverse" : ""#" #} else {#class="k-event"#}#><span class="k-event-actions"># if(data.tail || data.middle) {#<span class="k-icon k-i-arrow-w"></span>#}## if(data.isException()) {#<span class="k-icon k-i-exception"></span># } else if(data.isRecurring()) {#<span class="k-icon k-i-refresh"></span># } #</span>{0}<span class="k-event-actions">#if (showDelete) {#<a href="\\#" class="k-link k-event-delete"><span class="k-icon k-si-close"></span></a>#}## if(data.head || data.middle) {#<span class="k-icon k-i-arrow-e"></span>#}#</span>#if(resizable && !singleDay && !data.tail && !data.middle){#<span class="k-resize-handle k-resize-w"></span>#}##if(resizable && !singleDay && !data.head && !data.middle){#<span class="k-resize-handle k-resize-e"></span>#}#</div>',x='<div role="gridcell" aria-selected="false" data-#=ns#uid="#=uid#" #if (resources[0]) { #style="background-color:#=resources[0].color #; border-color: #=resources[0].color#"class="k-event#=inverseColor ? " k-event-inverse" : ""#"#} else {#class="k-event"#}#><span class="k-event-actions"># if(data.isException()) {#<span class="k-icon k-i-exception"></span># } else if(data.isRecurring()) {#<span class="k-icon k-i-refresh"></span># } #</span>{0}<span class="k-event-actions">#if (showDelete) {#<a href="\\#" class="k-link k-event-delete"><span class="k-icon k-si-close"></span></a>#}#</span><span class="k-event-top-actions"># if(data.tail || data.middle) {#<span class="k-icon k-i-arrow-n"></span># } #</span><span class="k-event-bottom-actions"># if(data.head || data.middle) {#<span class="k-icon k-i-arrow-s"></span># } #</span># if(resizable && !data.tail && !data.middle) {#<span class="k-resize-handle k-resize-n"></span># } ## if(resizable && !data.head && !data.middle) {#<span class="k-resize-handle k-resize-s"></span># } #</div>',y=l.extend({init:function(a,b){var c=this;l.fn.init.call(c,a,b),c.title=c.options.title||c.options.name,c._workDays=g(c.options),c._templates(),c._editable(),c.calculateDateRange(),c._groups()},_updateResizeHint:function(a,b,c,d){var e=a.isMultiDay(),f=this.groups[b],g=f.ranges(c,d,e,a.isAllDay);this._removeResizeHint();for(var i=0;i<g.length;i++){var j=g[i],k=j.startSlot(),m=k.offsetWidth,n=k.clientHeight,o=k.offsetTop;if(e)m=j.innerWidth();else{var p=j.outerRect(c,d,this.options.snap);o=p.top,n=p.bottom-p.top}var q=l.fn._createResizeHint.call(this,k.offsetLeft,o,m,n);this._resizeHint=this._resizeHint.add(q)}var r="t",s=this.content;e&&(r="M/dd",s=this.element.find(".k-scheduler-header-wrap:has(.k-scheduler-header-all-day) > div"),s.length||(s=this.content)),this._resizeHint.appendTo(s),this._resizeHint.find(".k-label-top,.k-label-bottom").text(""),
this._resizeHint.first().addClass("k-first").find(".k-label-top").text(h.toString(h.timezone.toLocalDate(c),r)),this._resizeHint.last().addClass("k-last").find(".k-label-bottom").text(h.toString(h.timezone.toLocalDate(d),r))},_updateMoveHint:function(a,b,c){var d=a.isMultiDay(),e=this.groups[b],f=h.date.toUtcTime(a.start)+c,g=f+a.duration(),i=e.ranges(f,g,d,a.isAllDay);f=h.timezone.toLocalDate(f),g=h.timezone.toLocalDate(g),this._removeMoveHint(),!d&&(0===r(g)||r(g)<r(this.startTime()))&&i.length>1&&i.pop();for(var j=0;j<i.length;j++){var k=i[j],l=k.start,m=this._createEventElement(a.clone({start:f,startTime:f,end:g,endTime:g}),!d);m.addClass("k-event-drag-hint");var n={left:l.offsetLeft+2,top:l.offsetTop};if(this._isRtl&&(n.left=.1*l.clientWidth+l.offsetLeft+2),d)n.width=k.innerWidth()-4;else{var o=k.outerRect(f,g,this.options.snap);n.top=o.top,n.height=o.bottom-o.top,n.width=.9*l.clientWidth-4}m.css(n),this._moveHint=this._moveHint.add(m)}var p=this.content;d&&(p=this.element.find(".k-scheduler-header-wrap:has(.k-scheduler-header-all-day) > div"),p.length||(p=this.content)),this._moveHint.appendTo(p)},_slotByPosition:function(a,b){var c,d;this._isVerticallyGrouped()?(d=this.content.offset(),b+=this.content[0].scrollTop,a+=this.content[0].scrollLeft):d=this.element.find(".k-scheduler-header-wrap:has(.k-scheduler-header-all-day)").find(">div").offset(),d&&(a-=d.left,b-=d.top),a=Math.ceil(a),b=Math.ceil(b);var e,f;for(f=0;f<this.groups.length;f++)if(e=this.groups[f],c=e.daySlotByPosition(a,b))return c;for(d&&(a+=d.left,b+=d.top),d=this.content.offset(),a-=d.left,b-=d.top,this._isVerticallyGrouped()||(b+=this.content[0].scrollTop,a+=this.content[0].scrollLeft),a=Math.ceil(a),b=Math.ceil(b),f=0;f<this.groups.length;f++)if(e=this.groups[f],c=e.timeSlotByPosition(a,b))return c;return null},_groupCount:function(){var a=this.groupedResources;return a.length?"vertical"===this._groupOrientation()?this._rowCountForLevel(a.length-1):this._columnCountForLevel(a.length)/this._columnOffsetForResource(a.length):1},_columnCountInResourceView:function(){var a=this.groupedResources;return!a.length||this._isVerticallyGrouped()?this._columnCountForLevel(0):this._columnOffsetForResource(a.length)},_timeSlotGroups:function(a,b){var c=this._timeSlotInterval(),d=this.content.find("tr:not(.k-scheduler-header-all-day)");d.attr("role","row");var e=d.length;this._isVerticallyGrouped()&&(e=Math.floor(e/a));for(var f=0;a>f;f++){var g=0;this._isVerticallyGrouped()&&(g=f);var h,i=g*e,j=0;for(this._isVerticallyGrouped()||(j=f);(g+1)*e>i;){var k=d[i].children,l=this.groups[f];i%e===0&&(h=r(new Date(+this.startTime())));for(var m=j*b;(j+1)*b>m;m++){var n=k[m],o=m%b,p=l.getTimeSlotCollection(o),q=this._dates[o],s=Date.UTC(q.getFullYear(),q.getMonth(),q.getDate()),t=s+h,u=t+c;n.setAttribute("role","gridcell"),n.setAttribute("aria-selected",!1),p.addTimeSlot(n,t,u)}h+=c,i++}}},_daySlotGroups:function(a,b){var c;c=this.element.find(this._isVerticallyGrouped()?".k-scheduler-header-all-day":".k-scheduler-header-all-day tr"),c.attr("role","row");for(var d=0;a>d;d++){var e=0;this._isVerticallyGrouped()&&(e=d);var f=this.groups[d],g=f.getDaySlotCollection(0),i=c[e].children,j=0;this._isVerticallyGrouped()||(j=d);for(var k=0,l=j*b;(j+1)*b>l;l++){var m=i[l];l%b===0&&(k=0);var n=h.date.addDays(this.startDate(),k),o=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate());k++,m.setAttribute("role","gridcell"),m.setAttribute("aria-selected",!1),g.addDaySlot(m,o,o+h.date.MS_PER_DAY)}}},_groups:function(){var a=this._groupCount(),b=this._columnCountInResourceView();this.groups=[];for(var c=0;a>c;c++){for(var d=this._addResourceView(c),e=0;b>e;e++)d.addTimeSlotCollection(this._dates[e],h.date.addDays(this._dates[e],1));this.options.allDaySlot&&d.addDaySlotCollection(this._dates[0],this._dates[this._dates.length-1])}this._timeSlotGroups(a,b),this.options.allDaySlot&&this._daySlotGroups(a,b)},options:{name:"MultiDayView",selectedDateFormat:"{0:D}",allDaySlot:!0,showWorkHours:!1,title:"",startTime:h.date.today(),endTime:h.date.today(),minorTickCount:2,majorTick:60,majorTimeHeaderTemplate:"#=joy.toString(date, 't')#",minorTimeHeaderTemplate:"&nbsp;",slotTemplate:"&nbsp;",allDaySlotTemplate:"&nbsp;",eventTemplate:t,allDayEventTemplate:u,dateHeaderTemplate:v,editable:!0,workDayStart:new Date(1980,1,1,8,0,0),workDayEnd:new Date(1980,1,1,17,0,0),workWeekStart:1,workWeekEnd:5,footer:{command:"workDay"},messages:i.scheduler.dayview.messages},events:["remove","add","edit"],_templates:function(){var a=this.options,b=m({},h.Template,a.templateSettings);this.eventTemplate=this._eventTmpl(a.eventTemplate,x),this.allDayEventTemplate=this._eventTmpl(a.allDayEventTemplate,w),this.majorTimeHeaderTemplate=h.template(a.majorTimeHeaderTemplate,b),this.minorTimeHeaderTemplate=h.template(a.minorTimeHeaderTemplate,b),this.dateHeaderTemplate=h.template(a.dateHeaderTemplate,b),this.slotTemplate=h.template(a.slotTemplate,b),this.allDaySlotTemplate=h.template(a.allDaySlotTemplate,b)},_editable:function(){this.options.editable&&(this._isMobile()?this._touchEditable():this._mouseEditable())},_mouseEditable:function(){var b=this;b.element.on("click"+s,".k-event a:has(.k-si-close)",function(c){b.trigger("remove",{uid:a(this).closest(".k-event").attr(h.attr("uid"))}),c.preventDefault()}),b.options.editable.create!==!1&&b.element.on("dblclick"+s,".k-scheduler-content td",function(c){if(!a(this).parent().hasClass("k-scheduler-header-all-day")){var d=b._slotByPosition(c.pageX,c.pageY);if(d){var e=b._resourceBySlot(d);b.trigger("add",{eventInfo:m({start:d.startDate(),end:d.endDate()},e)})}c.preventDefault()}}).on("dblclick"+s,".k-scheduler-header-all-day td",function(a){var c=b._slotByPosition(a.pageX,a.pageY);if(c){var d=b._resourceBySlot(c);b.trigger("add",{eventInfo:m({},{isAllDay:!0,start:h.date.getDate(c.startDate()),end:h.date.getDate(c.startDate())},d)})}a.preventDefault()}),b.options.editable.update!==!1&&b.element.on("dblclick"+s,".k-event",function(c){b.trigger("edit",{uid:a(this).closest(".k-event").attr(h.attr("uid"))}),c.preventDefault()})},_touchEditable:function(){var b=this;b.options.editable.create!==!1&&(b._addUserEvents=new h.UserEvents(b.element,{filter:".k-scheduler-content td",tap:function(c){if(!a(c.target).parent().hasClass("k-scheduler-header-all-day")){var d=b._slotByPosition(c.x.location,c.y.location);if(d){var e=b._resourceBySlot(d);b.trigger("add",{eventInfo:m({start:d.startDate(),end:d.endDate()},e)})}c.preventDefault()}}}),b._allDayUserEvents=new h.UserEvents(b.element,{filter:".k-scheduler-header-all-day td",tap:function(a){var c=b._slotByPosition(a.x.location,a.y.location);if(c){var d=b._resourceBySlot(c);b.trigger("add",{eventInfo:m({},{isAllDay:!0,start:h.date.getDate(c.startDate()),end:h.date.getDate(c.startDate())},d)})}a.preventDefault()}})),b.options.editable.update!==!1&&(b._editUserEvents=new h.UserEvents(b.element,{filter:".k-event",tap:function(c){var d=a(c.target).closest(".k-event");d.hasClass("k-event-active")||b.trigger("edit",{uid:d.attr(h.attr("uid"))}),c.preventDefault()}}))},_layout:function(a){for(var b=[],c=[],d=this.options,e=this,f=0;f<a.length;f++){var g={};g.text=e.dateHeaderTemplate({date:a[f]}),h.date.isToday(a[f])&&(g.className="k-today"),b.push(g)}var i=this.groupedResources;return d.allDaySlot&&c.push({text:d.messages.allDay,allDay:!0,cellContent:function(b){var c=b;return b=i.length&&"vertical"!==e._groupOrientation()?b%a.length:b,e.allDaySlotTemplate({date:a[b],resources:function(){return e._resourceBySlot({groupIndex:c})}})}}),this._forTimeRange(this.startTime(),this.endTime(),function(a,b,d,f){var g=b?e.majorTimeHeaderTemplate:e.minorTimeHeaderTemplate,h={text:g({date:a}),className:f?"k-slot-cell":""};c.push(h)}),i.length&&("vertical"===this._groupOrientation()?c=this._createRowsLayout(i,c):b=this._createColumnsLayout(i,b)),{columns:b,rows:c}},_footer:function(){var b=this.options;if(b.footer!==!1){var c='<div class="k-header k-scheduler-footer">',d=b.footer.command;d&&"workDay"===d?(c+='<ul class="k-reset k-header k-toolbar">',c+='<li class="k-state-default k-scheduler-fullday"><a href="#" class="k-link"><span class="k-icon k-i-clock"></span>',c+=(b.showWorkHours?b.messages.showFullDay:b.messages.showWorkDay)+"</a></li>",c+="</ul>"):c+="&nbsp;",c+="</div>",this.footer=a(c).appendTo(this.element);var e=this;this.footer.on("click"+s,".k-scheduler-fullday",function(a){a.preventDefault(),e.trigger("navigate",{view:e.name||b.name,date:e.startDate(),isWorkDay:!b.showWorkHours})})}},_forTimeRange:function(a,b,d,e){a=c(a),b=c(b);var f,g,h=this,i=r(a),j=r(b),l=h.options.minorTickCount,m=h.options.majorTick*p,n=m/l||1,o=new Date(+a),s=o.getDate(),t=0,u="";for(g=q/n,i!=j&&(i>j&&(j+=q),g=(j-i)/n),g=Math.round(g);g>t;t++){var v=t%(m/n),w=0===v,x=l-1>v,y=v===l-1;u+=d(o,w,x,y),k(o,n,!1)}return j&&(f=r(o),s<o.getDate()&&(f+=q),f>j&&(o=new Date(+b))),e&&(u+=e(o)),u},_content:function(a){var b,c=this,d=c.options,e=c.startTime(),f=this.endTime(),g=1,i=1,j=a.length,k="",l=this.groupedResources,m=this.slotTemplate,n=this.allDaySlotTemplate,o=!1;l.length&&(o="vertical"===c._groupOrientation(),o?(i=this._rowCountForLevel(this.rowLevels.length-2),d.allDaySlot&&(b=function(b){for(var d='<tr class="k-scheduler-header-all-day">',e=function(){return c._resourceBySlot({groupIndex:b})},f=0,g=a.length;g>f;f++)d+="<td>"+n({date:a[f],resources:e})+"</td>";return d+"</tr>"})):g=this._columnCountForLevel(this.columnLevels.length-2)),k+="<tbody>";for(var p=function(b,d){var e,f,i,k="",l="",n=0;k="<tr"+(d?' class="k-middle-row"':"")+">";for(var p=function(a){return function(){return c._resourceBySlot({groupIndex:a})}};g>n;n++)for(e=0,f=j;f>e;e++)l="",h.date.isToday(a[e])&&(l+="k-today"),(h.date.getMilliseconds(b)<h.date.getMilliseconds(c.options.workDayStart)||h.date.getMilliseconds(b)>=h.date.getMilliseconds(c.options.workDayEnd)||!c._isWorkDay(a[e]))&&(l+=" k-nonwork-hour"),k+="<td"+(""!==l?' class="'+l+'"':"")+">",i=h.date.getDate(a[e]),h.date.setTime(i,h.date.getMilliseconds(b)),k+=m({date:i,resources:p(o?q:n)}),k+="</td>";return k+="</tr>"},q=0;i>q;q++)k+=b?b(q):"",k+=this._forTimeRange(e,f,p);k+="</tbody>",this.content.find("table").append(k)},_isWorkDay:function(a){for(var b=a.getDay(),c=this._workDays,d=0;d<c.length;d++)if(c[d]===b)return!0;return!1},_render:function(b){var c=this;b=b||[],this._dates=b,this._startDate=b[0],this._endDate=b[b.length-1||0],this.createLayout(this._layout(b)),this._content(b),this._footer(),this.refreshLayout();var d=this.element.find(".k-scheduler-header-all-day td");d.length&&(this._allDayHeaderHeight=d.first()[0].clientHeight),c.datesHeader.on("click"+s,".k-nav-day",function(b){var d=a(b.currentTarget).closest("th"),e=d.offset(),f=c._slotByPosition(e.left,e.top+d.outerHeight());c.trigger("navigate",{view:"day",date:f.startDate()})})},startTime:function(){var a=this.options;return a.showWorkHours?a.workDayStart:a.startTime},endTime:function(){var a=this.options;return a.showWorkHours?a.workDayEnd:a.endTime},startDate:function(){return this._startDate},endDate:function(){return this._endDate},_end:function(a){var b=r(this.endTime())||q;return a&&(b=0),new Date(this._endDate.getTime()+b)},nextDate:function(){return h.date.nextDay(this.endDate())},previousDate:function(){return h.date.previousDay(this.startDate())},calculateDateRange:function(){this._render([this.options.date])},destroy:function(){var a=this;a.datesHeader&&a.datesHeader.off(s),a.element&&a.element.off(s),a.footer&&a.footer.remove(),l.fn.destroy.call(this),this._isMobile()&&a.options.editable&&(a.options.editable.create!==!1&&(a._addUserEvents.destroy(),a._allDayUserEvents.destroy()),a.options.editable.update!==!1&&a._editUserEvents.destroy())},inRange:function(a){var b=l.fn.inRange.call(this,a),c=r(this.startTime()),d=r(this.endTime())||h.date.MS_PER_DAY,e=r(a.start),f=r(a.end)||h.date.MS_PER_DAY;return b&&e>=c&&d>=f},selectionByElement:function(a){var b=a.offset();return this._slotByPosition(b.left,b.top)},_timeSlotInterval:function(){var a=this.options;return a.majorTick/a.minorTickCount*p},_timeSlotIndex:function(a){var b=this.options,c=r(a),d=r(this.startTime()),e=b.majorTick/b.minorTickCount*p;return(c-d)/e},_slotIndex:function(a,b){return b?this._dateSlotIndex(a):this._timeSlotIndex(a)},_dateSlotIndex:function(a,b){var c,e,f,g,i=this._dates||[],j=1;for(c=0,e=i.length;e>c;c++)if(f=h.date.getDate(i[c]),g=new Date(h.date.getDate(i[c]).getTime()+q-(b?0:1)),d(a,f,g))return c*j;return-1},_positionAllDayEvent:function(b,c){var d=c.innerWidth(),e=c.start.index,f=c.end.index,g=l.collidingEvents(c.events(),e,f),h=this._headerColumnCount||0,i=2,j=e!==f?5:4,k=this._allDayHeaderHeight,m=c.startSlot();b.css({left:m.offsetLeft+i,width:d-j}),c.addEvent({slotIndex:e,start:e,end:f,element:b}),g.push({slotIndex:e,start:e,end:f,element:b});var n=l.createRows(g);n.length&&n.length>h&&(this._headerColumnCount=n.length);for(var o=c.start.offsetTop,p=0,q=n.length;q>p;p++)for(var r=n[p].events,s=0,t=r.length;t>s;s++)a(r[s].element).css({top:o+p*k})},_arrangeColumns:function(a,b,c,d){var e=d.start;a={element:a,slotIndex:e.index,start:b,end:b+c};var f,g,h=e.clientWidth,i=.1*h,j=d.events(),k=l.collidingEvents(j,a.start,a.end);d.addEvent(a),k.push(a),f=l.createColumns(k);for(var m=(h-i)/f.length,n=0,o=f.length;o>n;n++){g=f[n].events;for(var p=0,q=g.length;q>p;p++)g[p].element[0].style.width=m-4+"px",g[p].element[0].style.left=(this._isRtl?i:0)+e.offsetLeft+n*m+2+"px"}},_positionEvent:function(a,b,c){var d=a.start,e=a.end;a.startTime&&(d=h.date.getMilliseconds(a.startTime)+h.date.toUtcTime(h.date.getDate(a.start))),a.endTime&&(e=h.date.getMilliseconds(a.endTime)+h.date.toUtcTime(h.date.getDate(a.end)));var f=c.innerRect(d,e,!1),g=f.bottom-f.top-2;0>g&&(g=0),b.css({top:f.top,height:g}),this._arrangeColumns(b,f.top,b[0].clientHeight,c)},_eventTmpl:function(a,b){var c=this.options,d=m({},h.Template,c.templateSettings),e=d.paramName,f="",g=typeof a,i={storage:{},count:0};"function"===g?(i.storage["tmpl"+i.count]=a,f+="#=this.tmpl"+i.count+"("+e+")#",i.count++):"string"===g&&(f+=a);var j=h.template(h.format(b,f),d);return i.count>0&&(j=n(j,i.storage)),j},_createEventElement:function(b,c,e,f){var g,i=c?this.eventTemplate:this.allDayEventTemplate,j=this.options,k=j.editable,l=this._isMobile(),n=k&&k.destroy!==!1&&!l,p=k&&k.resize!==!1,s=o(this.startDate()),t=o(this.endDate()),u=r(this.startTime()),v=r(this.endTime()),w=r(b.startTime||b.start),x=r(b.endTime||b.end);u>=v&&(v=r(new Date(this.endTime().getTime()+q-1))),c||b.isAllDay||(t=new Date(t.getTime()+q));var y=b.end;b.isAllDay&&(y=o(b.end)),!d(o(b.start),s,t)&&!d(y,s,t)||c&&u>w&&x>v?g=!0:o(b.start)<s||c&&u>w?f=!0:(y>t&&!c||c&&x>v)&&(e=!0);var z=this.eventResources(b);return a(i(m({},{ns:h.ns,resizable:p,showDelete:n,middle:g,head:e,tail:f,singleDay:1==this._dates.length,resources:z,inverseColor:z&&z[0]?this._shouldInverseResourceColor(z[0]):!1},b,{start:b.startTime||b.start,end:b.endTime||b.end})))},_isInTimeSlot:function(a){var b=this.startTime(),c=this.endTime(),d=a.startTime||a.start,f=a.endTime||a.end;if(r(c)===r(h.date.getDate(c))&&(c=h.date.getDate(c),k(c,q-1)),h.date.getDate(f)>h.date.getDate(d)&&(f=h.date.getDate(f),k(f,q-1)),f=r(f),d=r(d),c=r(c),b=r(b),b===d&&d===f)return!0;var g=d!==c;return e(d,b,c,g)||e(f,b,c,g)||e(b,d,f)||e(c,d,f)},_isInDateSlot:function(a){var b=this.groups[0],c=b.firstSlot().start,e=b.lastSlot().end-1,f=h.date.toUtcTime(a.start),g=h.date.toUtcTime(a.end);return(d(f,c,e)||d(g,c,e)||d(c,f,g)||d(e,f,g))&&(!d(g,c,c)||d(g,f,f)||a.isAllDay)},_updateAllDayHeaderHeight:function(a){if(this._height!==a){this._height=a;var b=this.element.find(".k-scheduler-header-all-day td");if(b.length){b.parent().add(this.element.find(".k-scheduler-times-all-day").parent()).height(a);for(var c=0;c<this.groups.length;c++)this.groups[c].refresh()}}},_renderEvents:function(a,b){var c,d,e,g=this.datesHeader.find(".k-scheduler-header-wrap > div");for(d=0,e=a.length;e>d;d++)if(c=a[d],this._isInDateSlot(c)){var h,i,j,k=c.isAllDay||c.end.getTime()-c.start.getTime()>=q,l=k&&!this._isVerticallyGrouped()?g:this.content;if(k)this.options.allDaySlot&&(j=this.groups[b],j._continuousEvents||(j._continuousEvents=[]),i=j.slotRanges(c),h=this._createEventElement(c,!k),this._positionAllDayEvent(h,i[0]),f(j,i[0],h,!0),h.appendTo(l));else if(this._isInTimeSlot(c)){j=this.groups[b],j._continuousEvents||(j._continuousEvents=[]),i=j.slotRanges(c);for(var m=i.length,n=0;m>n;n++){var o=i[n],p=c.start,r=c.end;m>1&&(0===n?r=o.end.endDate():n==m-1?p=o.start.startDate():(p=o.start.startDate(),r=o.end.endDate()));var s=c.clone({start:p,end:r,startTime:c.startTime,endTime:c.endTime});if(this._isInTimeSlot(s)){var t=o.head;h=this._createEventElement(c,!k,t,o.tail),h.appendTo(l),this._positionEvent(s,h,o),f(j,o,h,!1)}}}}},render:function(b){this._headerColumnCount=0,this._groups(),this.element.find(".k-event").remove(),b=new h.data.Query(b).sort([{field:"start",dir:"asc"},{field:"end",dir:"desc"}]).toArray();var c=[];this._eventsByResource(b,this.groupedResources,c);var e=a.map(this._dates,function(b){return Math.max.apply(null,a.map(c,function(c){return a.grep(c,function(a){return a.isMultiDay()&&d(b,a.start,a.end)}).length}))}),f=Math.max.apply(null,e);this._updateAllDayHeaderHeight((f+1)*this._allDayHeaderHeight);for(var g=0;g<c.length;g++)this._renderEvents(c[g],g);this.refreshLayout(),this.trigger("activate")},_eventsByResource:function(a,b,c){var d=b[0];if(d)for(var e=d.dataSource.view(),f=0;f<e.length;f++){var g=this._resourceValue(d,e[f]),i=new h.data.Query(a).filter({field:d.field,operator:l.groupEqFilter(g)}).toArray();b.length>1?this._eventsByResource(i,b.slice(1),c):c.push(i)}else c.push(a)},_columnOffsetForResource:function(a){return this._columnCountForLevel(a)/this._columnCountForLevel(a-1)},_columnCountForLevel:function(a){var b=this.columnLevels[a];return b?b.length:0},_rowCountForLevel:function(a){var b=this.rowLevels[a];return b?b.length:0},clearSelection:function(){this.content.add(this.datesHeader).find(".k-state-selected").removeAttr("id").attr("aria-selected",!1).removeClass("k-state-selected")},_updateDirection:function(a,b,c,d,e){var f=a.isAllDay,g=b[0].start,h=b[b.length-1].end;c&&(e?f||g.index!==h.index||g.collectionIndex!==h.collectionIndex||(a.backward=d):(f&&g.index===h.index||!f&&g.collectionIndex===h.collectionIndex)&&(a.backward=d))},_changeViewPeriod:function(a,b,c){if(!c){var d=b?this.previousDate():this.nextDate(),e=a.start,f=a.end;a.start=new Date(d),a.end=new Date(d);var g=a.isAllDay?q:r(f);return k(a.start,r(e)),k(a.end,g),this._isVerticallyGrouped()||(a.groupIndex=b?this.groups.length-1:0),a.events=[],!0}}});m(!0,j,{MultiDayView:y,DayView:y.extend({options:{title:"Day"},name:"day"}),WeekView:y.extend({options:{title:"Week",selectedDateFormat:"{0:D} - {1:D}"},name:"week",calculateDateRange:function(){var a,b,c=this.options.date,d=h.date.dayOfWeek(c,this.calendarInfo().firstDay,-1),e=[];for(a=0,b=7;b>a;a++)e.push(d),d=h.date.nextDay(d);this._render(e)}}),WorkWeekView:y.extend({options:{title:"Work Week",selectedDateFormat:"{0:D} - {1:D}"},name:"workweek",nextDate:function(){return h.date.dayOfWeek(h.date.nextDay(this.endDate()),this.options.workWeekStart,1)},previousDate:function(){return h.date.previousDay(this.startDate())},calculateDateRange:function(){for(var a=this.options.date,b=h.date.dayOfWeek(a,this.options.workWeekStart,-1),c=h.date.dayOfWeek(b,this.options.workWeekEnd,1),d=[];c>=b;)d.push(b),b=h.date.nextDay(b);this._render(d)}})})}(window.joy.jQuery),function(a){function b(a){for(var b=0,c=0,d=a.length;d>c;c++)b+=a[c].items.length;return b}function c(a,b){return a.valuePrimitive&&(b=f.getter(a.dataValueField)(b)),b}function d(a){for(var b,c=0,d=a.length,f=[];d>c;c++)b=a[c],b.groups?(b=e(b.groups),f=f.concat(b)):f=f.concat(e(b.items));return f}function e(a){for(var b=[].concat(a),c=b.shift(),d=[],e=[].push;c;)c.groups?e.apply(b,c.groups):c.items?e.apply(b,c.items):e.call(d,c),c=b.shift();return d}var f=window.joy,g=f.getPluginLang(),h=f.ui,i=".joyAgendaView";h.AgendaView=h.SchedulerView.extend({init:function(b,c){h.SchedulerView.fn.init.call(this,b,c),c=this.options,c.editable&&(c.editable=a.extend({"delete":!0},c.editable,{create:!1,update:!1})),this.title=c.title,this.name="agenda",this._eventTemplate=f.template(c.eventTemplate),this._dateTemplate=f.template(c.eventDateTemplate),this._groupTemplate=f.template(c.eventGroupTemplate),this._timeTemplate=f.template(c.eventTimeTemplate),this.element.on("mouseenter"+i,".k-scheduler-agenda .k-scheduler-content tr","_mouseenter").on("mouseleave"+i,".k-scheduler-agenda .k-scheduler-content tr","_mouseleave").on("click"+i,".k-scheduler-agenda .k-scheduler-content .k-link:has(.k-si-close)","_remove"),this._renderLayout(c.date)},_mouseenter:function(b){a(b.currentTarget).addClass("k-state-hover")},_mouseleave:function(b){a(b.currentTarget).removeClass("k-state-hover")},_remove:function(b){b.preventDefault(),this.trigger("remove",{uid:a(b.currentTarget).closest(".k-task").attr(f.attr("uid"))})},nextDate:function(){return f.date.nextDay(this.startDate())},startDate:function(){return this._startDate},endDate:function(){return this._endDate},previousDate:function(){return f.date.previousDay(this.startDate())},_renderLayout:function(a){this._startDate=a,this._endDate=f.date.addDays(a,7),this.createLayout(this._layout()),this.table.addClass("k-scheduler-agenda")},_layout:function(){var a=[{text:this.options.messages.time,className:"k-scheduler-timecolumn"},{text:this.options.messages.event}];this._isMobilePhoneView()||a.splice(0,0,{text:this.options.messages.date,className:"k-scheduler-datecolumn"});var b=this.groupedResources;if(b.length){for(var c=[],d=0;d<b.length;d++)c.push({text:"",className:"k-scheduler-groupcolumn"});a=c.concat(a)}return{columns:a}},_tasks:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=d.start,g=d.end,h=(f.date.getDate(g)-f.date.getDate(e))/f.date.MS_PER_DAY+1,i=d.clone();if(i.startDate=f.date.getDate(e),i.startDate>=this.startDate()&&b.push(i),h>1){i.end=f.date.nextDay(e),i.head=!0;for(var j=1;h>j;j++)e=i.end,i=d.clone(),i.start=e,i.startDate=f.date.getDate(e),i.end=f.date.nextDay(e),j==h-1?(i.end=new Date(i.start.getFullYear(),i.start.getMonth(),i.start.getDate(),g.getHours(),g.getMinutes(),g.getSeconds(),g.getMilliseconds()),i.tail=!0):(i.isAllDay=!0,i.middle=!0),i.end<=this.endDate()&&i.start>=this.startDate()&&b.push(i)}}return new f.data.Query(b).sort([{field:"start",dir:"asc"},{field:"end",dir:"asc"}]).groupBy({field:"startDate"}).toArray()},_renderTaskGroups:function(a,b){for(var c=[],d=this.options.editable,e=d&&d.destroy!==!1&&!this._isMobile(),g=this._isMobilePhoneView(),h=0;h<a.length;h++)for(var i=a[h].value,j=a[h].items,k=f.date.isToday(i),l=0;l<j.length;l++){var m=j[l],n=[],o=g?[]:n;if(0===h&&0===l&&b.length)for(var p=0;p<b.length;p++)o.push(f.format('<td class="k-scheduler-groupcolumn{2}" rowspan="{0}">{1}</td>',b[p].rowSpan,this._groupTemplate({value:b[p].text}),b[p].className));0===l&&(g?(o.push(f.format('<td class="k-scheduler-datecolumn" colspan="2">{0}</td>',this._dateTemplate({date:i}))),c.push('<tr role="row" aria-selected="false"'+(k?' class="k-today">':">")+o.join("")+"</tr>")):n.push(f.format('<td class="k-scheduler-datecolumn{3}{2}" rowspan="{0}">{1}</td>',j.length,this._dateTemplate({date:i}),h!=a.length-1||b.length?"":" k-last",b.length?"":" k-first"))),m.format=m.head?"{0:t}":m.tail?"{1:t}":"{0:t}-{1:t}",m.resources=this.eventResources(m),n.push(f.format('<td class="k-scheduler-timecolumn"><div>{0}{1}{2}</div></td><td>{3}</td>',m.tail||m.middle?'<span class="k-icon k-i-arrow-w"></span>':"",this._timeTemplate(m.clone({start:m.startTime||m.start,end:m.endTime||m.end})),m.head||m.middle?'<span class="k-icon k-i-arrow-e"></span>':"",this._eventTemplate(m.clone({showDelete:e})))),c.push('<tr role="row" aria-selected="false"'+(k?' class="k-today">':">")+n.join("")+"</tr>")}return c.join("")},render:function(a){var b=this.content.find("table").empty(),c=[];if(a.length>0){var e=this.groupedResources;e.length?(c=this._createGroupConfiguration(a,e,null),this._renderGroups(c,b,[])):(c=this._tasks(a),b.append(this._renderTaskGroups(c,[])))}this._eventsList=d(c),this.refreshLayout(),this.trigger("activate")},_renderGroups:function(a,b,c){for(var d=0,e=a.length;e>d;d++){var f=c.splice(0);f.push(a[d]),a[d].groups?this._renderGroups(a[d].groups,b,f):b.append(this._renderTaskGroups(a[d].items,f))}},_createGroupConfiguration:function(a,d,e){for(var g=d[0],i=[],j=g.dataSource.view(),k=this._isMobilePhoneView(),l=0;l<j.length;l++){var m=c(g,j[l]),n=new f.data.Query(a).filter({field:g.field,operator:h.SchedulerView.groupEqFilter(m)}).toArray();if(n.length){var o=this._tasks(n),p=e?"":" k-first";l===j.length-1&&(!e||e.className.indexOf("k-last")>-1)&&(p+=" k-last");var q={text:f.getter(g.dataTextField)(j[l]),value:m,rowSpan:0,className:p};if(d.length>1)q.groups=this._createGroupConfiguration(n,d.slice(1),q),e&&(e.rowSpan+=q.rowSpan);else{q.items=o;var r=b(q.items);k&&(r+=q.items.length),q.rowSpan=r,e&&(e.rowSpan+=r)}i.push(q)}}return i},selectionByElement:function(b){if(b=a(b),!b.hasClass("k-scheduler-datecolumn")){var c=b.parent().index(),d=this._eventsList[c];return{index:c,start:d.start,end:d.end,isAllDay:d.isAllDay,uid:d.uid}}},select:function(a){this.clearSelection();var b=this.table.find(".k-task").eq(a.index).closest("tr").addClass("k-state-selected").attr("aria-selected",!0)[0];this.current(b)},move:function(a,b){var c=!1,d=a.index;if(b==f.keys.UP?(d--,c=!0):b==f.keys.DOWN&&(d++,c=!0),c){var e=this._eventsList[d];e&&(a.start=e.start,a.end=e.end,a.isAllDay=e.isAllDay,a.events=[e.uid],a.index=d)}return c},moveToEvent:function(){return!1},constrainSelection:function(a){var b=this._eventsList[0];b&&(a.start=b.start,a.end=b.end,a.isAllDay=b.isAllDay,a.events=[b.uid],a.index=0)},isInRange:function(){return!0},destroy:function(){this.element&&this.element.off(i),h.SchedulerView.fn.destroy.call(this)},options:{title:"Agenda",name:"agenda",editable:!0,selectedDateFormat:"{0:D}-{1:D}",eventTemplate:'<div class="k-task" title="#:title.replace(/"/g,"\'")#" data-#=joy.ns#uid="#=uid#"># if (resources[0]) {#<span class="k-scheduler-mark" style="background-color:#=resources[0].color#"></span># } ## if (data.isException()) { #<span class="k-icon k-i-exception"></span># } else if (data.isRecurring()) {#<span class="k-icon k-i-refresh"></span># } ##:title##if (showDelete) {#<a href="\\#" class="k-link k-event-delete"><span class="k-icon k-si-close"></span></a>#}#</div>',eventTimeTemplate:"#if(data.isAllDay) {#all day#} else { ##=joy.format(format, start, end)## } #",eventDateTemplate:'<strong class="k-scheduler-agendaday">#=joy.toString(date, "dd")#</strong><em class="k-scheduler-agendaweek">#=joy.toString(date,"dddd")#</em><span class="k-scheduler-agendadate">#=joy.toString(date, "y")#</span>',eventGroupTemplate:'<strong class="k-scheduler-adgendagroup">#=value#</strong>',messages:g.scheduler.agendaview.messages}})}(window.joy.jQuery),function(a,b){function c(a,b){return a.slice(b).concat(a.slice(0,b))}function d(a,b){for(var c=b.firstDay,d=new Date(a.getFullYear(),a.getMonth(),0,a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds());d.getDay()!=c;)f.date.setTime(d,-1*m);return d}function e(a,b,c){var d,e=b,f=c;return d=a,d>=e&&f>=d}var f=window.joy,g=(f.getPluginLang(),f.ui),h=g.SchedulerView,i=".joyMonthView",j=a.extend,k=a.proxy,l=f.date.getDate,m=f.date.MS_PER_DAY,n=6,o=7,p=f.template('<span class="k-link k-nav-day">#:joy.toString(date, "dd")#</span>'),q='<div role="gridcell" aria-selected="false" data-#=ns#uid="#=uid#"#if (resources[0]) { #style="background-color:#=resources[0].color #; border-color: #=resources[0].color#"class="k-event#=inverseColor ? " k-event-inverse" : ""#"#} else {#class="k-event"#}#><span class="k-event-actions"># if(data.tail || data.middle) {#<span class="k-icon k-i-arrow-w"></span>#}## if(data.isException()) {#<span class="k-icon k-i-exception"></span># } else if(data.isRecurring()) {#<span class="k-icon k-i-refresh"></span>#}#</span>{0}<span class="k-event-actions">#if (showDelete) {#<a href="\\#" class="k-link k-event-delete"><span class="k-icon k-si-close"></span></a>#}## if(data.head || data.middle) {#<span class="k-icon k-i-arrow-e"></span>#}#</span># if(resizable && !data.tail && !data.middle) {#<span class="k-resize-handle k-resize-w"></span>#}## if(resizable && !data.head && !data.middle) {#<span class="k-resize-handle k-resize-e"></span>#}#</div>',r=f.template('<div title="#=title.replace(/"/g,"&\\#34;")#"><div class="k-event-template">#:title#</div></div>'),s=f.template('<div style="width:#=width#px;left:#=left#px;top:#=top#px" class="k-more-events k-button"><span>...</span></div>');g.MonthView=h.extend({init:function(a,b){var c=this;h.fn.init.call(c,a,b),c.title=c.options.title,c.name="month",c._templates(),c._editable(),c._renderLayout(c.options.date),c._groups()},_updateDirection:function(a,b,c,d,e){if(c){var f,g=b[0].start,h=b[b.length-1].end,i=g.index===h.index,j=g.collectionIndex===h.collectionIndex;f=e?i&&j||j:i&&j,f&&(a.backward=d)}},_changeViewPeriod:function(a,b,c){var d=c?7:1;return b&&(d*=-1),a.start=f.date.addDays(a.start,d),a.end=f.date.addDays(a.end,d),(!c||c&&this._isVerticallyGrouped())&&(a.groupIndex=b?this.groups.length-1:0),a.events=[],!0},_continuousSlot:function(a,b,c){var d=a.backward?0:b.length-1,e=this.groups[a.groupIndex];return e.continuousSlot(b[d].start,c)},_changeGroupContinuously:function(a,b,c,d){if(!c){var e=a.groupIndex,f=this.groups.length-1,g=this._isVerticallyGrouped(),h=this.groups[e];!b&&g?(b=h[d?"lastSlot":"firstSlot"](),e+=d?-1:1):b&&!g&&(e=d?f:0),(0>e||e>f)&&(e=d?f:0,b=null),a.groupIndex=e}return b},_normalizeHorizontalSelection:function(a,b,c){var d;return d=c?b[0].start:b[b.length-1].end},_normalizeVerticalSelection:function(a,b){var c;return c=a.backward?b[0].start:b[b.length-1].end},_templates:function(){var a=this.options,b=j({},f.Template,a.templateSettings);this.eventTemplate=this._eventTmpl(a.eventTemplate),this.dayTemplate=f.template(a.dayTemplate,b)},dateForTitle:function(){return f.format(this.options.selectedDateFormat,this._firstDayOfMonth,this._lastDayOfMonth)},nextDate:function(){return f.date.nextDay(this._lastDayOfMonth)},previousDate:function(){return f.date.previousDay(this._firstDayOfMonth)},startDate:function(){return this._startDate},endDate:function(){return this._endDate},_renderLayout:function(b){var c=this;this._firstDayOfMonth=f.date.firstDayOfMonth(b),this._lastDayOfMonth=f.date.lastDayOfMonth(b),this._startDate=d(b,this.calendarInfo()),this.createLayout(this._layout()),this._content(),this.refreshLayout(),this.content.on("click"+i,".k-nav-day,.k-more-events",function(b){var d=a(b.currentTarget).offset(),e=c._slotByPosition(d.left,d.top);b.preventDefault(),c.trigger("navigate",{view:"day",date:e.startDate()})})},_editable:function(){this.options.editable&&!this._isMobilePhoneView()&&(this._isMobile()?this._touchEditable():this._mouseEditable())},_mouseEditable:function(){var b=this;b.element.on("click"+i,".k-scheduler-monthview .k-event a:has(.k-si-close)",function(c){b.trigger("remove",{uid:a(this).closest(".k-event").attr(f.attr("uid"))}),c.preventDefault()}),b.options.editable.create!==!1&&b.element.on("dblclick"+i,".k-scheduler-monthview .k-scheduler-content td",function(c){var d=a(c.currentTarget).offset(),e=b._slotByPosition(d.left,d.top);if(e){var f=b._resourceBySlot(e);b.trigger("add",{eventInfo:j({isAllDay:!0,start:e.startDate(),end:e.startDate()},f)})}c.preventDefault()}),b.options.editable.update!==!1&&b.element.on("dblclick"+i,".k-scheduler-monthview .k-event",function(c){b.trigger("edit",{uid:a(this).closest(".k-event").attr(f.attr("uid"))}),c.preventDefault()})},_touchEditable:function(){var b=this;b.options.editable.create!==!1&&(b._addUserEvents=new f.UserEvents(b.element,{filter:".k-scheduler-monthview .k-scheduler-content td",tap:function(c){var d=a(c.target).offset(),e=b._slotByPosition(d.left,d.top);

if(e){var f=b._resourceBySlot(e);b.trigger("add",{eventInfo:j({isAllDay:!0,start:e.startDate(),end:e.startDate()},f)})}c.preventDefault()}})),b.options.editable.update!==!1&&(b._editUserEvents=new f.UserEvents(b.element,{filter:".k-scheduler-monthview .k-event",tap:function(c){0===a(c.event.target).closest("a:has(.k-si-close)").length&&(b.trigger("edit",{uid:a(c.target).closest(".k-event").attr(f.attr("uid"))}),c.preventDefault())}}))},selectionByElement:function(b){var c=a(b).offset();return this._slotByPosition(c.left,c.top)},_columnCountForLevel:function(a){var b=this.columnLevels[a];return b?b.length:0},_rowCountForLevel:function(a){var b=this.rowLevels[a];return b?b.length:0},_content:function(){var a="<tbody>",b=1,c=this.groupedResources;c.length&&this._isVerticallyGrouped()&&(b=this._rowCountForLevel(c.length-1));for(var d=0;b>d;d++)a+=this._createCalendar(d);a+="</tbody>",this.content.find("table").html(a)},_createCalendar:function(a){var b=this.startDate(),c=o*n,d=o,e=[b],g="",h=1,i=this._isVerticallyGrouped(),j=this.groupedResources;j.length&&(i||(h=this._columnCountForLevel(j.length-1))),this._slotIndices={};for(var k=0,l=c/d;l>k;k++){g+="<tr>",e.push(b);for(var m=k*d,p=0;h>p;p++)g+=this._createRow(b,m,d,i?a:p);b=f.date.addDays(b,d),g+="</tr>"}return this._weekStartDates=e,this._endDate=f.date.previousDay(b),g},_createRow:function(a,b,c,d){for(var e=this,g=e._firstDayOfMonth,h=e._lastDayOfMonth,i=e.dayTemplate,j="",k="",m=function(){return e._resourceBySlot({groupIndex:d})},n=0;c>n;n++)j="",f.date.isToday(a)&&(j+="k-today"),f.date.isInDateRange(a,g,h)||(j+=" k-other-month"),k+="<td ",""!==j&&(k+='class="'+j+'"'),k+=">",k+=i({date:a,resources:m}),k+="</td>",e._slotIndices[l(a).getTime()]=b+n,a=f.date.nextDay(a);return k},_layout:function(){var b,d=this.calendarInfo(),e=this._isMobile()?d.days.namesShort:d.days.names,f=c(e,d.firstDay),g=a.map(f,function(a){return{text:a}}),h=this.groupedResources;if(h.length)if(this._isVerticallyGrouped()){for(var i=[],j=0;6>j;j++)i.push({text:"<div>&nbsp;</div>",className:"k-hidden k-slot-cell"});b=this._createRowsLayout(h,i)}else g=this._createColumnsLayout(h,g);return{columns:g,rows:b}},_eventTmpl:function(a){var b=this.options,c=j({},f.Template,b.templateSettings),d=c.paramName,e="",g=typeof a,h={storage:{},count:0};"function"===g?(h.storage["tmpl"+h.count]=a,e+="#=this.tmpl"+h.count+"("+d+")#",h.count++):"string"===g&&(e+=a);var i=f.template(f.format(q,e),c);return h.count>0&&(i=k(i,h.storage)),i},_createEventElement:function(b){var c=this.options,d=c.editable,e=this._isMobile();return b.showDelete=d&&d.destroy!==!1&&!e,b.resizable=d&&d.resize!==!1&&!e,b.ns=f.ns,b.resources=this.eventResources(b),b.inverseColor=b.resources&&b.resources[0]?this._shouldInverseResourceColor(b.resources[0]):!1,a(this.eventTemplate(b))},_isInDateSlot:function(a){var b=this.groups[0],c=b.firstSlot().start,d=b.lastSlot().end-1,g=f.date.toUtcTime(a.start),h=f.date.toUtcTime(a.end);return(e(g,c,d)||e(h,c,d)||e(c,g,h)||e(d,g,h))&&(!e(h,c,c)||e(h,g,g)||a.isAllDay)},_slotIndex:function(a){return this._slotIndices[l(a).getTime()]},_positionMobileEvent:function(b,c,d){var e=b.start;b.start.offsetLeft>b.end.offsetLeft&&(e=b.end);var g=b.start.index,i=g,j=3,k=h.collidingEvents(b.events(),g,i);k.push({element:c,start:g,end:i});var l=h.createRows(k),m=b.collection.at(g),n=m.container;n||(n=a(f.format('<div class="k-events-container" style="top:{0};left:{1};width:{2}"/>',e.offsetTop+e.firstChildTop+e.firstChildHeight-3+"px",e.offsetLeft+"px",e.offsetWidth+"px")),m.container=n,this.content[0].appendChild(n[0])),l.length<=j&&(b.addEvent({element:c,start:g,end:i,groupIndex:e.groupIndex}),d._continuousEvents.push({element:c,uid:c.attr(f.attr("uid")),start:b.start,end:b.end}),n[0].appendChild(c[0]))},_positionEvent:function(b,c,d){var e=this.options.eventHeight,g=b.start;b.start.offsetLeft>b.end.offsetLeft&&(g=b.end);var i=b.start.index,j=b.end.index,k=g.eventCount,l=h.collidingEvents(b.events(),i,j),m=i!==j?5:4;l.push({element:c,start:i,end:j});for(var n=h.createRows(l),o=0,p=Math.min(n.length,k);p>o;o++)for(var q=n[o].events,r=g.offsetTop+g.firstChildHeight+o*e+3*o+"px",t=0,u=q.length;u>t;t++)q[t].element[0].style.top=r;if(n.length>k)for(var v=i;j>=v;v++){var w=b.collection,x=w.at(v);if(x.more)return;x.more=a(s({ns:f.ns,start:v,end:v,width:x.clientWidth-2,left:x.offsetLeft+2,top:x.offsetTop+x.firstChildHeight+k*e+3*k})),this.content[0].appendChild(x.more[0])}else b.addEvent({element:c,start:i,end:j,groupIndex:g.groupIndex}),c[0].style.width=b.innerWidth()-m+"px",c[0].style.left=g.offsetLeft+2+"px",c[0].style.height=e+"px",d._continuousEvents.push({element:c,uid:c.attr(f.attr("uid")),start:b.start,end:b.end}),this.content[0].appendChild(c[0])},_slotByPosition:function(a,b){var c=this.content.offset();a-=c.left,b-=c.top,b+=this.content[0].scrollTop,a+=this.content[0].scrollLeft,a=Math.ceil(a),b=Math.ceil(b);for(var d=0;d<this.groups.length;d++){var e=this.groups[d].daySlotByPosition(a,b);if(e)return e}return null},_createResizeHint:function(a){var b=a.startSlot().offsetLeft,c=a.start.offsetTop,d=a.innerWidth(),e=a.start.clientHeight-2,f=h.fn._createResizeHint.call(this,b,c,d,e);f.appendTo(this.content),this._resizeHint=this._resizeHint.add(f)},_updateResizeHint:function(a,b,c,d){this._removeResizeHint();for(var e=this.groups[b],g=e.ranges(c,d,!0,a.isAllDay),h=0;h<g.length;h++)this._createResizeHint(g[h]);this._resizeHint.find(".k-label-top,.k-label-bottom").text(""),this._resizeHint.first().addClass("k-first").find(".k-label-top").text(f.toString(f.timezone.toLocalDate(c),"M/dd")),this._resizeHint.last().addClass("k-last").find(".k-label-bottom").text(f.toString(f.timezone.toLocalDate(d),"M/dd"))},_updateMoveHint:function(a,b,c){var d=f.date.toUtcTime(a.start)+c,e=d+a.duration(),g=this.groups[b],h=g.ranges(d,e,!0,a.isAllDay);this._removeMoveHint();for(var i=0;i<h.length;i++){var j=h[i],k=j.startSlot(),l=j.endSlot(),m=this._createEventElement(a.clone({head:j.head,tail:j.tail}));m.css({left:k.offsetLeft+2,top:k.offsetTop+k.firstChildHeight,height:this.options.eventHeight,width:j.innerWidth()-(k.index!==l.index?5:4)}),m.addClass("k-event-drag-hint"),m.appendTo(this.content),this._moveHint=this._moveHint.add(m)}},_groups:function(){var a=this._groupCount(),b=o,c=n;this.groups=[];for(var d=0;a>d;d++)this._addResourceView(d);for(var e=this.content[0].getElementsByTagName("tr"),g=0;a>g;g++){var h=0,i=0;this._isVerticallyGrouped()&&(i=g);for(var j=i*c;(i+1)*c>j;j++){var k=this.groups[g],l=k.addDaySlotCollection(f.date.addDays(this.startDate(),h),f.date.addDays(this.startDate(),h+b)),m=e[j],p=m.children,q=0;m.setAttribute("role","row"),this._isVerticallyGrouped()||(q=g);for(var r=q*b;(q+1)*b>r;r++){var s=p[r],t=s.clientHeight,u=s.children.length?s.children[0].offsetHeight+3:0,v=f.date.toUtcTime(f.date.addDays(this.startDate(),h));h++;var w=Math.floor((t-u-this.options.moreButtonHeight)/(this.options.eventHeight+3));s.setAttribute("role","gridcell"),s.setAttribute("aria-selected",!1),l.addDaySlot(s,v,v+f.date.MS_PER_DAY,w)}}}},render:function(a){this.content.children(".k-event,.k-more-events,.k-events-container").remove(),this._groups(),a=new f.data.Query(a).sort([{field:"start",dir:"asc"},{field:"end",dir:"desc"}]).toArray();var b=this.groupedResources;b.length?this._renderGroups(a,b,0,1):this._renderEvents(a,0),this.refreshLayout(),this.trigger("activate")},_renderEvents:function(a,b){var c,d,e,f=this._isMobilePhoneView();for(d=0,e=a.length;e>d;d++)if(c=a[d],this._isInDateSlot(c)){var g=this.groups[b];g._continuousEvents||(g._continuousEvents=[]);for(var h=g.slotRanges(c,!0),i=h.length,j=0;i>j;j++){var k=h[j],l=c.start,m=c.end;i>1&&(0===j?m=k.end.endDate():j==i-1?l=k.start.startDate():(l=k.start.startDate(),m=k.end.endDate()));var n=c.clone({start:l,end:m,head:k.head,tail:k.tail});f?this._positionMobileEvent(k,this._createEventElement(n),g):this._positionEvent(k,this._createEventElement(n),g)}}},_renderGroups:function(a,b,c,d){var e=b[0];if(e)for(var g=e.dataSource.view(),i=0;i<g.length;i++){var j=this._resourceValue(e,g[i]),k=new f.data.Query(a).filter({field:e.field,operator:h.groupEqFilter(j)}).toArray();b.length>1?c=this._renderGroups(k,b.slice(1),c++,d+1):this._renderEvents(k,c++)}return c},_groupCount:function(){var a=this.groupedResources;return a.length?this._isVerticallyGrouped()?this._rowCountForLevel(a.length-1):this._columnCountForLevel(a.length)/this._columnOffsetForResource(a.length):1},_columnOffsetForResource:function(a){return this._columnCountForLevel(a)/this._columnCountForLevel(a-1)},destroy:function(){this.table&&this.table.removeClass("k-scheduler-monthview"),this.content&&this.content.off(i),this.element&&this.element.off(i),h.fn.destroy.call(this),this._isMobile()&&!this._isMobilePhoneView()&&this.options.editable&&(this.options.editable.create!==!1&&this._addUserEvents.destroy(),this.options.editable.update!==!1&&this._editUserEvents.destroy())},events:["remove","add","edit","navigate"],options:{title:"Month",name:"month",eventHeight:25,moreButtonHeight:13,editable:!0,selectedDateFormat:"{0:y}",dayTemplate:p,eventTemplate:r}})}(window.joy.jQuery),function(a,b){function c(a,b){return b=b||"",a.startTimezone&&(b=a.startTimezone,a.endTimezone&&(b+=" | "+a.endTimezone)),b}function d(a,b){var c=b.timezone;c&&(a[s.attr("timezone")]=c)}function e(a,b){var c=b.model.fields[b.field].validation;if(c){var d=c.dateCompare;d&&H(d)&&d.message&&(a[s.attr("dateCompare-msg")]=d.message)}}function f(a,b){return function(c){return c=a(c),h(c,"apply",b),c||[]}}function g(a,b){return function(c){return c&&("[object Array]"===K.call(c)||c instanceof s.data.ObservableArray||(c=[c])),h(c,"remove",b,!0),c=a(c),c||[]}}function h(a,b,c,d){var e,f,g;for(a=a||[],f=0,g=a.length;g>f;f++)e=a[f],d?e.startTimezone||e.endTimezone?c?(e.start=s.timezone.convert(e.start,e.startTimezone||e.endTimezone,c),e.end=s.timezone.convert(e.end,e.endTimezone||e.startTimezone,c),e.start=s.timezone[b](e.start,c),e.end=s.timezone[b](e.end,c)):(e.start=s.timezone[b](e.start,e.startTimezone||e.endTimezone),e.end=s.timezone[b](e.end,e.endTimezone||e.startTimezone)):c&&(e.start=s.timezone[b](e.start,c),e.end=s.timezone[b](e.end,c)):e.startTimezone||e.endTimezone?(e.start=s.timezone[b](e.start,e.startTimezone||e.endTimezone),e.end=s.timezone[b](e.end,e.endTimezone||e.startTimezone),c&&(e.start=s.timezone.convert(e.start,e.startTimezone||e.endTimezone,c),e.end=s.timezone.convert(e.end,e.endTimezone||e.startTimezone,c))):c&&(e.start=s.timezone[b](e.start,c),e.end=s.timezone[b](e.end,c)),d&&delete e.uid;return a}function i(a,b){for(var c,d=a.length,e=0;d>e;e++)if(c=a[e],c.uid===b)return c}function j(a){var b=new Date(1980,0,1);return b.setHours(a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()),b}function k(a){if(a.filter("[name=end]").length){var b=a.closest(".k-scheduler-edit-form"),c=b.find("[name=start]:visible"),d=b.find("[name=end]:visible");if(d[0]&&c[0]){var e,f,g=s.widgetInstance(c,s.ui),h=s.widgetInstance(d,s.ui),i=b.data("joyEditable"),j=i?i.options.model:null;if(g&&h?(e=g.value(),f=h.value()):(e=s.parseDate(c.val()),f=s.parseDate(d.val())),e&&f){if(j){var k=c.attr(s.attr("timezone")),l=j.startTimezone,m=j.endTimezone;l=l||m,m=m||l,l&&(k?(e=s.timezone.convert(j.start,l,k),f=s.timezone.convert(j.end,m,k)):(e=s.timezone.remove(j.start,l),f=s.timezone.remove(j.end,m)))}return f>=e}}}return!0}function l(a,b,c,d){for(var e=a.length,f=[],g=0;e>g;g++)f=f.concat(a[g].expand(b,c,d));return f}function m(a){return delete a.name,delete a.prefix,delete a.remove,delete a.edit,delete a.add,delete a.navigate,a}function n(b){return function(c){a(s.format('<select data{0}Bind="value:{1}">',s.ns,b.field)).appendTo(c).joyDropDownList({dataTextField:b.dataTextField,dataValueField:b.dataValueField,dataSource:b.dataSource,valuePrimitive:b.valuePrimitive,optionLabel:"None",template:s.format('<span class="k-scheduler-mark" style="background-color:#= data.{0}?{0}:"none" #"></span>#={1}#',b.dataColorField,b.dataTextField)})}}function o(b){return function(c){for(var d="",e=b.dataSource.view(),f=0,g=e.length;g>f;f++)d+=s.format('<option value="{0}">{1}</option>',s.getter(b.dataValueField)(e[f]),s.getter(b.dataTextField)(e[f]));a(s.format('<select data{0}Bind="value:{1}">{2}</select>',s.ns,b.field,d)).appendTo(c)}}function p(b){return function(c){a(s.format('<select data{0}Bind="value:{1}">',s.ns,b.field)).appendTo(c).joyMultiSelect({dataTextField:b.dataTextField,dataValueField:b.dataValueField,dataSource:b.dataSource,valuePrimitive:b.valuePrimitive,itemTemplate:s.format('<span class="k-scheduler-mark" style="background-color:#= data.{0}?{0}:"none" #"></span>#={1}#',b.dataColorField,b.dataTextField),tagTemplate:s.format('<span class="k-scheduler-mark" style="background-color:#= data.{0}?{0}:"none" #"></span>#={1}#',b.dataColorField,b.dataTextField)})}}function q(b){return function(c){for(var d="",e=b.dataSource.view(),f=0,g=e.length;g>f;f++)d+=s.format('<option value="{0}">{1}</option>',s.getter(b.dataValueField)(e[f]),s.getter(b.dataTextField)(e[f]));a(s.format('<select data{0}Bind="value:{1}" multiple="multiple" data-{0}value-primitive="{3}">{2}</select>',s.ns,b.field,d,b.valuePrimitive)).appendTo(c)}}function r(a,b){var c=a.end.getTime()-a.start.getTime(),d=new Date(a.start.getTime());s.date.setTime(d,b);var e=new Date(d.getTime());return s.date.setTime(e,c),{start:d,end:e}}var s=window.joy,t=s.getPluginLang(),u=s.date,v=s.support.input,w=u.MS_PER_DAY,x=u.getDate,y=s.date.getMilliseconds,z=s.recurrence,A=s.keys,B=s.ui,C=B.Widget,D="string",E=B.Popup,F=B.Calendar,G=s.data.DataSource,H=a.isPlainObject,I=a.extend,J=a.proxy,K=Object.prototype.toString,L=a.isArray,M=".joyScheduler",N="click",O="change",P="cancel",Q="remove",R="save",S="add",T="edit",U=x(new Date),V="recurrenceException",W="Are you sure you want to delete this event?",X="Do you want to delete only this event occurrence or the whole series?",Y="Do you want to edit only this event occurrence or the whole series?",Z='<a class="k-button #=className#" #=attr# href="\\#">#=text#</a>',$=s.template('<div class="k-floatwrap k-header k-scheduler-toolbar"><ul class="k-reset k-header k-toolbar k-scheduler-navigation"><li class="k-state-default k-nav-today"><a role="button" href="\\#" class="k-link">${messages.today}</a></li><li class="k-state-default k-nav-prev"><a role="button" href="\\#" class="k-link"><span class="k-icon k-i-arrow-w"></span></a></li><li class="k-state-default k-nav-next"><a role="button" href="\\#" class="k-link"><span class="k-icon k-i-arrow-e"></span></a></li><li class="k-state-default k-nav-current"><a role="button" href="\\#" class="k-link"><span class="k-icon k-i-calendar"></span><span dataBind="text: formattedDate"></span></a></li></ul><ul class="k-reset k-header k-toolbar k-scheduler-views">#for(var view in views){#<li class="k-state-default k-view-#=view#" data-#=ns#name="#=view#"><a role="button" href="\\#" class="k-link">${views[view].title}</a></li>#}#</ul></div>'),_=s.template('<div class="k-floatwrap k-header k-scheduler-toolbar"><ul class="k-reset k-header k-toolbar k-scheduler-navigation"><li class="k-state-default k-nav-today"><a role="button" href="\\#" class="k-link">${messages.today}</a></li></ul><ul class="k-reset k-header k-toolbar k-scheduler-views">#for(var view in views){#<li class="k-state-default k-view-#=view#" data-#=ns#name="#=view#"><a role="button" href="\\#" class="k-link">${views[view].title}</a></li>#}#</ul></div><div class="k-floatwrap k-header k-scheduler-toolbar"><ul class="k-reset k-header k-toolbar k-scheduler-navigation"><li class="k-state-default k-nav-prev"><a role="button" href="\\#" class="k-link"><span class="k-icon k-i-arrow-w"></span></a></li><li class="k-state-default k-nav-current"><span dataBind="text: formattedDate"></span></li><li class="k-state-default k-nav-next"><a role="button" href="\\#" class="k-link"><span class="k-icon k-i-arrow-e"></span></a></li></ul></div>'),aa=function(b,c){var f={name:c.field},g=v.date?"":s.attr("role")+'="datepicker" ',h=v.datetimelocal?"":s.attr("role")+'="datetimepicker" ';d(f,c),e(f,c),a('<input type="datetime-local" required '+s.attr("type")+'="date" '+h+s.attr("bind")+'="value:'+c.field+',invisible:isAllDay" />').attr(f).appendTo(b),a('<input type="date" required '+s.attr("type")+'="date" '+g+s.attr("bind")+'="value:'+c.field+',visible:isAllDay" />').attr(f).appendTo(b),a("<span "+s.attr("for")+'="'+c.field+'" class="k-invalid-msg"/>').hide().appendTo(b)},ba=function(b,c){var f={name:c.field};d(f,c),e(f,c),a('<input type="text" required '+s.attr("type")+'="date" '+s.attr("role")+'="datetimepicker" '+s.attr("bind")+'="value:'+c.field+',invisible:isAllDay" />').attr(f).appendTo(b),a('<input type="text" required '+s.attr("type")+'="date" '+s.attr("role")+'="datepicker" '+s.attr("bind")+'="value:'+c.field+',visible:isAllDay" />').attr(f).appendTo(b),a("<span "+s.attr("bind")+'="text: '+c.field+'Timezone"></span>').appendTo(b),"end"===c.field&&a("<span "+s.attr("bind")+'="text: startTimezone, invisible: endTimezone"></span>').appendTo(b),a("<span "+s.attr("for")+'="'+c.field+'" class="k-invalid-msg"/>').hide().appendTo(b)},ca=function(b,c){a("<div "+s.attr("bind")+'="value:'+c.field+'" />').attr({name:c.field}).appendTo(b).joyRecurrenceEditor({start:c.model.start,timezone:c.timezone,messages:c.messages})},da=function(b,c){a("<div "+s.attr("bind")+'="value:'+c.field+'" />').attr({name:c.field}).appendTo(b).joyMobileRecurrenceEditor({start:c.model.start,timezone:c.timezone,messages:c.messages,pane:c.pane,value:c.model[c.field]})},ea=function(b,d){var e=c(d.model,d.messages.noTimezone);a('<a href="#" class="k-button k-timezone-button">'+e+"</a>").click(d.click).appendTo(b)},fa=function(b,c){a('<a href="#" class="k-button">'+c.messages.timezoneEditorButton+"</a>").click(c.click).appendTo(b)},ga=function(b,c){a("<div "+s.attr("bind")+'="value:'+c.field+'" />').attr({name:c.field}).toggle(c.visible).appendTo(b).joyMobileTimezoneEditor()},ha=function(b,c){a("<div "+s.attr("bind")+'="value:'+c.field+'" />').attr({name:c.field}).toggle(c.visible).appendTo(b).joyTimezoneEditor()},ia=s.Class.extend({init:function(b,c){var d=b.timezone;this.reader=c,c.model&&(this.model=c.model),this.timezone=d,this.data=f(a.proxy(this.data,this),d),this.serialize=g(a.proxy(this.serialize,this),d)},errors:function(a){return this.reader.errors(a)},parse:function(a){return this.reader.parse(a)},data:function(a){return this.reader.data(a)},total:function(a){return this.reader.total(a)},groups:function(a){return this.reader.groups(a)},aggregates:function(a){return this.reader.aggregates(a)},serialize:function(a){return this.reader.serialize(a)}}),ja=s.data.Model.define({init:function(a){var b=this;s.data.Model.fn.init.call(b,a),b._defaultId=b.defaults[b.idField]},clone:function(b,c){var d=this.uid,e=new this.constructor(a.extend({},this.toJSON(),b));return c||(e.uid=d),e},duration:function(){var a=this.end,b=this.start,c=(a.getTimezoneOffset()-b.getTimezoneOffset())*s.date.MS_PER_MINUTE;return a-b-c},expand:function(a,b,c){return z?z.expand(this,a,b,c):[this]},update:function(a){for(var b in a)this.set(b,a[b]);this.startTime&&this.set("startTime",j(this.start)),this.endTime&&this.set("endTime",j(this.end))},isMultiDay:function(){return this.isAllDay||this.duration()>=s.date.MS_PER_DAY},isException:function(){return!this.isNew()&&this.recurrenceId},isOccurrence:function(){return this.isNew()&&this.recurrenceId},isRecurring:function(){return!(!this.recurrenceRule&&!this.recurrenceId)},isRecurrenceHead:function(){return!(!this.id||!this.recurrenceRule)},toOccurrence:function(b){return b=a.extend(b,{recurrenceException:null,recurrenceRule:null,recurrenceId:this.id||this.recurrenceId}),b[this.idField]=this.defaults[this.idField],this.clone(b,!0)},toJSON:function(){var a=s.data.Model.fn.toJSON.call(this);return a.uid=this.uid,delete a.startTime,delete a.endTime,a},shouldSerialize:function(a){return s.data.Model.fn.shouldSerialize.call(this,a)&&"_defaultId"!==a},set:function(a,b){var c=this.isAllDay||!1;if(s.data.Model.fn.set.call(this,a,b),"isAllDay"==a&&b!=c){var d=s.date.getDate(this.start),e=new Date(this.end),f=s.date.getMilliseconds(e);0===f&&b&&(f=w),this.set("start",d),b===!0?(s.date.setTime(e,-f),d>e&&(e=d)):s.date.setTime(e,w-f),this.set("end",e)}},id:"id",fields:{id:{type:"number"},title:{defaultValue:"",type:"string"},start:{type:"date",validation:{required:!0}},startTimezone:{type:"string"},end:{type:"date",validation:{required:!0,dateCompare:{value:k,message:"End date should be greater than or equal to the start date"}}},endTimezone:{type:"string"},recurrenceRule:{defaultValue:"",type:"string"},recurrenceException:{defaultValue:"",type:"string"},isAllDay:{type:"boolean",defaultValue:!1},description:{type:"string"}}}),ka=G.extend({init:function(a){G.fn.init.call(this,I(!0,{},{schema:{modelBase:ja,model:ja}},a)),this.reader=new ia(this.options.schema,this.reader)},expand:function(a,b){var c=this.view(),d={};return a&&b&&(b=new Date(b.getTime()+w-1),d={logic:"or",filters:[{logic:"and",filters:[{field:"start",operator:"gte",value:a},{field:"end",operator:"gte",value:a},{field:"start",operator:"lte",value:b}]},{logic:"and",filters:[{field:"start",operator:"lte",value:new Date(a.getTime()+w-1)},{field:"end",operator:"gte",value:a}]}]},c=new s.data.Query(l(c,a,b,this.reader.timezone)).filter(d).toArray()),c},cancelChanges:function(a){a&&a.isOccurrence()&&this._removeExceptionDate(a),G.fn.cancelChanges.call(this,a)},insert:function(a,b){if(b){if(!(b instanceof ja)){var c=b;b=this._createNewModel(),b.accept(c)}return(b.isRecurrenceHead()||b.recurrenceId)&&(b=b.recurrenceId?b:b.toOccurrence(),this._addExceptionDate(b)),G.fn.insert.call(this,a,b)}},remove:function(a){return a.isRecurrenceHead()?this._removeExceptions(a):a.isRecurring()&&this._addExceptionDate(a),G.fn.remove.call(this,a)},_removeExceptions:function(a){for(var b=this.data().slice(0),c=b.shift(),d=a.id;c;)c.recurrenceId===d&&G.fn.remove.call(this,c),c=b.shift();a.set(V,"")},_removeExceptionDate:function(a){if(a.recurrenceId){var b=this.get(a.recurrenceId);if(b){var c=a.start;b.set(V,b.recurrenceException.replace(z.toExceptionString(c,this.reader.timezone),""))}}},_addExceptionDate:function(a){var b=a.start,c=this.reader.timezone,d=this.get(a.recurrenceId),e=d.recurrenceException||"";z.isException(e,b,c)||d.set(V,e+z.toExceptionString(b,c))}});ka.create=function(a){a=a&&a.push?{data:a}:a;var b=a||{},c=b.data;if(b.data=c,!(b instanceof ka)&&b instanceof s.data.DataSource)throw new Error("Incorrect DataSource type. Only SchedulerDataSource instances are supported");return b instanceof ka?b:new ka(b)},I(!0,s.data,{SchedulerDataSource:ka,SchedulerDataReader:ia,SchedulerEvent:ja});var la={update:{text:"Save",className:"k-scheduler-update"},canceledit:{text:"Cancel",className:"k-scheduler-cancel"},destroy:{text:"Delete",imageClass:"k-delete",className:"k-scheduler-delete",iconClass:"k-icon"}},ma={mobile:{dateRange:aa,timezonePopUp:ea,timezone:ga,recurrence:da,description:'<textarea name="description" class="k-textbox"/>',multipleResources:q,resources:o},desktop:{dateRange:ba,timezonePopUp:fa,timezone:ha,recurrence:ca,description:'<textarea name="description" class="k-textbox"/>',multipleResources:p,resources:n}},na=s.Observable.extend({init:function(a,b){s.Observable.fn.init.call(this),this.element=a,this.options=I(!0,{},this.options,b),this.createButton=this.options.createButton},fields:function(a,b){var c=this,d=c.options.messages,e=c.options.timezone,f=function(a){a.preventDefault(),c._initTimezoneEditor(b,this)},g=[{field:"title",title:d.editor.title},{field:"start",title:d.editor.start,editor:a.dateRange,timezone:e},{field:"end",title:d.editor.end,editor:a.dateRange,timezone:e},{field:"isAllDay",title:d.editor.allDayEvent}];s.timezone.windows_zones&&!b.isAllDay&&(g.push({field:"timezone",title:d.editor.timezone,editor:a.timezonePopUp,click:f,messages:d.editor,model:b}),g.push({field:"startTimezone",title:d.editor.startTimezone,editor:a.timezone}),g.push({field:"endTimezone",title:d.editor.endTimezone,editor:a.timezone})),b.recurrenceId||g.push({field:"recurrenceRule",title:d.editor.repeat,editor:a.recurrence,timezone:e,messages:d.recurrenceEditor,pane:this.pane}),"description"in b&&g.push({field:"description",title:d.editor.description,editor:a.description});for(var h=0;h<this.options.resources.length;h++){var i=this.options.resources[h];g.push({field:i.field,title:i.title,editor:i.multiple?a.multipleResources(i):a.resources(i)})}return g},end:function(){return this.editable.end()},_buildEditTemplate:function(a,b,c){var d=this.options.messages,e=I({},s.Template,this.options.templateSettings),f=e.paramName,g=this.options.editable.template,h="";if(g)typeof g===D&&(g=window.unescape(g)),h+=s.template(g,e)(a);else for(var i=0,j=b.length;j>i;i++){var k=b[i];if("startTimezone"===k.field&&(h+='<div class="k-popup-edit-form k-scheduler-edit-form k-scheduler-timezones" style="display:none">',h+='<div class="k-edit-form-container">',h+='<div class="k-edit-label"></div>',h+='<div class="k-edit-field"><label class="k-check"><input class="k-timezone-toggle" type="checkbox" />'+d.editor.separateTimezones+"</label></div>"),h+='<div class="k-edit-label"><label for="'+k.field+'">'+(k.title||k.field||"")+"</label></div>",!a.editable||a.editable(k.field))c.push(k),h+="<div "+s.attr("container-for")+'="'+k.field+'" class="k-edit-field"></div>';else{var l="#:";k.field?(k=s.expr(k.field,f),l+=k+"==null?'':"+k):l+="''",l+="#",l=s.template(l,e),h+='<div class="k-edit-field">'+l(a)+"</div>"}"endTimezone"===k.field&&(h+=this._createEndTimezoneButton())}return h},_createEndTimezoneButton:function(){return"</div></div>"},_revertTimezones:function(a){a.set("startTimezone",this._startTimezone),a.set("endTimezone",this._endTimezone),delete this._startTimezone,delete this._endTimezone}}),oa=na.extend({init:function(){na.fn.init.apply(this,arguments),this.pane=s.mobile.ui.Pane.wrap(this.element),this.pane.element.parent().css("height",this.options.height),this.view=this.pane.view(),this._actionSheetButtonTemplate=s.template('<li><a #=attr# class="k-button #=className#" href="\\#">#:text#</a></li>'),this._actionSheetPopupOptions=a(document.documentElement).hasClass("km-root")?{modal:!1}:{align:"bottom center",position:"bottom center",effect:"slideIn:up"}},options:{animations:{left:"slide",right:"slide:right"}},destroy:function(){this.close(),this.unbind(),this.pane.destroy()},_initTimezoneEditor:function(b){var d=this,e=d.pane,f=d.options.messages,g=d.timezoneView,h=d.container.find(".k-scheduler-timezones"),i=h.find(".k-timezone-toggle"),j=h.find(".k-edit-label:last").add(h.find(".k-edit-field:last")),k=function(a){if("startTimezone"===a.field){var c=b.startTimezone;i.prop("disabled",!c),c||(j.hide(),b.set("endTimezone",""),i.prop("checked",!1))}};if(d._startTimezone=b.startTimezone||"",d._endTimezone=b.endTimezone||"",!g){var l='<div data-role="view" class="k-popup-edit-form k-scheduler-edit-form k-mobile-list"><div data-role="header" class="k-header"><a href="#" class="k-button k-scheduler-cancel">'+f.cancel+"</a>"+f.editor.timezoneTitle+'<a href="#" class="k-button k-scheduler-update">'+f.save+"</a></div></div>";this.timezoneView=g=e.append(l),g.contentElement().append(h.show()),g.element.on(N+M,".k-scheduler-cancel, .k-scheduler-update",function(g){g.preventDefault(),g.stopPropagation(),a(this).hasClass("k-scheduler-cancel")&&d._revertTimezones(b),b.unbind("change",k);var h=e.element.find("#edit").data("joyMobileView"),i=c(b,f.editor.noTimezone);h.contentElement().find(".k-timezone-button").text(i),e.navigate(h,d.options.animations.right)}),i.click(function(){j.toggle(i.prop("checked")),b.set("endTimezone","")}),b.bind("change",k)}i.prop("checked",b.endTimezone).prop("disabled",!b.startTimezone),b.endTimezone?j.show():j.hide(),e.navigate(g,d.options.animations.left)},_createActionSheetButton:function(a){return a.template=this._actionSheetButtonTemplate,this.createButton(a)},showDialog:function(b){var c="",d='<ul><li class="km-actionsheet-title">'+b.title+"</li>",e=this.element.find(".k-event["+s.attr("uid")+"='"+b.model.uid+"']");this.container&&(e=this.container.find(".k-scheduler-delete"),e[0]&&(c="phone"));for(var f=0;f<b.buttons.length;f++)d+=this._createActionSheetButton(b.buttons[f]);d+="</ul>";var g=a(d).appendTo(this.pane.view().element).joyMobileActionSheet({type:c,cancel:this.options.messages.cancel,cancelTemplate:'<li class="km-actionsheet-cancel"><a class="k-button" href="\\#">#:cancel#</a></li>',close:function(){this.destroy()},command:function(c){var d=g.element.find("li:not(.km-actionsheet-cancel) > .k-button").index(a(c.currentTarget));d>-1&&(g.close(),b.buttons[d].click())},popup:this._actionSheetPopupOptions}).data("joyMobileActionSheet");g.open(e)},editEvent:function(b){var c=this.pane,d="",e=this.options.messages,f=e.save,g=e.destroy,h=e.cancel,i=e.editor.editorTitle;d+='<div data-role="view" class="k-popup-edit-form k-scheduler-edit-form k-mobile-list" id="edit" '+s.attr("uid")+'="'+b.uid+'"><div data-role="header" class="k-header"><a href="#" class="k-button k-scheduler-cancel">'+h+"</a>"+i+'<a href="#" class="k-button k-scheduler-update">'+f+"</a></div>";var j=this.fields(ma.mobile,b),k=this,l=[];d+=this._buildEditTemplate(b,j,l),!b.isNew()&&this.options.editable&&this.options.editable.destroy!==!1&&(d+='<div class="k-edit-buttons"><a href="#" class="k-scheduler-delete k-button">'+g+"</a></div>"),d+="</div>";var m=c.append(d),n=this.container=m.element;return this.editable=n.joyEditable({fields:l,model:b,clearContainer:!1,validateOnBlur:!0}).data("joyEditable"),n.find("input[type=checkbox],input[type=radio]").parent(".k-edit-field").addClass("k-check").prev(".k-edit-label").addClass("k-check").click(function(){a(this).next().children("input").click()}),this.trigger("edit",{container:n,model:b})?this.trigger("cancel",{container:n,model:b}):(n.on(N+M,"a.k-scheduler-edit, a.k-scheduler-cancel, a.k-scheduler-update, a.k-scheduler-delete",function(d){d.preventDefault(),d.stopPropagation();var e=a(this);if(e.hasClass("k-scheduler-edit"))c.navigate("#edit",k.options.animations.right);else{var f="cancel";e.hasClass("k-scheduler-update")?f="save":e.hasClass("k-scheduler-delete")&&(f="remove"),k.trigger(f,{container:n,model:b})}}),c.navigate(m,k.options.animations.left)),this.editable},_views:function(){return this.pane.element.find(s.roleSelector("view")).not(this.view.element)},close:function(){if(this.container){this.pane.navigate("",this.options.animations.right);for(var a,b=this._views(),c=0,d=b.length;d>c;c++)a=b.eq(c).data("joyMobileView"),a&&a.purge();b.remove(),this.container=null,this.editable&&(this.editable.destroy(),this.editable=null),this.timezoneView=null}}}),pa=na.extend({destroy:function(){this.close(),this.unbind()},editEvent:function(a){return this.editable=this._createPopupEditor(a),this.editable},close:function(){var a=this,b=function(){a.editable&&(a.editable.destroy(),a.editable=null,a.container=null),a.popup&&(a.popup.destroy(),a.popup=null)};a.editable?(a._timezonePopup&&a._timezonePopup.data("joyWindow")&&(a._timezonePopup.data("joyWindow").destroy(),a._timezonePopup=null),a.container.is(":visible")?a.container.data("joyWindow").bind("deactivate",b).close():b()):b()},_createEndTimezoneButton:function(){var a=this.options.messages,b="";return b+='<div class="k-edit-buttons k-state-default">',b+=this.createButton({name:"savetimezone",text:a.save})+this.createButton({name:"canceltimezone",text:a.cancel}),b+="</div></div></div>"},showDialog:function(b){var c=s.format("<div class='k-popup-edit-form'><div class='k-edit-form-container'><p class='k-popup-message'>{0}</p>",b.text);c+='<div class="k-edit-buttons k-state-default">';for(var d=0;d<b.buttons.length;d++)c+=this.createButton(b.buttons[d]);c+="</div></div></div>";var e=this.element;this.popup&&this.popup.destroy();var f=this.popup=a(c).appendTo(e).eq(0).on("click",".k-button",function(c){
c.preventDefault(),f.close();var d=a(c.currentTarget).index();b.buttons[d].click()}).joyWindow({modal:!0,resizable:!1,draggable:!1,title:b.title,visible:!1,close:function(){this.destroy(),e.focus()}}).getJoyWindow();f.center().open()},_createPopupEditor:function(b){var c=this,d=c.options.editable,e="<div "+s.attr("uid")+'="'+b.uid+'" class="k-popup-edit-form k-scheduler-edit-form"><div class="k-edit-form-container">',f=c.options.messages,g=f.save,h=f.cancel,i=f.destroy,j=this.fields(ma.desktop,b),k=[];e+=this._buildEditTemplate(b,j,k);var l,m=H(d)?d.window:{};e+='<div class="k-edit-buttons k-state-default">',e+=this.createButton({name:"update",text:g,attr:l})+this.createButton({name:"canceledit",text:h,attr:l}),b.isNew()||d.destroy===!1||(e+=this.createButton({name:"delete",text:i,attr:l})),e+="</div></div></div>";var n=this.container=a(e).appendTo(c.element).eq(0).joyWindow(I({modal:!0,resizable:!1,draggable:!0,title:f.editor.editorTitle,visible:!1,close:function(a){a.userTriggered&&c.trigger(P,{container:n,model:b})&&a.preventDefault()}},m)),o=n.joyEditable({fields:k,model:b,clearContainer:!1,validateOnBlur:!0}).data("joyEditable");return c.trigger(T,{container:n,model:b})?c.trigger(P,{container:n,model:b}):(n.data("joyWindow").center().open(),n.on(N+M,"a.k-scheduler-cancel",function(a){a.preventDefault(),a.stopPropagation(),c.trigger(P,{container:n,model:b})}),n.on(N+M,"a.k-scheduler-update",function(a){a.preventDefault(),a.stopPropagation(),c.trigger("save",{container:n,model:b})}),n.on(N+M,"a.k-scheduler-delete",function(a){a.preventDefault(),a.stopPropagation(),c.trigger(Q,{container:n,model:b})})),o},_initTimezoneEditor:function(a,b){var c,d=this,e=d.container.find(".k-scheduler-timezones"),f=e.find(".k-timezone-toggle"),g=e.find(".k-edit-label:last").add(e.find(".k-edit-field:last")),h=e.find(".k-scheduler-savetimezone"),i=e.find(".k-scheduler-canceltimezone"),j=d._timezonePopup,k=function(b){if("startTimezone"===b.field){var c=a.startTimezone;f.prop("disabled",!c),c||(g.hide(),a.set("endTimezone",""),f.prop("checked",!1))}};d._startTimezone=a.startTimezone,d._endTimezone=a.endTimezone,j||(d._timezonePopup=j=e.joyWindow({modal:!0,resizable:!1,draggable:!0,title:d.options.messages.editor.timezoneEditorTitle,visible:!1,close:function(c){a.unbind("change",k),c.userTriggered&&d._revertTimezones(a),b&&b.focus()}}),f.click(function(){g.toggle(f.prop("checked")),a.set("endTimezone","")}),h.click(function(a){a.preventDefault(),c.close()}),i.click(function(b){b.preventDefault(),d._revertTimezones(a),c.close()}),a.bind("change",k)),f.prop("checked",a.endTimezone).prop("disabled",!a.startTimezone),a.endTimezone?g.show():g.hide(),c=j.data("joyWindow"),c.center().open()}}),qa=C.extend({init:function(b,c){var d=this;C.fn.init.call(d,b,c),d.options.views&&d.options.views.length||(d.options.views=["day","week"]),d.resources=[],d._initModel(),d._wrapper(),d._views(),d._toolbar(),d._dataSource(),d._resources(),d._resizeHandler=J(d.resize,d),d.wrapper.on("mousedown"+M+" selectstart"+M,function(a){a.preventDefault()}),d.options.editable&&d.options.editable.resize!==!1&&d._resizable(),d._movable(),a(window).on("resize"+M,d._resizeHandler),d.options.messages&&d.options.messages.recurrence&&(z.options=d.options.messages.recurrence),d._selectable(),d._ariaId=s.guid(),d._createEditor()},_isMobile:function(){var a=this.options;return a.mobile===!0&&s.support.mobileOS||"phone"===a.mobile||"tablet"===a.mobile},_isMobilePhoneView:function(){var a=this.options;return a.mobile===!0&&s.support.mobileOS&&!s.support.mobileOS.tablet||"phone"===a.mobile},_selectable:function(){var b=this,c=b.wrapper,d=s.support.mobileOS?"touchend":"mousedown";if(b.options.selectable){b._tabindex(),c.on(d+M,".k-scheduler-header-all-day td, .k-scheduler-content td, .k-event",function(a){var d=a.which,e=a.button,f=d&&3===d||e&&2==e;f||b._createSelection(a.currentTarget),c.focus()});var e=a.proxy(b._mouseMove,b);c.on("mousedown"+M,".k-scheduler-header-all-day td, .k-scheduler-content td",function(a){var b=a.which,d=a.button,f=b&&3===b||d&&2==d;f||c.on("mousemove"+M,".k-scheduler-header-all-day td, .k-scheduler-content td",e)}),c.on("mouseup"+M+" mouseleave"+M,function(){c.off("mousemove"+M,".k-scheduler-header-all-day td, .k-scheduler-content td",e)}),c.on("focus"+M,function(){b._selection||b._createSelection(a(".k-scheduler-content").find("td:first")),b._select()}),c.on("focusout"+M,function(){b.view().clearSelection(),b._ctrlKey=b._shiftKey=!1}),c.on("keydown"+M,J(b._keydown,b)),c.on("keyup"+M,function(a){b._ctrlKey=a.ctrlKey,b._shiftKey=a.shiftKey})}},_select:function(){var a=this,b=a.view(),c=a.wrapper,d=b.current(),e=a._selection;if(d&&(d.removeAttribute("id"),d.removeAttribute("aria-label"),c.removeAttr("aria-activedescendant")),b.select(e),d=b.current(),d&&a._old!==d){var f,g=e,h=a._selectedEvents(),i=b._selectedSlots;h[0]?(g=h[0]||e,f=s.format(a.options.messages.ariaEventLabel,g.title,g.start,g.start)):f=s.format(a.options.messages.ariaSlotLabel,g.start,g.end),d.setAttribute("id",a._ariaId),d.setAttribute("aria-label",f),c.attr("aria-activedescendant",a._ariaId),a._old=d,a.trigger("change",{start:e.start,end:e.end,events:h,slots:i,resources:b._resourceBySlot(e)})}},_selectedEvents:function(){for(var a,b=this._selection.events,c=b.length,d=0,e=[];c>d;d++)a=this.occurrenceByUid(b[d]),a&&e.push(a);return e},_mouseMove:function(b){var c=this;clearTimeout(c._moveTimer),c._moveTimer=setTimeout(function(){var d=c.view(),e=c._selection;if(e){var f=d.selectionByElement(a(b.currentTarget));if(f&&e.groupIndex===f.groupIndex){var g=f.startDate(),h=f.endDate();g>=e.end?e.backward=!1:h<=e.start&&(e.backward=!0),e.backward?e.start=g:e.end=h,c._select()}}},5)},_viewByIndex:function(a){var b,c=this.views;for(b in c){if(!a)return b;a--}},_keydown:function(b){var c=this,d=b.keyCode,e=c.view(),f=e.options.editable,g=c._selection,h=b.shiftKey;c._ctrlKey=b.ctrlKey,c._shiftKey=b.shiftKey,d===A.TAB?e.moveToEvent(g,h)&&(c._select(),b.preventDefault()):f&&d===A.ENTER?g.events.length?f.update!==!1&&c.editEvent(g.events[0]):f.create!==!1&&(g.isAllDay&&(g=a.extend({},g,{end:s.date.addDays(g.end,-1)})),c.addEvent(I({},g,e._resourceBySlot(g)))):d===A.DELETE&&f!==!1&&f.destroy!==!1?c.removeEvent(g.events[0]):d>=49&&57>=d?c.view(c._viewByIndex(d-49)):e.move(g,d,h)&&(e.inRange(g)?c._select():c.date(g.start),b.preventDefault()),c._adjustSelectedDate()},_createSelection:function(b){var c,d,e;this._selection&&(this._ctrlKey||this._shiftKey)||(this._selection={events:[],groupIndex:0}),b=a(b),e=this._selection,c=b.attr(s.attr("uid")),d=this.view().selectionByElement(b),d&&(e.groupIndex=d.groupIndex||0),c&&(d=i(this._data,c)),d&&d.uid&&(c=[d.uid]),this._updateSelection(d,c),this._adjustSelectedDate()},_updateSelection:function(a,b){var c=this._selection;if(a&&c){if(this._shiftKey&&c.start&&c.end){var d=a.end<c.end,e=this.view();c.end=a.endDate?a.endDate():a.end,d&&e._timeSlotInterval&&s.date.setTime(c.end,-e._timeSlotInterval())}else c.start=a.startDate?a.startDate():a.start,c.end=a.endDate?a.endDate():a.end;c.isAllDay="isDaySlot"in a?a.isDaySlot:a.isAllDay,c.index=a.index,c.events=this._ctrlKey?c.events.concat(b||[]):b||[]}},options:{name:"Scheduler",date:U,editable:!0,autoBind:!0,snap:!0,mobile:!1,timezone:"",min:new Date(1900,0,1),max:new Date(2099,11,31),messages:t.scheduler.messages,height:null,width:null,resources:[],group:{resources:[],direction:"horizontal"},views:[],selectable:!1},events:[Q,T,P,R,"add","dataBinding","dataBound","moveStart","move","moveEnd","resizeStart","resize","resizeEnd","navigate","change"],destroy:function(){var b,c=this;C.fn.destroy.call(c),c.dataSource&&c.dataSource.unbind(O,c._refreshHandler),c.calendar&&(c.calendar.destroy(),c.popup.destroy()),c.view()&&c.view().destroy(),c._editor&&c._editor.destroy(),this._moveDraggable&&this._moveDraggable.destroy(),this._resizeDraggable&&this._resizeDraggable.destroy(),b=c.element.add(c.wrapper).add(c.toolbar).add(c.popup),b.off(M),c._model=null,c.toolbar=null,c.element=null,a(window).off("resize"+M,c._resizeHandler),s.destroy(c.wrapper)},setDataSource:function(a){this.options.dataSource=a,this._dataSource(),this.options.autoBind&&a.fetch()},items:function(){return this.wrapper.children(".k-event, .k-task")},_movable:function(){var b,c,d,e,f,g=this,h=g._isMobile(),i=g.options.editable&&g.options.editable.move!==!1,j=g.options.editable&&g.options.editable.resize!==!1;(i||j&&h)&&(g._moveDraggable=new s.ui.Draggable(g.element,{distance:0,filter:".k-event",holdToDrag:h}),i&&g._moveDraggable.bind("dragstart",function(a){var e=g.view(),i=a.currentTarget;return e.options.editable&&e.options.editable.move!==!1?h&&!i.hasClass("k-event-active")?(g.element.find(".k-event-active").removeClass("k-event-active"),void a.preventDefault()):(f=g.occurrenceByUid(i.attr(s.attr("uid"))),b=e._slotByPosition(a.x.location,a.y.location),d=b.startOffset(a.x.location,a.y.location,g.options.snap),c=b,void((!b||g.trigger("moveStart",{event:f}))&&a.preventDefault())):void a.preventDefault()}).bind("drag",function(a){var b=g.view(),h=b._slotByPosition(a.x.location,a.y.location);if(h){e=h.startOffset(a.x.location,a.y.location,g.options.snap);var i=e-d;b._updateMoveHint(f,h.groupIndex,i);var j=r(f,i);g.trigger("move",{event:f,slot:{element:h.element,start:h.startDate(),end:h.endDate()},resources:b._resourceBySlot(h),start:j.start,end:j.end})?b._updateMoveHint(f,h.groupIndex,i):c=h}}).bind("dragend",function(h){g.view()._removeMoveHint();var i=e-d,j=r(f,i),k=j.start,l=j.end,m=g.view()._resourceBySlot(c),n=g.view()._resourceBySlot(b),o=g.trigger("moveEnd",{event:f,slot:{element:c.element,start:c.startDate(),end:c.endDate()},start:k,end:l,resources:m});o||f.start.getTime()==k.getTime()&&f.end.getTime()==l.getTime()&&s.stringify(m)==s.stringify(n)||g._updateEvent(null,f,a.extend({start:k,end:l},m)),h.currentTarget.removeClass("k-event-active"),this.cancelHold()}).bind("dragcancel",function(){g.view()._removeMoveHint(),this.cancelHold()}),h&&(g._moveDraggable.bind("hold",function(a){g.element.find(".k-scheduler-monthview").length&&a.preventDefault(),g.element.find(".k-event-active").removeClass("k-event-active"),a.currentTarget.addClass("k-event-active")}),g._moveDraggable.userEvents.bind("press",function(a){a.preventDefault()})))},_resizable:function(){function b(a){var b={"k-resize-e":"east","k-resize-w":"west","k-resize-n":"north","k-resize-s":"south"};for(var c in b)if(a.hasClass(c))return b[c]}var c,d,e,f,g=this;g._resizeDraggable=new s.ui.Draggable(g.element,{distance:0,filter:".k-resize-handle",dragstart:function(b){var h=a(b.currentTarget),i=h.closest(".k-event"),j=i.attr(s.attr("uid"));e=g.occurrenceByUid(j),f=g.view()._slotByPosition(b.x.location,b.y.location),g.trigger("resizeStart",{event:e})&&b.preventDefault(),c=s.date.toUtcTime(e.start),d=s.date.toUtcTime(e.end)},drag:function(h){if(f){var i=a(h.currentTarget),j=b(i),k=g.view(),l=k._slotByPosition(h.x.location,h.y.location);if(l&&f.groupIndex==l.groupIndex){f=l;var m=c,n=d;"south"==j?!f.isDaySlot&&f.end-s.date.toUtcTime(e.start)>=k._timeSlotInterval()&&(d=e.isAllDay?f.startOffset(h.x.location,h.y.location,g.options.snap):f.endOffset(h.x.location,h.y.location,g.options.snap)):"north"==j?!f.isDaySlot&&s.date.toUtcTime(e.end)-f.start>=k._timeSlotInterval()&&(c=f.startOffset(h.x.location,h.y.location,g.options.snap)):"east"==j?f.isDaySlot&&s.date.toUtcTime(s.date.getDate(f.endDate()))>=s.date.toUtcTime(s.date.getDate(e.start))&&(d=e.isAllDay?f.startOffset(h.x.location,h.y.location,g.options.snap):f.endOffset(h.x.location,h.y.location,g.options.snap)):"west"==j&&f.isDaySlot&&s.date.toUtcTime(s.date.getDate(e.end))>=s.date.toUtcTime(s.date.getDate(f.startDate()))&&(c=f.startOffset(h.x.location,h.y.location,g.options.snap)),g.trigger("resize",{event:e,slot:{element:f.element,start:f.startDate(),end:f.endDate()},start:s.timezone.toLocalDate(c),end:s.timezone.toLocalDate(d),resources:k._resourceBySlot(f)})?(c=m,d=n):k._updateResizeHint(e,f.groupIndex,c,d)}}},dragend:function(h){var i=a(h.currentTarget),j=new Date(e.start.getTime()),k=new Date(e.end.getTime()),l=b(i);g.view()._removeResizeHint(),"south"==l?k=s.timezone.toLocalDate(d):"north"==l?j=s.timezone.toLocalDate(c):"east"==l?k=s.date.getDate(s.timezone.toLocalDate(d)):"west"==l&&(j=new Date(s.timezone.toLocalDate(c)),j.setHours(0),j.setMinutes(0));var m=g.trigger("resizeEnd",{event:e,slot:{element:f.element,start:f.startDate(),end:f.endDate()},start:j,end:k,resources:g.view()._resourceBySlot(f)});!m&&k.getTime()>=j.getTime()&&(e.start.getTime()!=j.getTime()||e.end.getTime()!=k.getTime())&&g._updateEvent(l,e,{start:j,end:k}),f=null,e=null},dragcancel:function(){g.view()._removeResizeHint(),f=null,e=null}})},_updateEvent:function(a,b,c){var d=this,e=function(a,b){try{d._preventRefresh=!0,a.update(c),d._convertDates(a)}finally{d._preventRefresh=!1}d.trigger(R,{event:a})||(b&&b(),d._updateSelection(a),d.dataSource.sync())},f=function(a){return a.recurrenceRule?d.dataSource.getByUid(a.uid):d.dataSource.get(a.recurrenceId)},g=function(){var g=f(b);if("south"==a||"north"==a){if(c.start){var h=s.date.getDate(g.start);s.date.setTime(h,y(c.start)),c.start=h}if(c.end){var i=s.date.getDate(g.end);s.date.setTime(i,y(c.end)),c.end=i}}d.dataSource._removeExceptions(g),e(g)},h=function(){var a=f(b),c=function(){d._convertDates(a)},g=a.toOccurrence({start:b.start,end:b.end});e(d.dataSource.add(g),c)},i=d.options.messages.recurrenceMessages;b.recurrenceRule||b.isOccurrence()?d.showDialog({model:b,title:i.editWindowTitle,text:i.editRecurring?i.editRecurring:Y,buttons:[{text:i.editWindowOccurrence,click:h},{text:i.editWindowSeries,click:g}]}):e(d.dataSource.getByUid(b.uid))},_modelForContainer:function(b){return b=a(b).closest("["+s.attr("uid")+"]"),this.dataSource.getByUid(b.attr(s.attr("uid")))},showDialog:function(a){this._editor.showDialog(a)},focus:function(){this.wrapper.focus()},_confirmation:function(a,b){var c=this.options.editable;if(c===!0||c.confirmation!==!1){var d=this.options.messages,e=typeof c.confirmation===D?c.confirmation:W,f=[{name:"destroy",text:d.destroy,click:function(){a()}}];this._isMobile()&&s.mobile.ui.Pane||f.push({name:"canceledit",text:d.cancel,click:function(){a(!0)}}),this.showDialog({model:b,text:e,title:d.deleteWindowTitle,buttons:f})}else a()},addEvent:function(a){var b,c=this._editor.editable,d=this.dataSource;a=a||{};var e=this.trigger("add",{event:a});!e&&(c&&c.end()||!c)&&(this.cancelEvent(),a&&a.toJSON&&(a=a.toJSON()),b=d.add(a),b&&(this.cancelEvent(),this._editEvent(b)))},saveEvent:function(){var a=this._editor;if(a){var b=a.editable,c=a.container,d=this._modelForContainer(c);c&&b&&b.end()&&!this.trigger(R,{container:c,event:d})&&(d.isRecurrenceHead()&&this.dataSource._removeExceptions(d),d.dirty||d.isOccurrence()||this._convertDates(d,"remove"),this.dataSource.sync())}},cancelEvent:function(){var a,b=this._editor,c=b.container;c&&(a=this._modelForContainer(c),a.isOccurrence()&&(this._convertDates(a,"remove"),this._convertDates(this.dataSource.get(a.recurrenceId),"remove")),this.dataSource.cancelChanges(a),b.close())},editEvent:function(a){var b="string"==typeof a?this.occurrenceByUid(a):a;b&&(this.cancelEvent(),b.isRecurring()?this._editRecurringDialog(b):this._editEvent(b))},_editEvent:function(a){this._createPopupEditor(a)},_editRecurringDialog:function(a){var b=this,c=function(){a.isException()?b._editEvent(a):b.addEvent(a)},d=function(){a.recurrenceId&&(a=b.dataSource.get(a.recurrenceId)),b._editEvent(a)},e=b.options.messages.recurrenceMessages;b.showDialog({model:a,title:e.editWindowTitle,text:e.editRecurring?e.editRecurring:Y,buttons:[{text:e.editWindowOccurrence,click:c},{text:e.editWindowSeries,click:d}]})},_createButton:function(a){var b=a.template||Z,c=typeof a===D?a:a.name||a.text,d={className:"k-scheduler-"+(c||"").replace(/\s/g,""),text:c,attr:""};if(!(c||H(a)&&a.template))throw new Error("Custom commands should have name specified");return H(a)?(a.className&&(a.className+=" "+d.className),"edit"===c&&H(a.text)&&(a=I(!0,{},a),a.text=a.text.edit),d=I(!0,d,la[c],a)):d=I(!0,d,la[c]),s.template(b)(d)},_convertDates:function(a,b){var c=this.dataSource.reader.timezone,d=a.startTimezone,e=a.endTimezone,f=a.start,g=a.start;b=b||"apply",d=d||e,e=e||d,d&&(c?"apply"===b?(f=s.timezone.convert(a.start,c,d),g=s.timezone.convert(a.end,c,e)):(f=s.timezone.convert(a.start,d,c),g=s.timezone.convert(a.end,e,c)):(f=s.timezone[b](a.start,d),g=s.timezone[b](a.end,e)),a._set("start",f),a._set("end",g))},_createEditor:function(){var a,b=this;a=b._editor=this._isMobile()&&s.mobile.ui.Pane?new oa(this.wrapper,I({},this.options,{timezone:b.dataSource.reader.timezone,resources:b.resources,createButton:J(this._createButton,this)})):new pa(this.wrapper,I({},this.options,{createButton:J(this._createButton,this),timezone:b.dataSource.reader.timezone,resources:b.resources})),a.bind("cancel",function(a){return b.trigger("cancel",{container:a.container,event:a.model})?void a.preventDefault():(b.cancelEvent(),void b.focus())}),a.bind("edit",function(a){b.trigger(T,{container:a.container,event:a.model})&&a.preventDefault()}),a.bind("save",function(){b.saveEvent()}),a.bind("remove",function(a){b.removeEvent(a.model)})},_createPopupEditor:function(a){var b=this._editor;(!a.isNew()||a.isOccurrence())&&(a.isOccurrence()&&this._convertDates(a.recurrenceId?this.dataSource.get(a.recurrenceId):a),this._convertDates(a)),this.editable=b.editEvent(a)},removeEvent:function(a){var b=this,c="string"==typeof a?b.occurrenceByUid(a):a;c&&(c.isRecurring()?b._deleteRecurringDialog(c):b._confirmation(function(a){a||b._removeEvent(c)},c))},occurrenceByUid:function(a){var b=this.dataSource.getByUid(a);return b||(b=i(this._data,a)),b},occurrencesInRange:function(a,b){return new s.data.Query(this._data).filter({logic:"or",filters:[{logic:"and",filters:[{field:"start",operator:"gte",value:a},{field:"end",operator:"gte",value:a},{field:"start",operator:"lt",value:b}]},{logic:"and",filters:[{field:"start",operator:"lte",value:a},{field:"end",operator:"gt",value:a}]}]}).toArray()},_removeEvent:function(a){this.trigger(Q,{event:a})||this.dataSource.remove(a)&&this.dataSource.sync()},_deleteRecurringDialog:function(a){var b=this,c=a,d=function(){var a=c.recurrenceId?c:c.toOccurrence(),d=b.dataSource.get(a.recurrenceId);b._convertDates(d),b._removeEvent(a)},e=function(){c.recurrenceId&&(c=b.dataSource.get(c.recurrenceId)),b._removeEvent(c)},f=b.options.messages.recurrenceMessages;b.showDialog({model:a,title:f.deleteWindowTitle,text:f.deleteRecurring?f.deleteRecurring:X,buttons:[{text:f.deleteWindowOccurrence,click:d},{text:f.deleteWindowSeries,click:e}]})},_unbindView:function(a){a.destroy()},_bindView:function(a){var b=this;b.options.editable&&(b._viewRemoveHandler&&a.unbind(Q,b._viewRemoveHandler),b._viewRemoveHandler=function(a){b.removeEvent(a.uid)},a.bind(Q,b._viewRemoveHandler),b._viewAddHandler&&a.unbind(S,b._viewAddHandler),b._viewAddHandler=function(a){b.addEvent(a.eventInfo)},a.bind(S,this._viewAddHandler),b._viewEditHandler&&a.unbind(T,b._viewEditHandler),b._viewEditHandler=function(a){b.editEvent(a.uid)},a.bind(T,this._viewEditHandler)),b._viewNavigateHandler&&a.unbind("navigate",b._viewNavigateHandler),b._viewNavigateHandler=function(a){if(a.view){var c="isWorkDay"in a,d=c?"changeWorkDay":"changeView";b.trigger("navigate",{view:a.view,isWorkDay:a.isWorkDay,action:d,date:a.date})||(c&&(b._workDayMode=a.isWorkDay),b._selectView(a.view),b.date(a.date))}},a.bind("navigate",b._viewNavigateHandler),b._viewActivateHandler&&a.unbind("activate",b._viewActivateHandler),b._viewActivateHandler=function(){var a=this;b._selection&&(a.constrainSelection(b._selection),b._select(),b._adjustSelectedDate())},a.bind("activate",b._viewActivateHandler)},_selectView:function(a){var b=this;a&&b.views[a]&&(b._selectedView&&b._unbindView(b._selectedView),b._selectedView=b._renderView(a),b._selectedViewName=a,b.toolbar.find(".k-scheduler-views li").removeClass("k-state-selected").end().find(".k-view-"+a.replace(/\./g,"\\.")).addClass("k-state-selected"))},view:function(a){var b=this;return a?(b._selectView(a),void b.rebind()):b._selectedView},_renderView:function(a){var b=this._initializeView(a);return this._bindView(b),this._model.set("formattedDate",b.dateForTitle()),b},resize:function(a){var b=this.getSize(),c=this._size;(a||!c||b.width!==c.width||b.height!==c.height)&&(this.refresh({action:"resize"}),this._size=b)},_adjustSelectedDate:function(){var a=this._model.selectedDate,b=this._selection,c=b.start;c&&!s.date.isInDateRange(a,x(c),x(b.end))&&a.setFullYear(c.getFullYear(),c.getMonth(),c.getDate())},_initializeView:function(a){var b=this.views[a];if(b){var c=H(b),d=b.type;if(typeof d===D&&(d=s.getter(b.type)(window)),!d)throw new Error("There is no such view");b=new d(this.wrapper,m(I(!0,{},this.options,c?b:{},{resources:this.resources,date:this.date(),showWorkHours:this._workDayMode})))}return b},_views:function(){var a,b,c,d,e,f,g,h,i=this.options.views;for(this.views={},g=0,h=i.length;h>g;g++){var j=!1;a=i[g],d=H(a),d?(f=e=a.type?a.type:a,typeof f!==D&&(e=a.title,j=!0)):f=e=a,b=ra[e],b&&!j&&(a.type=b.type,b.title=this.options.messages.views[e],"day"===b.type?b.messages={allDay:this.options.messages.allDay}:"agenda"===b.type&&(b.messages={event:this.options.messages.event,date:this.options.messages.date,time:this.options.messages.time})),a=I({title:e},b,d?a:{}),e&&(this.views[e]=a,(!c||a.selected)&&(c=e))}c&&(this._selectedViewName=c)},rebind:function(){this.dataSource.fetch()},_dataSource:function(){var a=this,b=a.options,c=b.dataSource;c=L(c)?{data:c}:c,!b.timezone||c instanceof ka||(c=I(!0,c,{schema:{timezone:b.timezone}})),a.dataSource&&a._refreshHandler?a.dataSource.unbind(O,a._refreshHandler).unbind("progress",a._progressHandler).unbind("error",a._errorHandler):(a._refreshHandler=J(a.refresh,a),a._progressHandler=J(a._requestStart,a),a._errorHandler=J(a._error,a)),a.dataSource=s.data.SchedulerDataSource.create(c).bind(O,a._refreshHandler).bind("progress",a._progressHandler).bind("error",a._errorHandler)},_error:function(){this._progress(!1)},_requestStart:function(){this._progress(!0)},_progress:function(a){var b=this.element.find(".k-scheduler-content");s.ui.progress(b,a)},_resources:function(){for(var b=this,c=b.options.resources,d=0;d<c.length;d++){var e=c[d],f=e.field,g=e.dataSource;if(!f||!g)throw new Error('The "field" and "dataSource" options of the scheduler resource are mandatory.');b.resources.push({field:f,name:e.name||f,title:e.title||f,dataTextField:e.dataTextField||"text",dataValueField:e.dataValueField||"value",dataColorField:e.dataColorField||"color",valuePrimitive:null!=e.valuePrimitive?e.valuePrimitive:!0,multiple:e.multiple||!1,dataSource:s.data.DataSource.create(g)})}var h=a.map(b.resources,function(a){return a.dataSource.fetch()});a.when.apply(null,h).then(function(){b.options.autoBind?b.view(b._selectedViewName):b._selectView(b._selectedViewName)})},_initModel:function(){var a=this;a._model=s.observable({selectedDate:new Date(this.options.date),formattedDate:""}),a._model.bind("change",function(b){"selectedDate"===b.field&&a.view(a._selectedViewName)})},_wrapper:function(){var a=this,b=a.options,c=b.height,d=b.width;a.wrapper=a.element.addClass("k-widget k-scheduler k-floatwrap").attr("role","grid").attr("aria-multiselectable",!0),a._isMobile()&&a.wrapper.addClass("k-scheduler-mobile"),a._isMobilePhoneView()&&a.wrapper.addClass("k-scheduler-phone"),c&&a.wrapper.height(c),d&&a.wrapper.width(d)},date:function(a){return null!=a&&x(a)>=x(this.options.min)&&x(a)<=x(this.options.max)&&this._model.set("selectedDate",a),x(this._model.get("selectedDate"))},_toolbar:function(){var b=this,c=b.options,d=this._isMobilePhoneView()?_:$,e=a(d({messages:c.messages,ns:s.ns,views:b.views}));b.wrapper.append(e),b.toolbar=e,s.bind(b.toolbar,b._model),e.on(N+M,".k-scheduler-navigation li",function(c){var d=a(this),e=new Date(b.date()),f="";if(c.preventDefault(),d.hasClass("k-nav-today"))f="today",e=new Date;else if(d.hasClass("k-nav-next"))f="next",e=b.view().nextDate();else if(d.hasClass("k-nav-prev"))f="previous",e=b.view().previousDate();else if(d.hasClass("k-nav-current")&&!b._isMobilePhoneView())return void b._showCalendar();b.trigger("navigate",{view:b._selectedViewName,action:f,date:e})||b.date(e)}),e.on(N+M,".k-scheduler-views li",function(c){c.preventDefault();var d=a(this).attr(s.attr("name"));b.trigger("navigate",{view:d,action:"changeView",date:b.date()})||b.view(d)}),e.find("li").hover(function(){a(this).addClass("k-state-hover")},function(){a(this).removeClass("k-state-hover")})},_showCalendar:function(){var b=this,c=b.toolbar.find(".k-nav-current"),d=a('<div class="k-calendar-container"><div class="k-scheduler-calendar"/></div>');b.popup||(b.popup=new E(d,{anchor:c,activate:function(){b.calendar||(b.calendar=new F(this.element.find(".k-scheduler-calendar"),{change:function(){var a=this.value();b.trigger("navigate",{view:b._selectedViewName,action:"changeDate",date:a})||(b.date(a),b.popup.close())},min:b.options.min,max:b.options.max})),b.calendar.value(b.date())},copyAnchorStyles:!1})),b.popup.open()},refresh:function(a){var b=this.view();this._progress(!1),a=a||{},b&&(a&&"itemchange"===a.action&&(this._editor.editable||this._preventRefresh)||this.trigger("dataBinding",{action:a.action||"rebind",index:a.index,items:a.items})||(a&&"resize"===a.action||!this._editor||this._editor.close(),this._data=this.dataSource.expand(b.startDate(),b.endDate()),b.render(this._data),this.trigger("dataBound")))},slotByPosition:function(a,b){var c=this.view();if(!c._slotByPosition)return null;var d=c._slotByPosition(a,b);return d?{startDate:d.startDate(),endDate:d.endDate(),groupIndex:d.groupIndex,element:d.element,isDaySlot:d.isDaySlot}:null},slotByElement:function(b){var c=a(b).offset();return this.slotByPosition(c.left,c.top)},resourcesBySlot:function(a){return this.view()._resourceBySlot(a)}}),ra={day:{type:"joy.ui.DayView"},week:{type:"joy.ui.WeekView"},workWeek:{type:"joy.ui.WorkWeekView"},agenda:{type:"joy.ui.AgendaView"},month:{type:"joy.ui.MonthView"}};B.plugin(qa);var sa=C.extend({init:function(a,b){var c=this,d=s.timezone.windows_zones;if(!d||!s.timezone.zones_titles)throw new Error("joy.timezones.min.js is not included.");C.fn.init.call(c,a,b),c.wrapper=c.element,c._zonesQuery=new s.data.Query(d),c._zoneTitleId=s.guid(),c._zoneTitlePicker(),c._zonePicker(),c.value(c.options.value)},options:{name:"TimezoneEditor",value:"",optionLabel:"No timezone"},events:["change"],_zoneTitlePicker:function(){var b=this,c=a('<input id="'+b._zoneTitleId+'"/>').appendTo(b.wrapper);b._zoneTitle=new s.ui.DropDownList(c,{dataSource:s.timezone.zones_titles,dataValueField:"other_zone",dataTextField:"name",optionLabel:b.options.optionLabel,cascade:function(){this.value()||b._zone.wrapper.hide()}})},_zonePicker:function(){var b=this,c=a("<input />").appendTo(this.wrapper);b._zone=new s.ui.DropDownList(c,{dataValueField:"zone",dataTextField:"territory",dataSource:b._zonesQuery.data,cascadeFrom:b._zoneTitleId,cascade:function(){b._value=this.value(),b.trigger("change")},dataBound:function(){b._value=this.value(),this.wrapper.toggle(this.dataSource.view().length>1)}}),b._zone.wrapper.hide()},destroy:function(){C.fn.destroy.call(this),s.destroy(this.wrapper)},value:function(a){var c,d=this;return a===b?d._value:(c=d._zonesQuery.filter({field:"zone",operator:"eq",value:a}).data[0],void(c?(d._zoneTitle.value(c.other_zone),d._zone.value(c.zone)):d._zoneTitle.value("")))}});B.plugin(sa);var ta=s.template('<option value="#=other_zone#">#=name#</option>'),ua=s.template('<option value="#=zone#">#=territory#</option>'),va=C.extend({init:function(a,b){var c=this,d=s.timezone.windows_zones;if(!d||!s.timezone.zones_titles)throw new Error("joy.timezones.min.js is not included.");C.fn.init.call(c,a,b),c.wrapper=c.element,c._zonesQuery=new s.data.Query(d),c._zoneTitlePicker(),c._zonePicker(),c.value(c.options.value)},options:{name:"MobileTimezoneEditor",optionLabel:"No timezone",value:""},events:["change"],_bindZones:function(a){var b=a?this._filter(a):[];this._zone.html(this._options(b,ua))},_filter:function(a){return this._zonesQuery.filter({field:"other_zone",operator:"eq",value:a}).data},_options:function(a,b,c){var d=0,e="",f=a.length;for(c&&(e+=b({other_zone:"",name:this.options.optionLabel}));f>d;d++)e+=b(a[d]);return e},_zoneTitlePicker:function(){var b=this,c=b._options(s.timezone.zones_titles,ta,b.options.optionLabel);b._zoneTitle=a("<select>"+c+"</select>").appendTo(b.wrapper).change(function(){var a=this.value,c=b._zone;b._bindZones(a),a&&c[0].children.length>1?c.show():c.hide(),b._value=c[0].value,b.trigger("change")})},_zonePicker:function(){var b=this;b._zone=a('<select style="display:none"></select>').appendTo(this.wrapper).change(function(){b._value=this.value,b.trigger("change")}),b._bindZones(b._zoneTitle.val()),b._value=b._zone[0].value},destroy:function(){C.fn.destroy.call(this),s.destroy(this.wrapper)},value:function(a){var c,d=this,e=d._zone,f="",g="";return a===b?d._value:(c=d._zonesQuery.filter({field:"zone",operator:"eq",value:a}).data[0],c&&(g=c.zone,f=c.other_zone),d._zoneTitle.val(f),d._bindZones(f),e.val(g),g=e[0].value,g&&e[0].children.length>1?e.show():e.hide(),void(d._value=g))}});B.plugin(va)}(window.joy.jQuery);