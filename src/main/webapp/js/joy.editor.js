/*! by joyone.cn 厦门展网信息技术有限公司  joyone 2015-04-30  1.0.20 */
!function(a,b){var c=window.joy,d=c.getPluginLang(),e=c.Class,f=c.ui.Widget,g=c.ui.FormElement,h=c.support.mobileOS,i=c.support.browser,j=a.extend,k=a.proxy,l=c.deepExtend,m=".joyEditor",n=c.keys,o=e.extend({init:function(a){this.options=a},getHtml:function(){var a=this.options;return c.template(a.template,{useWithBlock:!1})(a)}}),p={editorWrapperTemplate:'<table cellspacing="4" cellpadding="0" class="k-widget k-editor k-header" role="presentation"><tbody><tr role="presentation"><td class="k-editor-toolbar-wrap" role="presentation"><ul class="k-editor-toolbar" role="toolbar" /></td></tr><tr><td class="k-editable-area" /></tr></tbody></table>',buttonTemplate:'<a href="" role="button" class="k-tool"#= data.popup ? " data-popup" : "" # unselectable="on" title="#= data.title #"><span class="k-tool-icon #= data.cssClass #">#= data.title #</span></a>',colorPickerTemplate:'<div class="k-colorpicker #= data.cssClass #" />',comboBoxTemplate:'<select title="#= data.title #" class="#= data.cssClass #" />',dropDownListTemplate:'<span class="k-editor-dropdown"><select title="#= data.title #" class="#= data.cssClass #" /></span>',separatorTemplate:'<span class="k-separator" />',formatByName:function(b,c){for(var d=0;d<c.length;d++)if(a.inArray(b,c[d].tags)>=0)return c[d]},registerTool:function(a,b){var c=b.options;c&&c.template&&(c.template.options.cssClass="k-"+a),b.name||(b.options.name=a,b.name=a.toLowerCase()),t.defaultTools[a]=b},registerFormat:function(a,b){t.fn.options.formats[a]=b}},q={bold:d.editor.bold,italic:d.editor.italic,underline:d.editor.underline,strikethrough:d.editor.strikethrough,superscript:d.editor.superscript,subscript:d.editor.subscript,justifyCenter:d.editor.justifyCenter,justifyLeft:d.editor.justifyLeft,justifyRight:d.editor.justifyRight,justifyFull:d.editor.justifyFull,insertUnorderedList:d.editor.insertUnorderedList,insertOrderedList:d.editor.insertOrderedList,indent:d.editor.indent,outdent:d.editor.outdent,createLink:d.editor.createLink,unlink:d.editor.unlink,insertImage:d.editor.insertImage,insertHtml:d.editor.insertHtml,viewHtml:d.editor.viewHtml,fontName:d.editor.fontName,fontNameInherit:d.editor.fontNameInherit,fontSize:d.editor.fontSize,fontSizeInherit:d.editor.fontSizeInherit,formatBlock:d.editor.formatBlock,formatting:d.editor.formatting,foreColor:d.editor.foreColor,backColor:d.editor.backColor,style:d.editor.style,emptyFolder:d.editor.emptyFolder,uploadFile:d.editor.uploadFile,orderBy:d.editor.orderBy,orderBySize:d.editor.orderBySize,orderByName:d.editor.orderByName,invalidFileType:d.editor.invalidFileType,deleteFile:d.editor.deleteFile,overwriteFile:d.editor.overwriteFile,directoryNotFound:d.editor.directoryNotFound,imageWebAddress:d.editor.imageWebAddress,imageAltText:d.editor.imageAltText,imageWidth:d.editor.imageWidth,imageHeight:d.editor.imageHeight,linkWebAddress:d.editor.linkWebAddress,linkText:d.editor.linkText,linkToolTip:d.editor.linkText,linkOpenInNewWindow:d.editor.linkOpenInNewWindow,dialogUpdate:d.editor.dialogUpdate,dialogInsert:d.editor.dialogInsert,dialogButtonSeparator:d.editor.dialogButtonSeparator,dialogCancel:d.editor.dialogCancel,createTable:d.editor.createTable,addColumnLeft:d.editor.addColumnLeft,addColumnRight:d.editor.addColumnRight,addRowAbove:d.editor.addRowAbove,addRowBelow:d.editor.addRowBelow,deleteRow:d.editor.deleteRow,deleteColumn:d.editor.deleteColumn},r=!h||h.ios&&h.flatVersion>=500||!h.ios&&"undefined"!=typeof document.documentElement.contentEditable,s={basic:["bold","italic","underline"],alignment:["justifyLeft","justifyCenter","justifyRight"],lists:["insertUnorderedList","insertOrderedList"],indenting:["indent","outdent"],links:["createLink","unlink"],tables:["createTable","addColumnLeft","addColumnRight","addRowAbove","addRowBelow","deleteRow","deleteColumn"]},t=g.extend({init:function(b,d){var e,g,h,i,n=this,o=c.ui.editor;r&&(f.fn.init.call(n,b,d),n.options=l({},n.options,d),b=n.element,i=o.Dom.name(b[0]),b.closest("form").on("submit"+m,function(){n.update()}),h=j({},n.options),h.editor=n,"textarea"==i?(n._wrapTextarea(),g=n.wrapper.find(".k-editor-toolbar"),b[0].id&&g.attr("aria-controls",b[0].id)):(n.element.attr("contenteditable",!0).addClass("k-widget k-editor k-editor-inline"),h.popup=!0,g=a('<ul class="k-editor-toolbar" role="toolbar" />').insertBefore(b)),n.toolbar=new o.Toolbar(g[0],h),n.toolbar.bindTo(n),n._initializeContentElement(n),n.keyboard=new o.Keyboard([new o.TypingHandler(n),new o.SystemHandler(n)]),n.clipboard=new o.Clipboard(this),n.undoRedoStack=new o.UndoRedoStack,e=d&&d.value?d.value:n.textarea?b.val().replace(/[\r\n\v\f\t ]+/gi," "):b[0].innerHTML,n.value(e),n._initFormElement(),a(document).on("mousedown",k(n._endTyping,n)).on("mouseup",k(n._mouseup,n)),c.notify(n))},_endTyping:function(){var a=this.keyboard;try{a.isTypingInProgress()&&(a.endTyping(!0),this.saveSelection())}catch(b){}},_selectionChange:function(){i.msie||c.ui.editor.Dom.ensureTrailingBreaks(this.body),this._selectionStarted=!1,this.saveSelection(),this.trigger("select",{})},_wrapTextarea:function(){var b=this,c=b.element,d=c[0].style.width,e=c[0].style.height,f=p.editorWrapperTemplate,g=a(f).insertBefore(c).width(d).height(e),h=g.find(".k-editable-area");c.attr("autocomplete","off").appendTo(h).addClass("k-content k-raw-content").css("display","none"),b.textarea=c,b.wrapper=g},_createContentElement:function(b){var d,e,f,g=this,h=g.textarea,i=document.domain,j='javascript:""';return i!=location.hostname&&(j="javascript:document.write('<script>document.domain=\""+i+"\"</script>')"),h.hide(),d=a("<iframe />",{frameBorder:"0"})[0],a(d).css("display","").addClass("k-content").insertBefore(h),d.src=j,e=d.contentWindow||d,f=e.document||d.contentDocument,a(d).one("load",function(){g.toolbar.decorateFrom(f.body)}),f.open(),f.write("<!DOCTYPE html><html><head><meta charset='utf-8' /><style>html,body{padding:0;margin:0;height:100%;min-height:100%;}body{font-size:12px;font-family:Verdana,Geneva,sans-serif;padding-top:1px;margin-top:-1px;word-wrap: break-word;-webkit-nbsp-mode: space;-webkit-line-break: after-white-space;"+(c.support.isRtl(h)?"direction:rtl;":"")+"}h1{font-size:2em;margin:.67em 0}h2{font-size:1.5em}h3{font-size:1.16em}h4{font-size:1em}h5{font-size:.83em}h6{font-size:.7em}p{margin:0 0 1em;padding:0 .2em}.k-marker{display:none;}.k-paste-container,.Apple-style-span{position:absolute;left:-10000px;width:1px;height:1px;overflow:hidden}ul,ol{padding-left:2.5em}span{-ms-high-contrast-adjust:none;}a{color:#00a}code{font-size:1.23em}telerik\\3Ascript{display: none;}.k-table{table-layout:fixed;width:100%;border-spacing:0;margin: 0 0 1em;}.k-table td{min-width:1px;padding:.2em .3em;}.k-table,.k-table td{outline:0;border: 1px dotted #ccc;}.k-table p{margin:0;padding:0;}</style><script>(function(d,c){d[c]('header'),d[c]('article'),d[c]('nav'),d[c]('section'),d[c]('footer');})(document, 'createElement');</script>"+a.map(b,function(a){return"<link rel='stylesheet' href='"+a+"'>"}).join("")+"</head><body autocorrect='off' contenteditable='true'></body></html>"),f.close(),e},_blur:function(){var a=this.textarea,b=a?a.val():this._oldValue,c=this.options.encoded?this.encodedValue():this.value();this.update(),a&&a.trigger("blur"),c!=b&&this.trigger("change");var d=this;null!=d.parentForm&&1==d.parentForm.options.autoValidatable&&d.validate()},validate:function(){var a=this,b=a.options,d=a.element,e=d.val(),f=c.getPluginLang();if(b.required&&""==e)return a.showInfo(c.format(f.form.requiredInfo,b.subject)),!1;var g=c.getByteLength(d.val());return""!=b.minByte&&g<parseInt(b.minByte)?(a.showInfo(c.format(f.form.minByteInfo,b.minByte,g)),!1):""!=b.maxByte&&g>parseInt(b.maxByte)?(a.showInfo(c.format(f.form.maxByteInfo,b.maxByte,g)),!1):(a.hideInfo(d),!0)},_initializeContentElement:function(){var b,d,e=this;e.textarea?(e.window=e._createContentElement(e.options.stylesheets),b=e.document=e.window.contentDocument||e.window.document,e.body=b.body,d=e.window,a(b).on("mouseup"+m,k(e._mouseup,e))):(e.window=window,b=e.document=document,e.body=e.element[0],d=e.body,e.toolbar.decorateFrom(e.body)),a(d).on("blur"+m,k(this._blur,this));try{b.execCommand("enableInlineTableEditing",null,!1)}catch(f){}c.support.touch&&a(b).on("selectionchange"+m,k(this._selectionChange,this)).on("keydown"+m,function(){c._activeElement()!=b.body&&e.window.focus()}),a(e.body).on("keydown"+m,function(a){var b;if(a.keyCode===n.F10)return setTimeout(k(e.toolbar.focus,e.toolbar),100),void a.preventDefault();if(a.keyCode===n.BACKSPACE){b=e.getRange();var d,f=i.msie?"":'<br _moz_dirty="" />',g=c.ui.editor.Dom;b.deleteContents(),d=b.commonAncestorContainer,"p"===g.name(d)&&""===d.innerHTML&&(d.innerHTML=f,b.setStart(d,0),b.collapse(!0),e.selectRange(b))}else if(a.keyCode==n.LEFT||a.keyCode==n.RIGHT){b=e.getRange();var h=a.keyCode==n.LEFT,j=b[h?"startContainer":"endContainer"],l=b[h?"startOffset":"endOffset"],m=h?-1:1;h&&(l-=1),l+m>0&&3==j.nodeType&&"\ufeff"==j.nodeValue[l]&&(b.setStart(j,l+m),b.collapse(!0),e.selectRange(b))}var o=e.keyboard.toolFromShortcut(e.toolbar.tools,a);return o?(a.preventDefault(),/^(undo|redo)$/.test(o)||e.keyboard.endTyping(!0),e.trigger("keydown",a),e.exec(o),!1):(e.keyboard.clearTimeout(),void e.keyboard.keydown(a))}).on("keyup"+m,function(b){var c=[8,9,33,34,35,36,37,38,39,40,40,45,46];(a.inArray(b.keyCode,c)>-1||65==b.keyCode&&b.ctrlKey&&!b.altKey&&!b.shiftKey)&&e._selectionChange(),e.keyboard.keyup(b)}).on("mousedown"+m,function(b){e._selectionStarted=!0;var c=a(b.target);!i.gecko&&2==b.which&&c.is("a[href]")&&window.open(c.attr("href"),"_new")}).on("click"+m,function(a){var b,d=c.ui.editor.Dom;"img"===d.name(a.target)&&(b=e.createRange(),b.selectNode(a.target),e.selectRange(b))}).on("cut"+m+" paste"+m,function(a){e.clipboard["on"+a.type](a)}).on("focusin"+m,function(){a(this).addClass("k-state-active"),e.toolbar.show()}).on("focusout"+m,function(){setTimeout(function(){var b=c._activeElement(),d=e.body,f=e.toolbar;b==d||a.contains(d,b)||f.focused()||(a(d).removeClass("k-state-active"),f.hide())},10)})},_mouseup:function(){var a=this;a._selectionStarted&&setTimeout(function(){a._selectionChange()},1)},refresh:function(){var a=this;a.textarea&&(a.textarea.val(a.value()),a.wrapper.find("iframe").remove(),a._initializeContentElement(a),a.value(a.textarea.val()))},events:["select","change","execute","error","paste","keydown","keyup"],options:{name:"Editor",messages:q,formats:{},editorType:"normal",encoded:!1,maxByte:"",minByte:"",subject:"",label:"",sourceCode:"",required:!1,serialization:{entities:!0},stylesheets:[],dialogOptions:{modal:!0,resizable:!1,draggable:!0,animation:!1},fontName:[{text:"Arial",value:"Arial,Helvetica,sans-serif"},{text:"Courier New",value:"'Courier New',Courier,monospace"},{text:"Georgia",value:"Georgia,serif"},{text:"Impact",value:"Impact,Charcoal,sans-serif"},{text:"Lucida Console",value:"'Lucida Console',Monaco,monospace"},{text:"Tahoma",value:"Tahoma,Geneva,sans-serif"},{text:"Times New Roman",value:"'Times New Roman',Times,serif"},{text:"Trebuchet MS",value:"'Trebuchet MS',Helvetica,sans-serif"},{text:"Verdana",value:"Verdana,Geneva,sans-serif"}],fontSize:[{text:"1 (8pt)",value:"xx-small"},{text:"2 (10pt)",value:"x-small"},{text:"3 (12pt)",value:"small"},{text:"4 (14pt)",value:"medium"},{text:"5 (18pt)",value:"large"},{text:"6 (24pt)",value:"x-large"},{text:"7 (36pt)",value:"xx-large"}],formatBlock:[{text:"Paragraph",value:"p"},{text:"Quotation",value:"blockquote"},{text:"Heading 1",value:"h1"},{text:"Heading 2",value:"h2"},{text:"Heading 3",value:"h3"},{text:"Heading 4",value:"h4"},{text:"Heading 5",value:"h5"},{text:"Heading 6",value:"h6"}],toolbarOptions:[].concat.call(["formatting"],s.basic,s.alignment,s.lists,s.indenting,s.links,["insertImage"],s.tables)},destroy:function(){var b=this;f.fn.destroy.call(b),a(b.window).add(b.document).add(b.body).add(b.wrapper).add(b.element.closest("form")).off(m),a(document).off("mousedown",k(b._endTyping,b)).off("mouseup",k(b._mouseup,b)),b.toolbar.destroy(),c.destroy(b.wrapper)},state:function(a){var b,d,e=t.defaultTools[a],f=e&&(e.options.finder||e.finder),g=c.ui.editor.RangeUtils;return f?(b=this.getRange(),d=g.textNodes(b),!d.length&&b.collapsed&&(d=[b.startContainer]),f.getFormat?f.getFormat(d):f.isFormatted(d)):!1},value:function(a){var d=this.body,e=c.ui.editor,f=(e.Dom,e.Serializer.domToXhtml(d,this.options.serialization));return a===b?f:void(a!=f&&(e.Serializer.htmlToDom(a,d),this.selectionRestorePoint=null,this.update()))},saveSelection:function(b){b=b||this.getRange();var d=b.commonAncestorContainer,e=this.body;(d==e||a.contains(e,d))&&(this.selectionRestorePoint=new c.ui.editor.RestorePoint(b))},_focusBody:function(){var a=this.body,b=this.document.documentElement;if(c._activeElement()!=a){var d=b.scrollTop;a.focus(),b.scrollTop=d}},restoreSelection:function(){this._focusBody(),this.selectionRestorePoint&&this.selectRange(this.selectionRestorePoint.toRange())},focus:function(){this.restoreSelection()},update:function(a){a=a||this.options.encoded?this.encodedValue():this.value(),this.textarea?this.textarea.val(a):this._oldValue=a},encodedValue:function(){return c.ui.editor.Dom.encode(this.value())},createRange:function(a){return c.ui.editor.RangeUtils.createRange(a||this.document)},getSelection:function(){return c.ui.editor.SelectionUtils.selectionFromDocument(this.document)},selectRange:function(a){this._focusBody();var b=this.getSelection();b.removeAllRanges(),b.addRange(a),this.saveSelection(a)},getRange:function(){var a=this.getSelection(),b=a.rangeCount>0?a.getRangeAt(0):this.createRange(),c=this.document;return b.startContainer!=c||b.endContainer!=c||b.startOffset||b.endOffset||(b.setStart(this.body,0),b.collapse(!0)),b},selectedHtml:function(){return c.ui.editor.Serializer.domToXhtml(this.getRange().cloneContents())},paste:function(a,b){this.clipboard.paste(a,b)},exec:function(a,b){var c,d,e=this,f=null;if(!a)throw new Error("joyEditor.exec(): `name` parameter cannot be empty");if(a=a.toLowerCase(),e.keyboard.isTypingInProgress()||e.restoreSelection(),d=e.toolbar.toolById(a),!d)for(var g in t.defaultTools)if(g.toLowerCase()==a){d=t.defaultTools[g];break}if(d){if(c=e.getRange(),d.command&&(f=d.command(j({range:c},b))),e.trigger("execute",{name:a,command:f}),/^(undo|redo)$/i.test(a))e.undoRedoStack[a]();else if(f&&(f.managesUndoRedo||e.undoRedoStack.push(f),f.editor=e,f.exec(),f.async))return void(f.change=k(e._selectionChange,e));e._selectionChange()}}});t.defaultTools={undo:{options:{key:"Z",ctrl:!0}},redo:{options:{key:"Y",ctrl:!0}}},c.ui.plugin(t);var u=e.extend({init:function(a){this.options=a},initialize:function(a,b){a.attr({unselectable:"on",title:b.title})},command:function(a){return new this.options.command(a)},update:a.noop});u.exec=function(a,b,c){a.exec(b,{value:c})};var v=u.extend({init:function(a){u.fn.init.call(this,a)},command:function(a){var b=this;return new c.ui.editor.FormatCommand(j(a,{formatter:b.options.formatter}))},update:function(a,b){var c=this.options.finder.isFormatted(b);a.toggleClass("k-state-selected",c),a.attr("aria-pressed",c)}});p.registerTool("separator",new u({template:new o({template:p.separatorTemplate})}));var w=i.msie&&i.version<9?"\ufeff":"";j(c.ui,{editor:{ToolTemplate:o,EditorUtils:p,Tool:u,FormatTool:v,_bomFill:w,emptyElementContent:i.msie?"\ufeff":'<br _moz_dirty="" />'}})}(window.jQuery),function(a){function b(a){var b,c,d={};for(b=0,c=a.length;c>b;b++)d[a[b]]=!0;return d}var c=window.joy,d=a.map,e=a.extend,f=c.support.browser,g="style",h="float",i="cssFloat",j="styleFloat",k="class",l="k-marker",m=b("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed".split(",")),n="div,p,h1,h2,h3,h4,h5,h6,address,applet,blockquote,button,center,dd,dir,dl,dt,fieldset,form,frameset,hr,iframe,isindex,map,menu,noframes,noscript,object,pre,script,table,tbody,td,tfoot,th,thead,tr,header,article,nav,footer,section,aside,main,figure,figcaption".split(","),o=n.concat(["ul","ol","li"]),p=b(o),q="span,em,a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,strike,strong,sub,sup,textarea,tt,u,var,data,time,mark,ruby".split(","),r=b(q),s=b("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected".split(",")),t=function(a){1==a.nodeType&&a.normalize()};f.msie&&f.version>=8&&(t=function(a){if(1==a.nodeType&&a.firstChild)for(var b=a.firstChild,c=b;;){if(c=c.nextSibling,!c)break;3==c.nodeType&&3==b.nodeType&&(c.nodeValue=b.nodeValue+c.nodeValue,D.remove(b)),b=c}});var u,v=/^\s+$/,w=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/i,x=/\ufeff/g,y=/^(\s+|\ufeff)$/,z="color,padding-left,padding-right,padding-top,padding-bottom,background-color,background-attachment,background-image,background-position,background-repeat,border-top-style,border-top-width,border-top-color,border-bottom-style,border-bottom-width,border-bottom-color,border-left-style,border-left-width,border-left-color,border-right-style,border-right-width,border-right-color,font-family,font-size,font-style,font-variant,font-weight,line-height".split(","),A=/[<>\&]/g,B=/[\u00A0-\u2666<>\&]/g,C={34:"quot",38:"amp",39:"apos",60:"lt",62:"gt",160:"nbsp",161:"iexcl",162:"cent",163:"pound",164:"curren",165:"yen",166:"brvbar",167:"sect",168:"uml",169:"copy",170:"ordf",171:"laquo",172:"not",173:"shy",174:"reg",175:"macr",176:"deg",177:"plusmn",178:"sup2",179:"sup3",180:"acute",181:"micro",182:"para",183:"middot",184:"cedil",185:"sup1",186:"ordm",187:"raquo",188:"frac14",189:"frac12",190:"frac34",191:"iquest",192:"Agrave",193:"Aacute",194:"Acirc",195:"Atilde",196:"Auml",197:"Aring",198:"AElig",199:"Ccedil",200:"Egrave",201:"Eacute",202:"Ecirc",203:"Euml",204:"Igrave",205:"Iacute",206:"Icirc",207:"Iuml",208:"ETH",209:"Ntilde",210:"Ograve",211:"Oacute",212:"Ocirc",213:"Otilde",214:"Ouml",215:"times",216:"Oslash",217:"Ugrave",218:"Uacute",219:"Ucirc",220:"Uuml",221:"Yacute",222:"THORN",223:"szlig",224:"agrave",225:"aacute",226:"acirc",227:"atilde",228:"auml",229:"aring",230:"aelig",231:"ccedil",232:"egrave",233:"eacute",234:"ecirc",235:"euml",236:"igrave",237:"iacute",238:"icirc",239:"iuml",240:"eth",241:"ntilde",242:"ograve",243:"oacute",244:"ocirc",245:"otilde",246:"ouml",247:"divide",248:"oslash",249:"ugrave",250:"uacute",251:"ucirc",252:"uuml",253:"yacute",254:"thorn",255:"yuml",402:"fnof",913:"Alpha",914:"Beta",915:"Gamma",916:"Delta",917:"Epsilon",918:"Zeta",919:"Eta",920:"Theta",921:"Iota",922:"Kappa",923:"Lambda",924:"Mu",925:"Nu",926:"Xi",927:"Omicron",928:"Pi",929:"Rho",931:"Sigma",932:"Tau",933:"Upsilon",934:"Phi",935:"Chi",936:"Psi",937:"Omega",945:"alpha",946:"beta",947:"gamma",948:"delta",949:"epsilon",950:"zeta",951:"eta",952:"theta",953:"iota",954:"kappa",955:"lambda",956:"mu",957:"nu",958:"xi",959:"omicron",960:"pi",961:"rho",962:"sigmaf",963:"sigma",964:"tau",965:"upsilon",966:"phi",967:"chi",968:"psi",969:"omega",977:"thetasym",978:"upsih",982:"piv",8226:"bull",8230:"hellip",8242:"prime",8243:"Prime",8254:"oline",8260:"frasl",8472:"weierp",8465:"image",8476:"real",8482:"trade",8501:"alefsym",8592:"larr",8593:"uarr",8594:"rarr",8595:"darr",8596:"harr",8629:"crarr",8656:"lArr",8657:"uArr",8658:"rArr",8659:"dArr",8660:"hArr",8704:"forall",8706:"part",8707:"exist",8709:"empty",8711:"nabla",8712:"isin",8713:"notin",8715:"ni",8719:"prod",8721:"sum",8722:"minus",8727:"lowast",8730:"radic",8733:"prop",8734:"infin",8736:"ang",8743:"and",8744:"or",8745:"cap",8746:"cup",8747:"int",8756:"there4",8764:"sim",8773:"cong",8776:"asymp",8800:"ne",8801:"equiv",8804:"le",8805:"ge",8834:"sub",8835:"sup",8836:"nsub",8838:"sube",8839:"supe",8853:"oplus",8855:"otimes",8869:"perp",8901:"sdot",8968:"lceil",8969:"rceil",8970:"lfloor",8971:"rfloor",9001:"lang",9002:"rang",9674:"loz",9824:"spades",9827:"clubs",9829:"hearts",9830:"diams",338:"OElig",339:"oelig",352:"Scaron",353:"scaron",376:"Yuml",710:"circ",732:"tilde",8194:"ensp",8195:"emsp",8201:"thinsp",8204:"zwnj",8205:"zwj",8206:"lrm",8207:"rlm",8211:"ndash",8212:"mdash",8216:"lsquo",8217:"rsquo",8218:"sbquo",8220:"ldquo",8221:"rdquo",8222:"bdquo",8224:"dagger",8225:"Dagger",8240:"permil",8249:"lsaquo",8250:"rsaquo",8364:"euro"},D={block:p,inline:r,findNodeIndex:function(a,b){for(var c=0;;){if(a=a.previousSibling,!a)break;b&&3==a.nodeType||c++}return c},isDataNode:function(a){return a&&null!==a.nodeValue&&null!==a.data},isAncestorOf:function(b,c){try{return!D.isDataNode(b)&&(a.contains(b,D.isDataNode(c)?c.parentNode:c)||c.parentNode==b)}catch(d){return!1}},isAncestorOrSelf:function(a,b){return D.isAncestorOf(a,b)||a==b},findClosestAncestor:function(a,b){if(D.isAncestorOf(a,b))for(;b&&b.parentNode!=a;)b=b.parentNode;return b},getNodeLength:function(a){return D.isDataNode(a)?a.length:a.childNodes.length},splitDataNode:function(a,b){for(var c=a.cloneNode(!1),d="",e=a;e.nextSibling&&3==e.nextSibling.nodeType&&e.nextSibling.nodeValue;)d+=e.nextSibling.nodeValue,e=e.nextSibling;a.deleteData(b,a.length),c.deleteData(0,b),c.nodeValue+=d,D.insertAfter(c,a)},attrEquals:function(a,b){for(var d in b){var e=a[d];if(d==h&&(e=a[c.support.cssFloat?i:j]),"object"==typeof e){if(!D.attrEquals(e,b[d]))return!1}else if(e!=b[d])return!1}return!0},blockParentOrBody:function(a){return D.parentOfType(a,o)||a.ownerDocument.body},blockParents:function(b){var c,d,e=[];for(c=0,d=b.length;d>c;c++){var f=D.parentOfType(b[c],D.blockElements);f&&a.inArray(f,e)<0&&e.push(f)}return e},windowFromDocument:function(a){return a.defaultView||a.parentWindow},normalize:t,blockElements:o,nonListBlockElements:n,inlineElements:q,empty:m,fillAttrs:s,toHex:function(a){var b=w.exec(a);return b?"#"+d(b.slice(1),function(a){return a=parseInt(a,10).toString(16),a.length>1?a:"0"+a}).join(""):a},encode:function(a,b){var c=!b||b.entities?B:A;return a.replace(c,function(a){var b=a.charCodeAt(0),c=C[b];return c?"&"+c+";":a})},stripBom:function(a){return(a||"").replace(x,"")},insignificant:function(a){var b=a.attributes;return"k-marker"==a.className||D.is(a,"br")&&(b._moz_dirty||b._moz_editor_bogus_node)},emptyNode:function(b){var c=a.grep(b.childNodes,function(a){return D.is(a,"br")?!1:D.insignificant(a)?!1:3==a.nodeType&&y.test(a.nodeValue)?!1:D.is(a,"p")&&D.emptyNode(a)?!1:!0});return!c.length},name:function(a){return a.nodeName.toLowerCase()},significantChildNodes:function(b){return a.grep(b.childNodes,function(a){return 3!=a.nodeType||!D.isWhitespace(a)})},lastTextNode:function(a){var b=null;if(3==a.nodeType)return a;for(var c=a.lastChild;c;c=c.previousSibling)if(b=D.lastTextNode(c))return b;return b},is:function(a,b){return D.name(a)==b},isMarker:function(a){return a.className==l},isWhitespace:function(a){return v.test(a.nodeValue)},isBlock:function(a){return p[D.name(a)]},isEmpty:function(a){return m[D.name(a)]},isInline:function(a){return r[D.name(a)]},scrollContainer:function(a){var b=D.windowFromDocument(a),d=(b.contentWindow||b).document||b.ownerDocument||b;return d=c.support.browser.webkit||"BackCompat"==d.compatMode?d.body:d.documentElement},scrollTo:function(b){var c,d,e=a(D.isDataNode(b)?b.parentNode:b),f=D.windowFromDocument(b.ownerDocument),g=f.innerHeight,h=D.scrollContainer(b.ownerDocument);"br"==D.name(e[0])&&(e=e.parent()),c=e.offset().top,d=e[0].offsetHeight,d+c>h.scrollTop+g&&(h.scrollTop=d+c-g)},persistScrollTop:function(a){u=D.scrollContainer(a).scrollTop},restoreScrollTop:function(a){D.scrollContainer(a).scrollTop=u},insertAt:function(a,b,c){a.insertBefore(b,a.childNodes[c]||null)},insertBefore:function(a,b){return b.parentNode?b.parentNode.insertBefore(a,b):b},insertAfter:function(a,b){return b.parentNode.insertBefore(a,b.nextSibling)},remove:function(a){a.parentNode.removeChild(a)},removeTextSiblings:function(a){for(var b=a.parentNode;a.nextSibling&&3==a.nextSibling.nodeType;)b.removeChild(a.nextSibling);for(;a.previousSibling&&3==a.previousSibling.nodeType;)b.removeChild(a.previousSibling)},trim:function(a){for(var b=a.childNodes.length-1;b>=0;b--){var c=a.childNodes[b];D.isDataNode(c)?(D.stripBom(c.nodeValue).length||D.remove(c),D.isWhitespace(c)&&D.insertBefore(c,a)):c.className!=l&&(D.trim(c),c.childNodes.length||D.isEmpty(c)||D.remove(c))}return a},closest:function(a,b){for(;a&&D.name(a)!=b;)a=a.parentNode;return a},sibling:function(a,b){do a=a[b];while(a&&1!=a.nodeType);return a},next:function(a){return D.sibling(a,"nextSibling")},prev:function(a){return D.sibling(a,"previousSibling")},parentOfType:function(a,b){do a=a.parentNode;while(a&&!D.ofType(a,b));return a},ofType:function(b,c){return a.inArray(D.name(b),c)>=0},changeTag:function(a,b){var c,d,e,f,h,i=D.create(a.ownerDocument,b),j=a.attributes;for(c=0,d=j.length;d>c;c++)h=j[c],h.specified&&(e=h.nodeName,f=h.nodeValue,e==k?i.className=f:e==g?i.style.cssText=a.style.cssText:i.setAttribute(e,f));for(;a.firstChild;)i.appendChild(a.firstChild);return D.insertBefore(i,a),D.remove(a),i},editableParent:function(a){for(;3==a.nodeType||"true"!==a.contentEditable;)a=a.parentNode;return a},wrap:function(a,b){return D.insertBefore(b,a),b.appendChild(a),b},unwrap:function(a){for(var b=a.parentNode;a.firstChild;)b.insertBefore(a.firstChild,a);b.removeChild(a)},create:function(a,b,c){return D.attr(a.createElement(b),c)},attr:function(a,b){b=e({},b),b&&g in b&&(D.style(a,b.style),delete b.style);for(var c in b)null===b[c]?(a.removeAttribute(c),delete b[c]):"className"==c&&(a[c]=b[c]);return e(a,b)},style:function(b,c){a(b).css(c||{})},unstyle:function(a,b){for(var d in b)d==h&&(d=c.support.cssFloat?i:j),a.style[d]="";""===a.style.cssText&&a.removeAttribute(g)},inlineStyle:function(b,c,e){var g,h=a(D.create(b.ownerDocument,c,e));return b.appendChild(h[0]),g=d(z,function(a){return f.msie&&"line-height"==a&&"1px"==h.css(a)?"line-height:1.5":a+":"+h.css(a)}).join(";"),h.remove(),g},getEffectiveBackground:function(a){var b=a.css("background-color");return b.indexOf("rgba(0, 0, 0, 0")<0&&"transparent"!==b?b:"html"===a[0].tagName.toLowerCase()?"Window":D.getEffectiveBackground(a.parent())},removeClass:function(b,c){var d,e,f=" "+b.className+" ",g=c.split(" ");for(d=0,e=g.length;e>d;d++)f=f.replace(" "+g[d]+" "," ");f=a.trim(f),f.length?b.className=f:b.removeAttribute(k)},commonAncestor:function(){var a,b,c,d,e,f=arguments.length,g=[],h=1/0,i=null;if(!f)return null;if(1==f)return arguments[0];for(a=0;f>a;a++){for(b=[],c=arguments[a];c;)b.push(c),c=c.parentNode;g.push(b.reverse()),h=Math.min(h,b.length)}if(1==f)return g[0][0];for(a=0;h>a;a++){for(d=g[0][a],e=1;f>e;e++)if(d!=g[e][a])return i;i=d}return i},closestSplittableParent:function(b){var c;c=1==b.length?D.parentOfType(b[0],["ul","ol"]):D.commonAncestor.apply(null,b),c||(c=D.parentOfType(b[0],["p","td"])||b[0].ownerDocument.body),D.isInline(c)&&(c=D.blockParentOrBody(c));var e=d(b,D.editableParent),f=D.commonAncestor(e)[0];return a.contains(c,f)&&(c=f),c},closestEditable:function(b,c){var d=D.parentOfType(b,c),e=D.editableParent(b);return d&&e&&a.contains(d,e)?d=e:!d&&e&&(d=e),d},closestEditableOfType:function(a,b){var c=D.closestEditable(a,b);return c&&D.ofType(c,b)?c:void 0},filter:function(a,b,c){for(var d,e=0,f=b.length,g=[];f>e;e++)d=D.name(b[e]),(!c&&d==a||c&&d!=a)&&g.push(b[e]);return g},ensureTrailingBreaks:function(b){var c=a(b).find("p,td,th"),d=c.length,e=0;if(d)for(;d>e;e++)D.ensureTrailingBreak(c[e]);else D.ensureTrailingBreak(b)},ensureTrailingBreak:function(a){var b,c=a.lastChild&&D.name(a.lastChild);(!c||"br"!=c&&"img"!=c)&&(b=a.ownerDocument.createElement("br"),b.setAttribute("_moz_dirty",!0),a.appendChild(b))}};c.ui.editor.Dom=D}(window.joy.jQuery),function(a,b){var c=window.joy,d=c.ui.editor,e=d.Dom,f=a.extend,g="xx-small,x-small,small,medium,large,x-large,xx-large".split(","),h=/"/g,i=/<br[^>]*>/i,j=/^\d+(\.\d*)?(px)?$/i,k=/<p><\/p>/i,l=/([\w|\-]+)\s*:\s*([^;]+);?/i,m=/^sizzle-\d+/i,n=/\s*onerror\s*=\s*(?:'|")?([^'">\s]*)(?:'|")?/i,o=document.createElement("div");o.innerHTML=" <hr>";var p=3===o.firstChild.nodeType;o=null;var q={toEditableHtml:function(a){return a=a||"",a.replace(/<!\[CDATA\[(.*)?\]\]>/g,"<!--[CDATA[$1]]-->").replace(/<script([^>]*)>(.*)?<\/script>/gi,"<telerik:script$1>$2</telerik:script>").replace(/<img([^>]*)>/gi,function(a){return a.replace(n,"")}).replace(/(<\/?img[^>]*>)[\r\n\v\f\t ]+/gi,"$1")},_fillEmptyElements:function(b){a(b).find("p").each(function(){if(/^\s*$/g.test(a(this).text())){for(var b=this;b.firstChild&&3!=b.firstChild.nodeType;)b=b.firstChild;1!=b.nodeType||e.empty[e.name(b)]||(b.innerHTML=c.ui.editor.emptyElementContent)}})},_removeSystemElements:function(b){a(".k-paste-container",b).remove()},_resetOrderedLists:function(a){var b,c,d,e=a.getElementsByTagName("ol");for(b=0;b<e.length;b++)c=e[b],d=c.getAttribute("start"),c.setAttribute("start",1),d?c.setAttribute("start",d):c.removeAttribute(d)},htmlToDom:function(b,d){var f=c.support.browser,g=f.msie,h=g&&f.version<9;if(b=q.toEditableHtml(b),h){b="<br/>"+b;var i="originalsrc",j="originalhref";b=b.replace(/href\s*=\s*(?:'|")?([^'">\s]*)(?:'|")?/,j+'="$1"'),b=b.replace(/src\s*=\s*(?:'|")?([^'">\s]*)(?:'|")?/,i+'="$1"')}return d.innerHTML=b,h?(e.remove(d.firstChild),a(d).find("telerik\\:script,script,link,img,a").each(function(){var a=this;a[j]&&(a.setAttribute("href",a[j]),a.removeAttribute(j)),a[i]&&(a.setAttribute("src",a[i]),a.removeAttribute(i))})):g&&(e.normalize(d),q._resetOrderedLists(d)),q._fillEmptyElements(d),q._removeSystemElements(d),a("table",d).addClass("k-table"),d},domToXhtml:function(c,d){function f(b){var c,d,f,g,i=a.trim,j=i(b).split(";"),k=j.length;for(c=0,k=j.length;k>c;c++)j[c].length&&(d=l.exec(j[c]),d&&(f=i(d[1].toLowerCase()),g=i(d[2]),"font-size-adjust"!=f&&"font-stretch"!=f&&(f.indexOf("color")>=0?g=e.toHex(g):f.indexOf("font")>=0?g=g.replace(h,"'"):/\burl\(/g.test(g)&&(g=g.replace(h,"")),s.push(f),s.push(":"),s.push(g),s.push(";"))))}function n(c){var d,g,h,i,k,l,n=[],o=c.attributes;if(e.is(c,"img")){var p=c.style.width,q=c.style.height,r=a(c);p&&j.test(p)&&(r.attr("width",parseInt(p,10)),e.unstyle(c,{width:b})),q&&j.test(q)&&(r.attr("height",parseInt(q,10)),e.unstyle(c,{height:b}))}for(g=0,h=o.length;h>g;g++)d=o[g],i=d.nodeName,k=d.nodeValue,l=d.specified,"value"==i&&"value"in c&&c.value?l=!0:"type"==i&&"text"==k?l=!0:"class"!=i||k?m.test(i)?l=!1:"complete"==i?l=!1:"altHtml"==i?l=!1:"start"==i&&(e.is(c,"ul")||e.is(c,"ol"))?l=!1:i.indexOf("_moz")>=0&&(l=!1):l=!1,l&&n.push(d);if(n.length)for(n.sort(function(a,b){return a.nodeName>b.nodeName?1:a.nodeName<b.nodeName?-1:0}),g=0,h=n.length;h>g;g++)d=n[g],i=d.nodeName,k=d.nodeValue,("contenteditable"!=i.toLowerCase()||!e.is(c,"table")&&!e.is(c,"td"))&&("class"!=i||"k-table"!=k)&&(s.push(" "),s.push(i),s.push('="'),"style"==i?f(k||c.style.cssText):s.push("src"==i||"href"==i?c.getAttribute(i,2):e.fillAttrs[i]?i:k),s.push('"'))}function o(a,b,c){for(var d=a.firstChild;d;d=d.nextSibling)r(d,b,c)}function q(a){return a.nodeValue.replace(/\ufeff/g,"")}function r(a,b,c){var f,g,h,i,j,k=a.nodeType;if(1==k){if(f=e.name(a),!f||e.insignificant(a))return;if(e.isInline(a)&&1==a.childNodes.length&&3==a.firstChild.nodeType&&!q(a.firstChild))return;if(g=t[f])return g.start(a),o(a,!1,g.skipEncoding),void g.end(a);s.push("<"),s.push(f),n(a),e.empty[f]?s.push(" />"):(s.push(">"),o(a,b||e.is(a,"pre")),s.push("</"),s.push(f),s.push(">"))}else 3==k?(i=q(a),!b&&p&&(h=a.parentNode,j=a.previousSibling,j||(j=(e.isInline(h)?h:a).previousSibling),(!j||""===j.innerHTML||e.isBlock(j))&&(i=i.replace(/^[\r\n\v\f\t ]+/,"")),i=i.replace(/ +/," ")),s.push(c?i:e.encode(i,d))):4==k?(s.push("<![CDATA["),s.push(a.data),s.push("]]>")):8==k&&(a.data.indexOf("[CDATA[")<0?(s.push("<!--"),s.push(a.data),s.push("-->")):(s.push("<!"),s.push(a.data),s.push(">")))}var s=[],t={"telerik:script":{start:function(a){s.push("<script"),n(a),s.push(">")},end:function(){s.push("</script>")},skipEncoding:!0},b:{start:function(){s.push("<strong>")},end:function(){s.push("</strong>")}},i:{start:function(){s.push("<em>")},end:function(){s.push("</em>")}},u:{start:function(){s.push('<span style="text-decoration:underline;">')},end:function(){
s.push("</span>")}},iframe:{start:function(a){s.push("<iframe"),n(a),s.push(">")},end:function(){s.push("</iframe>")}},font:{start:function(a){s.push('<span style="');var b=a.getAttribute("color"),c=g[a.getAttribute("size")],d=a.getAttribute("face");b&&(s.push("color:"),s.push(e.toHex(b)),s.push(";")),d&&(s.push("font-face:"),s.push(d),s.push(";")),c&&(s.push("font-size:"),s.push(c),s.push(";")),s.push('">')},end:function(){s.push("</span>")}}};return 1==c.childNodes.length&&3==c.firstChild.nodeType?e.encode(q(c.firstChild).replace(/[\r\n\v\f\t ]+/," "),d):(o(c),s=s.join(""),""===s.replace(i,"").replace(k,"")?"":s=s.replace(new RegExp("\r\n","gm"),""))}};f(d,{Serializer:q})}(window.joy.jQuery),function(a){function b(a,b,c,d){if(a==b)return d-c;for(var e=b;e&&e.parentNode!=a;)e=e.parentNode;if(e)return n(e)-c;for(e=a;e&&e.parentNode!=b;)e=e.parentNode;if(e)return d-n(e)-1;for(var f=m.commonAncestor(a,b),g=a;g&&g.parentNode!=f;)g=g.parentNode;g||(g=f);for(var h=b;h&&h.parentNode!=f;)h=h.parentNode;return h||(h=f),g==h?0:n(h)-n(g)}function c(a,c){function d(a){try{return b(a.startContainer,a.endContainer,a.startOffset,a.endOffset)<0}catch(c){return!0}}d(a)&&(c?(a.commonAncestorContainer=a.endContainer=a.startContainer,a.endOffset=a.startOffset):(a.commonAncestorContainer=a.startContainer=a.endContainer,a.startOffset=a.endOffset),a.collapsed=!0)}function d(a){a.collapsed=a.startContainer==a.endContainer&&a.startOffset==a.endOffset;for(var b=a.startContainer;b&&b!=a.endContainer&&!m.isAncestorOf(b,a.endContainer);)b=b.parentNode;a.commonAncestorContainer=b}function e(a){var b=a.duplicate(),c=a.duplicate();return b.collapse(!0),c.collapse(!1),m.commonAncestor(a.parentElement(),b.parentElement(),c.parentElement())}function f(a,b,c){var d,e=b[c?"startContainer":"endContainer"],f=b[c?"startOffset":"endOffset"],g=0,h=o(e),i=h?e:e.childNodes[f]||null,j=h?e.parentNode:e,k=b.ownerDocument,l=k.body.createTextRange();(3==e.nodeType||4==e.nodeType)&&(g=f),j||(j=k.body),"img"==j.nodeName.toLowerCase()?(l.moveToElementText(j),l.collapse(!1),a.setEndPoint(c?"StartToStart":"EndToStart",l)):(d=j.insertBefore(m.create(k,"a"),i),l.moveToElementText(d),m.remove(d),l[c?"moveStart":"moveEnd"]("character",g),l.collapse(!1),a.setEndPoint(c?"StartToStart":"EndToStart",l))}function g(a,b,c,d){var e,f,g,h,i,j,k,l=m.create(b.ownerDocument,"a"),p=a.duplicate(),q=d?"StartToStart":"StartToEnd";l.innerHTML="\ufeff",p.collapse(d),f=p.parentElement(),m.isAncestorOrSelf(c,f)||(f=c);do f.insertBefore(l,l.previousSibling),p.moveToElementText(l);while((e=p.compareEndPoints(q,a))>0&&l.previousSibling);g=l.nextSibling,-1==e&&o(g)?(p.setEndPoint(d?"EndToStart":"EndToEnd",a),m.remove(l),j=[g,p.text.length]):(h=!d&&l.previousSibling,i=d&&l.nextSibling,o(i)?j=[i,0]:o(h)?j=[h,h.length]:(k=n(l),j=f.nextSibling&&k==f.childNodes.length-1?[f.nextSibling,0]:[f,k]),m.remove(l)),b[d?"setStart":"setEnd"].apply(b,j)}var h=window.joy,i=h.Class,j=a.extend,k=h.ui.editor,l=h.support.browser,m=k.Dom,n=m.findNodeIndex,o=m.isDataNode,p=m.findClosestAncestor,q=m.getNodeLength,r=m.normalize,s={selectionFromWindow:function(a){return"getSelection"in a?a.getSelection():new v(a.document)},selectionFromRange:function(a){var b=A.documentFromRange(a);return s.selectionFromDocument(b)},selectionFromDocument:function(a){return s.selectionFromWindow(m.windowFromDocument(a))}},t=i.extend({init:function(b){a.extend(this,{ownerDocument:b,startContainer:b,endContainer:b,commonAncestorContainer:b,startOffset:0,endOffset:0,collapsed:!0})},setStart:function(a,b){this.startContainer=a,this.startOffset=b,d(this),c(this,!0)},setEnd:function(a,b){this.endContainer=a,this.endOffset=b,d(this),c(this,!1)},setStartBefore:function(a){this.setStart(a.parentNode,n(a))},setStartAfter:function(a){this.setStart(a.parentNode,n(a)+1)},setEndBefore:function(a){this.setEnd(a.parentNode,n(a))},setEndAfter:function(a){this.setEnd(a.parentNode,n(a)+1)},selectNode:function(a){this.setStartBefore(a),this.setEndAfter(a)},selectNodeContents:function(a){this.setStart(a,0),this.setEnd(a,a[1===a.nodeType?"childNodes":"nodeValue"].length)},collapse:function(a){var b=this;a?b.setEnd(b.startContainer,b.startOffset):b.setStart(b.endContainer,b.endOffset)},deleteContents:function(){var a=this,b=a.cloneRange();a.startContainer!=a.commonAncestorContainer&&a.setStartAfter(p(a.commonAncestorContainer,a.startContainer)),a.collapse(!0),function c(a){for(;a.next();)a.hasPartialSubtree()?c(a.getSubtreeIterator()):a.remove()}(new u(b))},cloneContents:function(){var a=A.documentFromRange(this);return function b(c){for(var d,e=a.createDocumentFragment();d=c.next();)d=d.cloneNode(!c.hasPartialSubtree()),c.hasPartialSubtree()&&d.appendChild(b(c.getSubtreeIterator())),e.appendChild(d);return e}(new u(this))},extractContents:function(){var a=this,b=a.cloneRange();a.startContainer!=a.commonAncestorContainer&&a.setStartAfter(p(a.commonAncestorContainer,a.startContainer)),a.collapse(!0);var c=A.documentFromRange(a);return function d(b){for(var e,f=c.createDocumentFragment();e=b.next();)b.hasPartialSubtree()?(e=e.cloneNode(!1),e.appendChild(d(b.getSubtreeIterator()))):b.remove(a.originalRange),f.appendChild(e);return f}(new u(b))},insertNode:function(a){var b=this;o(b.startContainer)?(b.startOffset!=b.startContainer.nodeValue.length&&m.splitDataNode(b.startContainer,b.startOffset),m.insertAfter(a,b.startContainer)):m.insertAt(b.startContainer,a,b.startOffset),b.setStart(b.startContainer,b.startOffset)},cloneRange:function(){return a.extend(new t(this.ownerDocument),{startContainer:this.startContainer,endContainer:this.endContainer,commonAncestorContainer:this.commonAncestorContainer,startOffset:this.startOffset,endOffset:this.endOffset,collapsed:this.collapsed,originalRange:this})},toString:function(){var a=this.startContainer.nodeName,b=this.endContainer.nodeName;return["#text"==a?this.startContainer.nodeValue:a,"(",this.startOffset,") : ","#text"==b?this.endContainer.nodeValue:b,"(",this.endOffset,")"].join("")}}),u=i.extend({init:function(b){if(a.extend(this,{range:b,_current:null,_next:null,_end:null}),!b.collapsed){var c=b.commonAncestorContainer;this._next=b.startContainer!=c||o(b.startContainer)?p(c,b.startContainer):b.startContainer.childNodes[b.startOffset],this._end=b.endContainer!=c||o(b.endContainer)?p(c,b.endContainer).nextSibling:b.endContainer.childNodes[b.endOffset]}},hasNext:function(){return!!this._next},next:function(){var a=this,b=a._current=a._next;return a._next=a._current&&a._current.nextSibling!=a._end?a._current.nextSibling:null,o(a._current)&&(a.range.endContainer==a._current&&(b=b.cloneNode(!0),b.deleteData(a.range.endOffset,b.length-a.range.endOffset)),a.range.startContainer==a._current&&(b=b.cloneNode(!0),b.deleteData(0,a.range.startOffset))),b},traverse:function(a){function b(){return d._current=d._next,d._next=d._current&&d._current.nextSibling!=d._end?d._current.nextSibling:null,d._current}for(var c,d=this;c=b();)d.hasPartialSubtree()?d.getSubtreeIterator().traverse(a):a(c);return c},remove:function(a){var b,c,d,e=this,f=e.range.startContainer==e._current,g=e.range.endContainer==e._current;if(o(e._current)&&(f||g))b=f?e.range.startOffset:0,c=g?e.range.endOffset:e._current.length,d=c-b,a&&(f||g)&&(e._current==a.startContainer&&b<=a.startOffset&&(a.startOffset-=d),e._current==a.endContainer&&c<=a.endOffset&&(a.endOffset-=d)),e._current.deleteData(b,d);else{var h=e._current.parentNode;if(a&&(e.range.startContainer==h||e.range.endContainer==h)){var i=n(e._current);h==a.startContainer&&i<=a.startOffset&&(a.startOffset-=1),h==a.endContainer&&i<a.endOffset&&(a.endOffset-=1)}m.remove(e._current)}},hasPartialSubtree:function(){return!o(this._current)&&(m.isAncestorOrSelf(this._current,this.range.startContainer)||m.isAncestorOrSelf(this._current,this.range.endContainer))},getSubtreeIterator:function(){var a=this,b=a.range.cloneRange();return b.selectNodeContents(a._current),m.isAncestorOrSelf(a._current,a.range.startContainer)&&b.setStart(a.range.startContainer,a.range.startOffset),m.isAncestorOrSelf(a._current,a.range.endContainer)&&b.setEnd(a.range.endContainer,a.range.endOffset),new u(b)}}),v=i.extend({init:function(a){this.ownerDocument=a,this.rangeCount=1},addRange:function(a){var b=this.ownerDocument.body.createTextRange();f(b,a,!1),f(b,a,!0),b.select()},removeAllRanges:function(){var a=this.ownerDocument.selection;"None"!=a.type&&a.empty()},getRangeAt:function(){var a,b,c,d=new t(this.ownerDocument),f=this.ownerDocument.selection;try{if(a=f.createRange(),b=a.item?a.item(0):a.parentElement(),b.ownerDocument!=this.ownerDocument)return d}catch(h){return d}if("Control"==f.type)d.selectNode(a.item(0));else{c=e(a),g(a,d,c,!0),g(a,d,c,!1),9==d.startContainer.nodeType&&d.setStart(d.endContainer,d.startOffset),9==d.endContainer.nodeType&&d.setEnd(d.startContainer,d.endOffset),0===a.compareEndPoints("StartToEnd",a)&&d.collapse(!1);var i=d.startContainer,j=d.endContainer,k=this.ownerDocument.body;if(!(d.collapsed||0!==d.startOffset||d.endOffset!=q(d.endContainer)||i==j&&o(i)&&i.parentNode==k)){for(var l=!1,m=!1;0===n(i)&&i==i.parentNode.firstChild&&i!=k;)i=i.parentNode,l=!0;for(;n(j)==q(j.parentNode)-1&&j==j.parentNode.lastChild&&j!=k;)j=j.parentNode,m=!0;i==k&&j==k&&l&&m&&(d.setStart(i,0),d.setEnd(j,q(k)))}}return d}}),w=i.extend({init:function(a){this.enumerate=function(){function b(a){if(m.is(a,"img")||3==a.nodeType&&(!m.isWhitespace(a)||"\ufeff"==a.nodeValue))c.push(a);else for(a=a.firstChild;a;)b(a),a=a.nextSibling}var c=[];return new u(a).traverse(b),c}}}),x=i.extend({init:function(a,b){var c=this;c.range=a,c.rootNode=A.documentFromRange(a),c.body=b||c.getEditable(a),"body"!=m.name(c.body)&&(c.rootNode=c.body),c.html=c.body.innerHTML,c.startContainer=c.nodeToPath(a.startContainer),c.endContainer=c.nodeToPath(a.endContainer),c.startOffset=c.offset(a.startContainer,a.startOffset),c.endOffset=c.offset(a.endContainer,a.endOffset)},index:function(a){for(var b=0,c=a.nodeType;a=a.previousSibling;){var d=a.nodeType;(3!=d||c!=d)&&b++,c=d}return b},getEditable:function(a){for(var b=a.commonAncestorContainer;b&&(3==b.nodeType||b.attributes&&!b.attributes.contentEditable);)b=b.parentNode;return b},restoreHtml:function(){this.body.innerHTML=this.html},offset:function(a,b){if(3==a.nodeType)for(;(a=a.previousSibling)&&3==a.nodeType;)b+=a.nodeValue.length;return b},nodeToPath:function(a){for(var b=[];a!=this.rootNode;)b.push(this.index(a)),a=a.parentNode;return b},toRangePoint:function(a,b,c,d){for(var e=this.rootNode,f=c.length,g=d;f--;)e=e.childNodes[c[f]];for(;3==e.nodeType&&e.nodeValue.length<g;)g-=e.nodeValue.length,e=e.nextSibling;a[b?"setStart":"setEnd"](e,g)},toRange:function(){var a=this,b=a.range.cloneRange();return a.toRangePoint(b,!0,a.startContainer,a.startOffset),a.toRangePoint(b,!1,a.endContainer,a.endOffset),b}}),y=i.extend({init:function(){this.caret=null},addCaret:function(a){var b=this;return b.caret=m.create(A.documentFromRange(a),"span",{className:"k-marker"}),a.insertNode(b.caret),a.selectNode(b.caret),b.caret},removeCaret:function(a){var b=this,c=b.caret.previousSibling,d=0;c&&(d=o(c)?c.nodeValue.length:n(c));var e=b.caret.parentNode,f=c?n(c):0;m.remove(b.caret),r(e);var g=e.childNodes[f];if(o(g))a.setStart(g,d);else if(g){var h=m.lastTextNode(g);h?a.setStart(h,h.nodeValue.length):a[c?"setStartAfter":"setStartBefore"](g)}else l.msie||e.innerHTML||(e.innerHTML='<br _moz_dirty="" />'),a.selectNodeContents(e);a.collapse(!0)},add:function(a,b){var c=this,d=a.collapsed&&!A.isExpandable(a),e=A.documentFromRange(a);b&&a.collapsed&&(c.addCaret(a),a=A.expand(a));var f=a.cloneRange();if(f.collapse(!1),c.end=m.create(e,"span",{className:"k-marker"}),f.insertNode(c.end),f=a.cloneRange(),f.collapse(!0),c.start=c.end.cloneNode(!0),f.insertNode(c.start),c._removeDeadMarkers(c.start,c.end),d){var g=e.createTextNode("\ufeff");m.insertAfter(g.cloneNode(),c.start),m.insertBefore(g,c.end)}return a.setStartBefore(c.start),a.setEndAfter(c.end),r(a.commonAncestorContainer),a},_removeDeadMarkers:function(a,b){a.previousSibling&&"\ufeff"==a.previousSibling.nodeValue&&m.remove(a.previousSibling),b.nextSibling&&"\ufeff"==b.nextSibling.nodeValue&&m.remove(b.nextSibling)},remove:function(a){var b,c,d,e=this,f=e.start,g=e.end;for(r(a.commonAncestorContainer);!f.nextSibling&&f.parentNode;)f=f.parentNode;for(;!g.previousSibling&&g.parentNode;)g=g.parentNode;b=f.previousSibling&&3==f.previousSibling.nodeType&&f.nextSibling&&3==f.nextSibling.nodeType,c=g.previousSibling&&3==g.previousSibling.nodeType&&g.nextSibling&&3==g.nextSibling.nodeType,d=b&&c,f=f.nextSibling,g=g.previousSibling;var h=!1,i=!1;if(f==e.end&&(i=!!e.start.previousSibling,f=g=e.start.previousSibling||e.end.nextSibling,h=!0),m.remove(e.start),m.remove(e.end),!f||!g)return a.selectNodeContents(a.commonAncestorContainer),void a.collapse(!0);var j=h?o(f)?f.nodeValue.length:f.childNodes.length:0,k=o(g)?g.nodeValue.length:g.childNodes.length;if(3==f.nodeType)for(;f.previousSibling&&3==f.previousSibling.nodeType;)f=f.previousSibling,j+=f.nodeValue.length;if(3==g.nodeType)for(;g.previousSibling&&3==g.previousSibling.nodeType;)g=g.previousSibling,k+=g.nodeValue.length;for(var l=n(f),p=f.parentNode,q=n(g),s=g.parentNode,t=f;t.previousSibling;t=t.previousSibling)3==t.nodeType&&3==t.previousSibling.nodeType&&l--;for(var u=g;u.previousSibling;u=u.previousSibling)3==u.nodeType&&3==u.previousSibling.nodeType&&q--;r(p),3==f.nodeType&&(f=p.childNodes[l]),r(s),3==g.nodeType&&(g=s.childNodes[q]),h?(3==f.nodeType?a.setStart(f,j):a[i?"setStartAfter":"setStartBefore"](f),a.collapse(!0)):(3==f.nodeType?a.setStart(f,j):a.setStartBefore(f),3==g.nodeType?a.setEnd(g,k):a.setEndAfter(g)),e.caret&&e.removeCaret(a)}}),z=/[\u0009-\u000d]|\u0020|\u00a0|\ufeff|\.|,|;|:|!|\(|\)|\?/,A={nodes:function(a){var b=A.textNodes(a);return b.length||(a.selectNodeContents(a.commonAncestorContainer),b=A.textNodes(a),b.length||(b=m.significantChildNodes(a.commonAncestorContainer))),b},textNodes:function(a){return new w(a).enumerate()},documentFromRange:function(a){var b=a.startContainer;return 9==b.nodeType?b:b.ownerDocument},createRange:function(a){return l.msie&&l.version<9?new t(a):a.createRange()},selectRange:function(a){var b=A.image(a);b&&(a.setStartAfter(b),a.setEndAfter(b));var c=s.selectionFromRange(a);c.removeAllRanges(),c.addRange(a)},stringify:function(a){return h.format("{0}:{1} - {2}:{3}",m.name(a.startContainer),a.startOffset,m.name(a.endContainer),a.endOffset)},split:function(a,b,c){function d(d){var e=a.cloneRange();e.collapse(d),e[d?"setStartBefore":"setEndAfter"](b);var f=e.extractContents();c&&(f=m.trim(f)),m[d?"insertBefore":"insertAfter"](f,b)}d(!0),d(!1)},getMarkers:function(a){var b=[];return new u(a).traverse(function(a){"k-marker"==a.className&&b.push(a)}),b},image:function(a){var b=[];return new u(a).traverse(function(a){m.is(a,"img")&&b.push(a)}),1==b.length?b[0]:void 0},expand:function(a){var b=a.cloneRange(),c=b.startContainer.childNodes[0===b.startOffset?0:b.startOffset-1],d=b.endContainer.childNodes[b.endOffset];if(!o(c)||!o(d))return b;var e=c.nodeValue,f=d.nodeValue;if(!e||!f)return b;var g=e.split("").reverse().join("").search(z),h=f.search(z);return g&&h?(h=-1==h?f.length:h,g=-1==g?0:e.length-g,b.setStart(c,g),b.setEnd(d,h),b):b},isExpandable:function(a){var b=a.startContainer,c=A.documentFromRange(a);if(b==c||b==c.body)return!1;var d=a.cloneRange(),e=b.nodeValue;if(!e)return!1;var f=e.substring(0,d.startOffset),g=e.substring(d.startOffset),h=0,i=0;return f&&(h=f.split("").reverse().join("").search(z)),g&&(i=g.search(z)),h&&i}};j(k,{SelectionUtils:s,W3CRange:t,RangeIterator:u,W3CSelection:v,RangeEnumerator:w,RestorePoint:x,Marker:y,RangeUtils:A})}(window.joy.jQuery),function(a){var b=window.joy,c=b.Class,d=b.ui.editor,e=d.EditorUtils,f=e.registerTool,g=d.Dom,h=d.Tool,i=d.ToolTemplate,j=d.RestorePoint,k=d.Marker,l=a.extend,m=c.extend({init:function(a){this.options=a,this.restorePoint=new j(a.range),this.marker=new k,this.formatter=a.formatter},getRange:function(){return this.restorePoint.toRange()},lockRange:function(a){return this.marker.add(this.getRange(),a)},releaseRange:function(a){this.marker.remove(a),this.editor.selectRange(a)},undo:function(){var a=this.restorePoint;a.restoreHtml(),this.editor.selectRange(a.toRange())},redo:function(){this.exec()},createDialog:function(c,d){var e=this.editor;return a(c).appendTo(document.body).joyWindow(l({},e.options.dialogOptions,d)).closest(".k-window").toggleClass("k-rtl",b.support.isRtl(e.wrapper)).end()},exec:function(){var a=this.lockRange(!0);this.formatter.editor=this.editor,this.formatter.toggle(a),this.releaseRange(a)}}),n=c.extend({init:function(a,b){this.body=a.body,this.startRestorePoint=a,this.endRestorePoint=b},redo:function(){this.body.innerHTML=this.endRestorePoint.html,this.editor.selectRange(this.endRestorePoint.toRange())},undo:function(){this.body.innerHTML=this.startRestorePoint.html,this.editor.selectRange(this.startRestorePoint.toRange())}}),o=m.extend({init:function(a){m.fn.init.call(this,a),this.managesUndoRedo=!0},exec:function(){var a=this.editor,b=this.options,c=b.range,d=a.body,e=new j(c,d),f=b.html||b.value||"";a.selectRange(c),a.clipboard.paste(f,b),b.postProcess&&b.postProcess(a,a.getRange());var g=new n(e,new j(a.getRange(),d));g.editor=a,a.undoRedoStack.push(g),a.focus()}}),p=h.extend({initialize:function(a,b){var c=b.editor,e=this.options,f=e.items?e.items:c.options.insertHtml;new d.SelectBox(a,{dataSource:f,dataTextField:"text",dataValueField:"value",change:function(){h.exec(c,"insertHtml",this.value())},title:c.options.messages.insertHtml,highlightFirst:!1})},command:function(a){return new o(a)},update:function(a){var b=a.data("joySelectBox")||a.find("select").data("joySelectBox");b.close(),b.value(b.options.title)}}),q=c.extend({init:function(){this.stack=[],this.currentCommandIndex=-1},push:function(a){this.stack=this.stack.slice(0,this.currentCommandIndex+1),this.currentCommandIndex=this.stack.push(a)-1},undo:function(){this.canUndo()&&this.stack[this.currentCommandIndex--].undo()},redo:function(){this.canRedo()&&this.stack[++this.currentCommandIndex].redo()},canUndo:function(){return this.currentCommandIndex>=0},canRedo:function(){return this.currentCommandIndex!=this.stack.length-1}}),r=c.extend({init:function(a){this.editor=a},keydown:function(b){var c=this,d=c.editor,e=d.keyboard,f=e.isTypingKey(b),g=l(a.Event(),b);if(c.editor.trigger("keydown",g),g.isDefaultPrevented()&&b.preventDefault(),!g.isDefaultPrevented()&&f&&!e.isTypingInProgress()){var h=d.getRange();return c.startRestorePoint=new j(h),e.startTyping(function(){d.selectionRestorePoint=c.endRestorePoint=new j(d.getRange());var a=new n(c.startRestorePoint,c.endRestorePoint);a.editor=d,d.undoRedoStack.push(a)}),!0}return!1},keyup:function(a){var b=this.editor.keyboard;return this.editor.trigger("keyup",a),b.isTypingInProgress()?(b.endTyping(),!0):!1}}),s=c.extend({init:function(a){this.editor=a,this.systemCommandIsInProgress=!1},createUndoCommand:function(){var a=this;a.endRestorePoint=new j(a.editor.getRange());var b=new n(a.startRestorePoint,a.endRestorePoint);b.editor=a.editor,a.editor.undoRedoStack.push(b),a.startRestorePoint=a.endRestorePoint},changed:function(){return this.startRestorePoint?this.startRestorePoint.html!=this.editor.body.innerHTML:!1},keydown:function(a){var b=this,c=b.editor,d=c.keyboard;return d.isModifierKey(a)?(d.isTypingInProgress()&&d.endTyping(!0),b.startRestorePoint=new j(c.getRange()),!0):d.isSystem(a)?(b.systemCommandIsInProgress=!0,b.changed()&&(b.systemCommandIsInProgress=!1,b.createUndoCommand()),!0):!1},keyup:function(a){var b=this;return b.systemCommandIsInProgress&&b.changed()?(b.systemCommandIsInProgress=!1,b.createUndoCommand(a),!0):!1}}),t=c.extend({init:function(a){this.handlers=a,this.typingInProgress=!1},isCharacter:function(a){return a>=48&&90>=a||a>=96&&111>=a||a>=186&&192>=a||a>=219&&222>=a||229==a},toolFromShortcut:function(b,c){var d,e,f=String.fromCharCode(c.keyCode);for(d in b)if(e=a.extend({ctrl:!1,alt:!1,shift:!1},b[d].options),(e.key==f||e.key==c.keyCode)&&e.ctrl==c.ctrlKey&&e.alt==c.altKey&&e.shift==c.shiftKey)return d},isTypingKey:function(a){var b=a.keyCode;return this.isCharacter(b)&&!a.ctrlKey&&!a.altKey||32==b||13==b||8==b||46==b&&!a.shiftKey&&!a.ctrlKey&&!a.altKey},isModifierKey:function(a){var b=a.keyCode;return 17==b&&!a.shiftKey&&!a.altKey||16==b&&!a.ctrlKey&&!a.altKey||18==b&&!a.ctrlKey&&!a.shiftKey},isSystem:function(a){return 46==a.keyCode&&a.ctrlKey&&!a.altKey&&!a.shiftKey},startTyping:function(a){this.onEndTyping=a,this.typingInProgress=!0},stopTyping:function(){this.typingInProgress=!1,this.onEndTyping&&this.onEndTyping()},endTyping:function(b){var c=this;c.clearTimeout(),b?c.stopTyping():c.timeout=window.setTimeout(a.proxy(c.stopTyping,c),1e3)},isTypingInProgress:function(){return this.typingInProgress},clearTimeout:function(){window.clearTimeout(this.timeout)},notify:function(a,b){var c,d=this.handlers;for(c=0;c<d.length&&!d[c][b](a);c++);},keydown:function(a){this.notify(a,"keydown")},keyup:function(a){this.notify(a,"keyup")}}),u=c.extend({init:function(a){this.editor=a,this.cleaners=[new w,new x,new y]},htmlToFragment:function(a){var b=this.editor,c=b.document,d=g.create(c,"div"),e=c.createDocumentFragment();for(d.innerHTML=a;d.firstChild;)e.appendChild(d.firstChild);return e},isBlock:function(a){return/<(div|p|ul|ol|table|h[1-6])/i.test(a)},_contentModification:function(a,b){var c,d,e=this,f=e.editor;e._inProgress||(e._inProgress=!0,c=f.getRange(),d=new j(c),g.persistScrollTop(f.document),a.call(e,f,c),setTimeout(function(){b.call(e,f,c);var a=new j(f.getRange()),g=new n(d,a);g.editor=f,f.undoRedoStack.push(g),f._selectionChange(),e._inProgress=!1}))},oncut:function(){this._contentModification(a.noop,a.noop)},onpaste:function(c){this._contentModification(function(b,d){var e=g.create(b.document,"div",{className:"k-paste-container",innerHTML:"\ufeff"});if(b.body.appendChild(e),b.body.createTextRange){c.preventDefault();var f=b.createRange();f.selectNodeContents(e),b.selectRange(f);var h=b.body.createTextRange();h.moveToElementText(e),a(b.body).unbind("paste"),h.execCommand("Paste"),a(b.body).bind("paste",a.proxy(this.onpaste,this))}else{var i=b.createRange();i.selectNodeContents(e),b.selectRange(i)}d.deleteContents()},function(c,d){{var e,f="",h={html:""};b.support.browser}c.selectRange(d),e=a(c.body).children(".k-paste-container"),e.each(function(){var a=this.lastChild;a&&g.is(a,"br")&&g.remove(a),f+=this.innerHTML}),e.remove(),f=f.replace(/\ufeff/g,""),h.html=f,c.trigger("paste",h),c.clipboard.paste(h.html,{clean:!0})})},splittableParent:function(a,b){var c,d;if(a)return g.closestEditableOfType(b,["p","ul","ol"])||b.parentNode;if(c=b.parentNode,d=b.ownerDocument.body,g.isInline(c))for(;c.parentNode!=d&&!g.isBlock(c.parentNode);)c=c.parentNode;return c},paste:function(b,c){var e,f,h=this.editor;for(c=l({clean:!1,split:!0},c),e=0,f=this.cleaners.length;f>e;e++)this.cleaners[e].applicable(b)&&(b=this.cleaners[e].clean(b));c.clean&&(b=b.replace(/(<br>(\s|&nbsp;)*)+(<\/?(div|p|li|col|t))/gi,"$3"),b=b.replace(/<(a|span)[^>]*><\/\1>/gi,"")),b=b.replace(/^<li/i,"<ul><li").replace(/li>$/g,"li></ul>");var i=this.isBlock(b);h.focus();var j=h.getRange();j.deleteContents(),j.startContainer==h.document&&j.selectNodeContents(h.body);var m=new k,n=m.addCaret(j),o=this.splittableParent(i,n),p=!1,q=o!=h.body&&!g.is(o,"td");c.split&&q&&(i||g.isInline(o))&&(j.selectNode(n),d.RangeUtils.split(j,o,!0),p=!0);var r=this.htmlToFragment(b);if(r.firstChild&&"k-paste-container"===r.firstChild.className){var s=[];for(e=0,f=r.childNodes.length;f>e;e++)s.push(r.childNodes[e].innerHTML);r=this.htmlToFragment(s.join("<br />"))}if(a(r.childNodes).filter("table").addClass("k-table").end().find("table").addClass("k-table"),j.insertNode(r),o=this.splittableParent(i,n),p){for(;n.parentNode!=o;)g.unwrap(n.parentNode);g.unwrap(n.parentNode)}g.normalize(j.commonAncestorContainer),n.style.display="inline",g.restoreScrollTop(h.document),g.scrollTo(n),m.removeCaret(j),h.selectRange(j)}}),v=c.extend({clean:function(a){var b,c,d=this,e=d.replacements;for(b=0,c=e.length;c>b;b+=2)a=a.replace(e[b],e[b+1]);return a}}),w=v.extend({init:function(){this.replacements=[/<(\/?)script([^>]*)>/i,"<$1telerik:script$2>"]},applicable:function(a){return/<script[^>]*>/i.test(a)}}),x=v.extend({init:function(){this.replacements=[/<\?xml[^>]*>/gi,"",/<!--(.|\n)*?-->/g,"",/&quot;/g,"'",/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6]|hr|p|div|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|address|pre|form|blockquote|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g,"$1",/<br><br>/g,"<BR><BR>",/<br>(?!\n)/g," ",/<table([^>]*)>(\s|&nbsp;)+<t/gi,"<table$1><t",/<tr[^>]*>(\s|&nbsp;)*<\/tr>/gi,"",/<tbody[^>]*>(\s|&nbsp;)*<\/tbody>/gi,"",/<table[^>]*>(\s|&nbsp;)*<\/table>/gi,"",/<BR><BR>/g,"<br>",/^\s*(&nbsp;)+/gi,"",/(&nbsp;|<br[^>]*>)+\s*$/gi,"",/mso-[^;"]*;?/gi,"",/<(\/?)b(\s[^>]*)?>/gi,"<$1strong$2>",/<(\/?)i(\s[^>]*)?>/gi,"<$1em$2>",/<o:p>&nbsp;<\/o:p>/gi,"&nbsp;",/<\/?(meta|link|style|o:|v:|x:)[^>]*>((?:.|\n)*?<\/(meta|link|style|o:|v:|x:)[^>]*>)?/gi,"",/<\/o>/g,"",/style=(["|'])\s*\1/g,"",/(<br[^>]*>)?\n/g,function(a,b){return b?a:" "}]},applicable:function(a){return/class="?Mso|style="[^"]*mso-/i.test(a)},stripEmptyAnchors:function(a){return a.replace(/<a([^>]*)>\s*<\/a>/gi,function(a,b){return!b||b.indexOf("href")<0?"":a})},listType:function(a){var b;return/^(<span [^>]*texhtml[^>]*>)?<span [^>]*(Symbol|Wingdings)[^>]*>/i.test(a)&&(b=!0),a=a.replace(/<\/?\w+[^>]*>/g,"").replace(/&nbsp;/g," "),!b&&/^[\u2022\u00b7\u00a7\u00d8o]\u00a0+/.test(a)||b&&/^.\u00a0+/.test(a)?"ul":/^\s*\w+[\.\)]\u00a0{2,}/.test(a)?"ol":void 0},lists:function(b){var c,d,e,f,h,i,j,k,l,m=a(g.blockElements.join(","),b),n=-1,o={ul:{},ol:{}},p=b;for(e=0;e<m.length;e++)if(f=m[e],h=this.listType(f.innerHTML),d=g.name(f),"td"!=d)if(h&&"p"==d){if(i=parseFloat(f.style.marginLeft||0),j=o[h][i],(i>n||!j)&&(j=g.create(document,h),p==b?g.insertBefore(j,f):p.appendChild(j),o[h][i]=j),c!=h)for(k in o)for(l in o[k])a.contains(j,o[k][l])&&delete o[k][l];g.remove(f.firstChild),p=g.create(document,"li",{innerHTML:f.innerHTML}),j.appendChild(p),g.remove(f),n=i,c=h}else f.innerHTML?(o={ul:{},ol:{}},p=b,n=-1):g.remove(f)},removeAttributes:function(a){for(var b=a.attributes,c=b.length;c--;)"colspan"!=g.name(b[c])&&a.removeAttributeNode(b[c])},createColGroup:function(c){var d=c.cells,e=a(c).closest("table"),f=e.children("colgroup");d.length<2||(f.length&&(d=f.children(),f[0].parentNode.removeChild(f[0])),f=a(a.map(d,function(a){var c=a.width;return c&&0!==parseInt(c,10)?b.format('<col style="width:{0}px;"/>',c):"<col />"}).join("")),f.is("colgroup")||(f=a("<colgroup/>").append(f)),f.prependTo(e))},convertHeaders:function(b){var c,d=b.cells,e=a.map(d,function(b){var c=a(b).children("p").children("strong")[0];return c&&"strong"==g.name(c)?c:void 0});if(e.length==d.length){for(c=0;c<e.length;c++)g.unwrap(e[c]);for(a(b).closest("table").find("colgroup").after("<thead></thead>").end().find("thead").append(b),c=0;c<d.length;c++)g.changeTag(d[c],"th")}},removeParagraphs:function(b){var c,d,e,f,h;for(c=0;c<b.length;c++)for(this.removeAttributes(b[c]),f=a(b[c]),h=f.children("p"),d=0,e=h.length;e>d;d++)e-1>d&&g.insertAfter(g.create(document,"br"),h[d]),g.unwrap(h[d])},removeDefaultColors:function(a){for(var b=0;b<a.length;b++)/^\s*color:\s*[^;]*;?$/i.test(a[b].style.cssText)&&g.unwrap(a[b])},tables:function(b){var c,d,e,f,g,h=a(b).find("table"),i=this;for(f=0;f<h.length;f++){for(c=h[f].rows,e=d=c[0],g=1;g<c.length;g++)c[g].cells.length>e.cells.length&&(e=c[g]);i.createColGroup(e),i.convertHeaders(d),i.removeAttributes(h[f]),i.removeParagraphs(h.eq(f).find("td,th")),i.removeDefaultColors(h.eq(f).find("span"))}},clean:function(a){var b,c=this;return a=v.fn.clean.call(c,a),a=c.stripEmptyAnchors(a),b=g.create(document,"div",{innerHTML:a}),c.lists(b),c.tables(b),a=b.innerHTML.replace(/(<[^>]*)\s+class="?[^"\s>]*"?/gi,"$1")}}),y=v.extend({init:function(){this.replacements=[/\s+class="Apple-style-span[^"]*"/gi,"",/<(div|p|h[1-6])\s+style="[^"]*"/gi,"<$1",/^<div>(.*)<\/div>$/,"$1"]},applicable:function(a){return/class="?Apple-style-span|style="[^"]*-webkit-nbsp-mode/i.test(a)}});l(d,{Command:m,GenericCommand:n,InsertHtmlCommand:o,InsertHtmlTool:p,UndoRedoStack:q,TypingHandler:r,SystemHandler:s,Keyboard:t,Clipboard:u,Cleaner:v,MSWordFormatCleaner:x,WebkitFormatCleaner:y}),f("insertHtml",new p({template:new i({template:e.dropDownListTemplate,title:"Insert HTML",initialValue:"Insert HTML"})}))}(window.joy.jQuery),function(a){var b=window.joy,c=b.Class,d=b.ui.editor,e=b.ui.Editor.fn.options.formats,f=d.EditorUtils,g=d.Tool,h=d.ToolTemplate,i=d.FormatTool,j=d.Dom,k=d.RangeUtils,l=a.extend,m=d.EditorUtils.registerTool,n=d.EditorUtils.registerFormat,o="k-marker",p=c.extend({init:function(a){this.format=a},numberOfSiblings:function(a){var b,c=0,d=0,e=0,f=a.parentNode;for(b=f.firstChild;b;b=b.nextSibling)b!=a&&(b.className==o?e++:3==b.nodeType?c++:d++);return e>1&&f.firstChild.className==o&&f.lastChild.className==o?0:d+c},findSuitable:function(a,b){return!b&&this.numberOfSiblings(a)>0?null:j.parentOfType(a,this.format[0].tags)},findFormat:function(a){var b,c,d,e,f,g=this.format,h=j.attrEquals;for(b=0,c=g.length;c>b;b++){if(d=a,e=g[b].tags,f=g[b].attr,d&&j.ofType(d,e)&&h(d,f))return d;for(;d;)if(d=j.parentOfType(d,e),d&&h(d,f))return d}return null},isFormatted:function(a){var b,c;for(b=0,c=a.length;c>b;b++)if(this.findFormat(a[b]))return!0;return!1}}),q=c.extend({init:function(a,b){var c=this;c.finder=new p(a),c.attributes=l({},a[0].attr,b),c.tag=a[0].tags[0]},wrap:function(a){return j.wrap(a,j.create(a.ownerDocument,this.tag,this.attributes))},activate:function(a,b){var c=this;c.finder.isFormatted(b)?(c.split(a),c.remove(b)):c.apply(b)},toggle:function(a){var b=k.textNodes(a);b.length>0&&this.activate(a,b)},apply:function(a){var b,c,d,e,f=this,g=[];for(b=0,c=a.length;c>b;b++)d=a[b],e=f.finder.findSuitable(d),e?j.attr(e,f.attributes):e=f.wrap(d),g.push(e);f.consolidate(g)},remove:function(a){var b,c,d,e=this;for(b=0,c=a.length;c>b;b++)d=e.finder.findFormat(a[b]),d&&(e.attributes&&e.attributes.style?(j.unstyle(d,e.attributes.style),d.style.cssText||d.attributes["class"]||j.unwrap(d)):j.unwrap(d))},split:function(a){var b,c,d=k.textNodes(a),e=d.length;if(e>0)for(b=0;e>b;b++)c=this.finder.findFormat(d[b]),c&&k.split(a,c,!0)},consolidate:function(a){for(var b,c;a.length>1;)if(b=a.pop(),c=a[a.length-1],b.previousSibling&&b.previousSibling.className==o&&c.appendChild(b.previousSibling),b.tagName==c.tagName&&b.previousSibling==c&&b.style.cssText==c.style.cssText){for(;b.firstChild;)c.appendChild(b.firstChild);j.remove(b)}}}),r=p.extend({init:function(a,b){var c=this;c.format=a,c.greedyProperty=b,p.fn.init.call(c,a)},getInlineCssValue:function(b){var c,d,e,f,g,h,i,k,l,m,n,o,p=b.attributes,q=a.trim;if(p)for(c=0,d=p.length;d>c;c++)if(e=p[c],f=e.nodeName,g=e.nodeValue,e.specified&&"style"==f)for(h=q(g||b.style.cssText).split(";"),k=0,l=h.length;l>k;k++)if(i=h[k],i.length){if(m=i.split(":"),n=q(m[0].toLowerCase()),o=q(m[1]),n!=this.greedyProperty)continue;return n.indexOf("color")>=0?j.toHex(o):o}},getFormatInner:function(b){var c,d,e,f=a(j.isDataNode(b)?b.parentNode:b),g=f.parentsUntil("[contentEditable]").addBack();for(c=0,d=g.length;d>c;c++)if(e="className"==this.greedyProperty?g[c].className:this.getInlineCssValue(g[c]))return e;return"inherit"},getFormat:function(a){var b,c,d=this.getFormatInner(a[0]);for(b=1,c=a.length;c>b;b++)if(d!=this.getFormatInner(a[b]))return"";return d},isFormatted:function(a){return""!==this.getFormat(a)}}),s=q.extend({init:function(a,c,d){q.fn.init.call(this,a,c),this.values=c,this.finder=new r(a,d),d&&(this.greedyProperty=b.toCamelCase(d))},activate:function(a,b){var c=this.greedyProperty,d="apply";this.split(a),c&&"inherit"==this.values.style[c]&&(d="remove"),this[d](b)}}),t=i.extend({init:function(a){i.fn.init.call(this,l(a,{finder:new p(a.format),formatter:function(){
return new q(a.format)}}))}}),u=g.extend({update:function(a,b){var c=a.data(this.type);c.close(),c.value(this.finder.getFormat(b))}}),v=u.extend({init:function(a){var c=this;g.fn.init.call(c,a),c.type=b.support.browser.msie||b.support.touch?"joyDropDownList":"joyComboBox",c.format=[{tags:["span"]}],c.finder=new r(c.format,a.cssAttr)},command:function(a){var b=this.options,c=this.format,e={};return new d.FormatCommand(l(a,{formatter:function(){return e[b.domAttr]=a.value,new s(c,{style:e},b.cssAttr)}}))},initialize:function(a,b){var c,d=b.editor,e=this.options,f=e.name,h=[];e.defaultValue&&(h=[{text:d.options.messages[e.defaultValue[0].text],value:e.defaultValue[0].value}]),c=h.concat(e.items?e.items:d.options[f]),a[this.type]({dataTextField:"text",dataValueField:"value",dataSource:c,change:function(){g.exec(d,f,this.value())},highlightFirst:!1}),a.closest(".k-widget").removeClass("k-"+f).find("*").addBack().attr("unselectable","on"),a.data(this.type).value("inherit")}}),w=g.extend({init:function(a){g.fn.init.call(this,a),this.format=[{tags:["span"]}],this.finder=new r(this.format,a.cssAttr)},options:{palette:"websafe"},update:function(){this._widget.close()},command:function(a){var b=this.options,c=this.format,e={};return new d.FormatCommand(l(a,{formatter:function(){return e[b.domAttr]=a.value,new s(c,{style:e},b.cssAttr)}}))},initialize:function(c,d){var e=d.editor,f=this.name,h=l({},w.fn.options,this.options),i=h.palette;c=this._widget=new b.ui.ColorPicker(c,{value:a.isArray(i)?i[0]:"#000",toolIcon:"k-"+h.name,palette:i,change:function(){var a=c.value();a&&g.exec(e,f,a),e.focus()},activate:function(a){a.preventDefault(),c.trigger("change")}}),c.wrapper.attr({title:d.title,unselectable:"on"}).find("*").attr("unselectable","on")}});l(d,{InlineFormatFinder:p,InlineFormatter:q,DelayedExecutionTool:u,GreedyInlineFormatFinder:r,GreedyInlineFormatter:s,InlineFormatTool:t,FontTool:v,ColorTool:w}),n("bold",[{tags:["strong","b"]},{tags:["span"],attr:{style:{fontWeight:"bold"}}}]),m("bold",new t({key:"B",ctrl:!0,format:e.bold,template:new h({template:f.buttonTemplate,title:"Bold"})})),n("italic",[{tags:["em","i"]},{tags:["span"],attr:{style:{fontStyle:"italic"}}}]),m("italic",new t({key:"I",ctrl:!0,format:e.italic,template:new h({template:f.buttonTemplate,title:"Italic"})})),n("underline",[{tags:["span"],attr:{style:{textDecoration:"underline"}}},{tags:["u"]}]),m("underline",new t({key:"U",ctrl:!0,format:e.underline,template:new h({template:f.buttonTemplate,title:"Underline"})})),n("strikethrough",[{tags:["del","strike"]},{tags:["span"],attr:{style:{textDecoration:"line-through"}}}]),m("strikethrough",new t({format:e.strikethrough,template:new h({template:f.buttonTemplate,title:"Strikethrough"})})),n("superscript",[{tags:["sup"]}]),m("superscript",new t({format:e.superscript,template:new h({template:f.buttonTemplate,title:"Superscript"})})),n("subscript",[{tags:["sub"]}]),m("subscript",new t({format:e.subscript,template:new h({template:f.buttonTemplate,title:"Subscript"})})),m("foreColor",new w({cssAttr:"color",domAttr:"color",name:"foreColor",template:new h({template:f.colorPickerTemplate,title:"Color"})})),m("backColor",new w({cssAttr:"background-color",domAttr:"backgroundColor",name:"backColor",template:new h({template:f.colorPickerTemplate,title:"Background Color"})})),m("fontName",new v({cssAttr:"font-family",domAttr:"fontFamily",name:"fontName",defaultValue:[{text:"fontNameInherit",value:"inherit"}],template:new h({template:f.comboBoxTemplate,title:"Font Name"})})),m("fontSize",new v({cssAttr:"font-size",domAttr:"fontSize",name:"fontSize",defaultValue:[{text:"fontSizeInherit",value:"inherit"}],template:new h({template:f.comboBoxTemplate,title:"Font Size"})}))}(window.joy.jQuery),function(a){var b=window.joy,c=b.Class,d=a.extend,e=b.ui.editor,f=b.ui.Editor.fn.options.formats,g=e.Dom,h=e.Command,i=e.ToolTemplate,j=e.FormatTool,k=e.EditorUtils,l=k.registerTool,m=k.registerFormat,n=e.RangeUtils,o=c.extend({init:function(a){this.format=a},contains:function(a,b){var c,d,e;for(c=0,d=b.length;d>c;c++)if(e=b[c],!e||!g.isAncestorOrSelf(a,e))return!1;return!0},findSuitable:function(b){var c,d,e,f=this.format,h=[];for(c=0,d=b.length;d>c;c++){for(var i=f.length-1;i>=0&&!(e=g.ofType(b[c],f[i].tags)?b[c]:g.parentOfType(b[c],f[i].tags));i--);if(!e||"true"===e.contentEditable)return[];a.inArray(e,h)<0&&h.push(e)}for(c=0,d=h.length;d>c;c++)if(this.contains(h[c],h))return[h[c]];return h},findFormat:function(a){var b,c,d,e,f,h=this.format;for(b=0,c=h.length;c>b;b++)for(d=a,e=h[b].tags,f=h[b].attr;d;){if(g.ofType(d,e)&&g.attrEquals(d,f))return d;d=d.parentNode}return null},getFormat:function(a){var b,c,d=this,e=function(a){return d.findFormat(g.isDataNode(a)?a.parentNode:a)},f=e(a[0]);if(!f)return"";for(b=1,c=a.length;c>b;b++)if(f!=e(a[b]))return"";return f.nodeName.toLowerCase()},isFormatted:function(a){for(var b=0,c=a.length;c>b;b++)if(!this.findFormat(a[b]))return!1;return!0}}),p=c.extend({init:function(a,b){this.format=a,this.values=b,this.finder=new o(a)},wrap:function(a,b,c){var d=1==c.length?g.blockParentOrBody(c[0]):g.commonAncestor.apply(null,c);g.isInline(d)&&(d=g.blockParentOrBody(d));var e,f,h=g.significantChildNodes(d),i=g.findNodeIndex(h[0]),j=g.create(d.ownerDocument,a,b);for(e=0;e<h.length;e++)f=h[e],g.isBlock(f)?(g.attr(f,b),j.childNodes.length&&(g.insertBefore(j,f),j=j.cloneNode(!1)),i=g.findNodeIndex(f)+1):j.appendChild(f);j.firstChild&&g.insertAt(d,j,i)},apply:function(b){function c(a){return d({},a&&a.attr,f)}var e,f=this.values,h=g.filter("img",b),i=k.formatByName("img",this.format),j=c(i);if(a.each(h,function(){g.attr(this,j)}),h.length!=b.length){var l=g.filter("img",b,!0),m=this.finder.findSuitable(l);if(m.length)for(var n=0,o=m.length;o>n;n++)e=k.formatByName(g.name(m[n]),this.format),g.attr(m[n],c(e));else e=this.format[0],this.wrap(e.tags[0],c(e),l)}},remove:function(a){var b,c,d,e,f;for(b=0,c=a.length;c>b;b++)d=this.finder.findFormat(a[b]),d&&(f=g.name(d),"div"!=f||d.getAttribute("class")?(e=k.formatByName(f,this.format),e.attr.style&&g.unstyle(d,e.attr.style),e.attr.className&&g.removeClass(d,e.attr.className)):g.unwrap(d))},toggle:function(a){var b=this,c=n.nodes(a);b.finder.isFormatted(c)?b.remove(c):b.apply(c)}}),q=c.extend({init:function(a,b){var c=this;c.format=a,c.values=b,c.finder=new o(a)},apply:function(a){var b,c,d,f,h,i,j,k=this.format,l=g.blockParents(a),m=k[0].tags[0];if(l.length)for(b=0,c=l.length;c>b;b++)j=g.name(l[b]),"li"==j?(d=l[b].parentNode,f=new e.ListFormatter(d.nodeName.toLowerCase(),m),h=this.editor.createRange(),h.selectNode(l[b]),f.toggle(h)):m&&("td"==j||l[b].attributes.contentEditable)?new p(k,this.values).apply(l[b].childNodes):(i=g.changeTag(l[b],m),g.attr(i,k[0].attr));else new p(k,this.values).apply(a)},toggle:function(a){var b=n.textNodes(a);b.length||(a.selectNodeContents(a.commonAncestorContainer),b=n.textNodes(a),b.length||(b=g.significantChildNodes(a.commonAncestorContainer))),this.apply(b)}}),r=h.extend({init:function(a){a.formatter=a.formatter(),h.fn.init.call(this,a)}}),s=j.extend({init:function(a){j.fn.init.call(this,d(a,{finder:new o(a.format),formatter:function(){return new p(a.format)}}))}});d(e,{BlockFormatFinder:o,BlockFormatter:p,GreedyBlockFormatter:q,FormatCommand:r,BlockFormatTool:s}),m("justifyLeft",[{tags:g.blockElements,attr:{style:{textAlign:"left",listStylePosition:""}}},{tags:["img"],attr:{style:{"float":"left",display:"",marginLeft:"",marginRight:""}}}]),l("justifyLeft",new s({format:f.justifyLeft,template:new i({template:k.buttonTemplate,title:"Justify Left"})})),m("justifyCenter",[{tags:g.nonListBlockElements,attr:{style:{textAlign:"center"}}},{tags:["img"],attr:{style:{display:"block",marginLeft:"auto",marginRight:"auto","float":""}}},{tags:["ul","ol","li"],attr:{style:{textAlign:"center",listStylePosition:"inside"}}}]),l("justifyCenter",new s({format:f.justifyCenter,template:new i({template:k.buttonTemplate,title:"Justify Center"})})),m("justifyRight",[{tags:g.nonListBlockElements,attr:{style:{textAlign:"right"}}},{tags:["img"],attr:{style:{"float":"right",display:"",marginLeft:"",marginRight:""}}},{tags:["ul","ol","li"],attr:{style:{textAlign:"right",listStylePosition:"inside"}}}]),l("justifyRight",new s({format:f.justifyRight,template:new i({template:k.buttonTemplate,title:"Justify Right"})})),m("justifyFull",[{tags:g.blockElements,attr:{style:{textAlign:"justify",listStylePosition:""}}}]),l("justifyFull",new s({format:f.justifyFull,template:new i({template:k.buttonTemplate,title:"Justify Full"})}))}(window.joy.jQuery),function(a){var b=window.joy,c=a.extend,d=b.ui.editor,e=d.Dom,f=d.Command,g=d.Tool,h=d.BlockFormatter,i=e.normalize,j=d.RangeUtils,k=d.EditorUtils.registerTool,l=f.extend({init:function(a){this.options=a,f.fn.init.call(this,a)},_insertMarker:function(a,b){var c,d=e.create(a,"a");return d.className="k-marker",b.insertNode(d),d.parentNode||(c=b.commonAncestorContainer,c.innerHTML="",c.appendChild(d)),i(d.parentNode),d},_moveFocus:function(a,b){if(e.is(b,"img"))a.setStartBefore(b);else{a.selectNodeContents(b);var c=j.textNodes(a)[0];if(c)a.selectNodeContents(c);else{for(;b.childNodes.length&&!e.is(b.firstChild,"br");)b=b.firstChild;a.selectNodeContents(b)}}},shouldTrim:function(a){var b="p,h1,h2,h3,h4,h5,h6".split(","),c=e.parentOfType(a.startContainer,b),d=e.parentOfType(a.endContainer,b);return c&&!d||!c&&d},_blankAfter:function(a){for(;a&&(e.isMarker(a)||""===e.stripBom(a.nodeValue));)a=a.nextSibling;return!a},exec:function(){var a,b,c,f,g,k,l,m,n=this.getRange(),o=j.documentFromRange(n),p=d.emptyElementContent,q=this.shouldTrim(n);n.deleteContents(),g=this._insertMarker(o,n),k=e.closestEditableOfType(g,["li"]),l=e.closestEditableOfType(g,"h1,h2,h3,h4,h5,h6".split(",")),k?e.emptyNode(k)&&(f=e.create(o,"p"),k.nextSibling&&(m=n.cloneRange(),m.selectNode(k),j.split(m,k.parentNode)),e.insertAfter(f,k.parentNode),e.remove(1==k.parentNode.childNodes.length?k.parentNode:k),f.innerHTML=p,c=f):l&&this._blankAfter(g)&&(f=e.create(o,"p"),e.insertAfter(f,l),f.innerHTML=p,e.remove(g),c=f),c||(k||l||new h([{tags:["p"]}]).apply([g]),n.selectNode(g),a=e.parentOfType(g,[k?"li":l?e.name(l):"p"]),j.split(n,a,q),b=a.previousSibling,e.is(b,"li")&&b.firstChild&&!e.is(b.firstChild,"br")&&(b=b.firstChild),c=a.nextSibling,e.is(c,"li")&&c.firstChild&&!e.is(c.firstChild,"br")&&(c=c.firstChild),e.remove(a),this.clean(b),this.clean(c,{links:!0}),i(b)),i(c),this._moveFocus(n,c),n.collapse(!0),e.scrollTo(c),j.selectRange(n)},clean:function(a,b){var c=a;if(a.firstChild&&e.is(a.firstChild,"br")&&e.remove(a.firstChild),e.isDataNode(a)&&!a.nodeValue&&(a=a.parentNode),a){for(;a.firstChild&&1==a.firstChild.nodeType;)a=a.firstChild;if(!e.isEmpty(a)&&/^\s*$/.test(a.innerHTML)&&(a.innerHTML=d.emptyElementContent),b&&b.links)for(;a!=c;){if(e.is(a,"a")){e.unwrap(a);break}a=a.parentNode}}}}),m=f.extend({init:function(a){this.options=a,f.fn.init.call(this,a)},exec:function(){var a,c=this.getRange(),d=e.create(j.documentFromRange(c),"br");c.deleteContents(),c.insertNode(d),i(d.parentNode),b.support.browser.msie||d.nextSibling&&!e.isWhitespace(d.nextSibling)||(a=d.cloneNode(!0),a.setAttribute("_moz_dirty",""),e.insertAfter(a,d)),c.setStartAfter(d),c.collapse(!0),e.scrollTo(d.nextSibling||d),j.selectRange(c)}});c(d,{ParagraphCommand:l,NewLineCommand:m}),k("insertLineBreak",new g({key:13,shift:!0,command:m})),k("insertParagraph",new g({key:13,command:l}))}(window.joy.jQuery),function(a){var b=window.joy,c=b.Class,d=a.extend,e=b.ui.editor,f=e.Dom,g=e.RangeUtils,h=e.EditorUtils,i=e.Command,j=e.ToolTemplate,k=e.FormatTool,l=e.BlockFormatFinder,m=g.textNodes,n=e.EditorUtils.registerTool,o=l.extend({init:function(a){this.tag=a;var b=this.tags=["ul"==a?"ol":"ul",a];l.fn.init.call(this,[{tags:b}])},isFormatted:function(a){for(var b,c=[],d=0;d<a.length;d++)(b=this.findFormat(a[d]))&&f.name(b)==this.tag&&c.push(b);if(c.length<1)return!1;if(c.length!=a.length)return!1;for(d=0;d<c.length&&c[d].parentNode==b.parentNode;d++)if(c[d]!=b)return!1;return!0},findSuitable:function(a){var b=f.parentOfType(a[0],this.tags);return b&&f.name(b)==this.tag?b:null}}),p=c.extend({init:function(a,b){var c=this;c.finder=new o(a),c.tag=a,c.unwrapTag=b},isList:function(a){var b=f.name(a);return"ul"==b||"ol"==b||"dl"==b},wrap:function(a,b){var c,d,e=f.create(a.ownerDocument,"li");for(c=0;c<b.length;c++)if(d=b[c],f.is(d,"li"))a.appendChild(d);else if(this.isList(d))for(;d.firstChild;)a.appendChild(d.firstChild);else if(f.is(d,"td")){for(;d.firstChild;)e.appendChild(d.firstChild);a.appendChild(e),d.appendChild(a),a=a.cloneNode(!1),e=e.cloneNode(!1)}else e.appendChild(d),f.isBlock(d)&&(a.appendChild(e),f.unwrap(d),e=e.cloneNode(!1));e.firstChild&&a.appendChild(e)},containsAny:function(a,b){for(var c=0;c<b.length;c++)if(f.isAncestorOrSelf(a,b[c]))return!0;return!1},suitable:function(a,b){if("k-marker"==a.className){var c=a.nextSibling;if(c&&f.isBlock(c))return!1;if(c=a.previousSibling,c&&f.isBlock(c))return!1}return this.containsAny(a,b)||f.isInline(a)||3==a.nodeType},split:function(b){var c,d,e=m(b);if(e.length){c=f.parentOfType(e[0],["li"]),d=f.parentOfType(e[e.length-1],["li"]),b.setStartBefore(c),b.setEndAfter(d);for(var h=0,i=e.length;i>h;h++){var j=this.finder.findFormat(e[h]);if(j){var k=a(j).parents("ul,ol");k[0]?g.split(b,k.last()[0],!0):g.split(b,j,!0)}}}},merge:function(a,b){for(var c,d=b.previousSibling;d&&("k-marker"==d.className||3==d.nodeType&&f.isWhitespace(d));)d=d.previousSibling;if(d&&f.name(d)==a){for(;b.firstChild;)d.appendChild(b.firstChild);f.remove(b),b=d}for(c=b.nextSibling;c&&("k-marker"==c.className||3==c.nodeType&&f.isWhitespace(c));)c=c.nextSibling;if(c&&f.name(c)==a){for(;b.lastChild;)c.insertBefore(b.lastChild,c.firstChild);f.remove(b)}},breakable:function(a){return a!=a.ownerDocument.body&&!/table|tbody|tr|td/.test(f.name(a))&&!a.attributes.contentEditable},applyOnSection:function(b,c){function d(){h.push(this)}var e=this.tag,g=f.closestSplittableParent(c),h=[],i=this.finder.findSuitable(c);i||(i=new o("ul"==e?"ol":"ul").findSuitable(c));var j;/table|tbody/.test(f.name(g))?j=a.map(c,function(a){return f.parentOfType(a,["td"])}):(j=f.significantChildNodes(g),a.grep(j,f.isBlock).length&&(j=a.grep(j,a.proxy(function(a){return this.containsAny(a,c)},this))),j.length||(j=c));for(var k=0;k<j.length;k++){var l=j[k],m=(!i||!f.isAncestorOrSelf(i,l))&&this.suitable(l,c);m&&(i&&this.isList(l)?(a.each(l.childNodes,d),f.remove(l)):h.push(l))}h.length==j.length&&this.breakable(g)&&(h=[g]),i||(i=f.create(g.ownerDocument,e),f.insertBefore(i,h[0])),this.wrap(i,h),f.is(i,e)||f.changeTag(i,e),this.merge(e,i)},apply:function(a){var b,c,d,e=0,g=[];do d=f.closestEditable(a[e],["td","body"]),b&&d==b?c.push(a[e]):(b&&g.push({section:b,nodes:c}),c=[a[e]],b=d),e++;while(e<a.length);for(g.push({section:b,nodes:c}),e=0;e<g.length;e++)this.applyOnSection(g[e].section,g[e].nodes)},unwrap:function(b){var c,d,e,g,h=b.ownerDocument.createDocumentFragment(),i=this.unwrapTag;for(d=b.firstChild;d;d=d.nextSibling){for(e=f.create(b.ownerDocument,i||"p");d.firstChild;)g=d.firstChild,f.isBlock(g)?(e.firstChild&&(h.appendChild(e),e=f.create(b.ownerDocument,i||"p")),h.appendChild(g)):e.appendChild(g);e.firstChild&&h.appendChild(e)}c=a(b).parents("ul,ol"),c[0]?(f.insertAfter(h,c.last()[0]),c.last().remove()):f.insertAfter(h,b),f.remove(b)},remove:function(a){for(var b,c=0,d=a.length;d>c;c++)b=this.finder.findFormat(a[c]),b&&this.unwrap(b)},toggle:function(a){var b=this,c=m(a),d=a.commonAncestorContainer;if(!c.length&&(a.selectNodeContents(d),c=m(a),!c.length)){var e=d.ownerDocument.createTextNode("");a.startContainer.appendChild(e),c=[e],a.selectNode(e.parentNode)}b.finder.isFormatted(c)?(b.split(a),b.remove(c)):b.apply(c)}}),q=i.extend({init:function(a){a.formatter=new p(a.tag),i.fn.init.call(this,a)}}),r=k.extend({init:function(a){this.options=a,k.fn.init.call(this,d(a,{finder:new o(a.tag)}))},command:function(a){return new q(d(a,{tag:this.options.tag}))}});d(e,{ListFormatFinder:o,ListFormatter:p,ListCommand:q,ListTool:r}),n("insertUnorderedList",new r({tag:"ul",template:new j({template:h.buttonTemplate,title:"Remove Link"})})),n("insertOrderedList",new r({tag:"ol",template:new j({template:h.buttonTemplate,title:"Remove Link"})}))}(window.joy.jQuery),function(a,b){var c=window.joy,d=c.Class,e=a.extend,f=a.proxy,g=c.ui.editor,h=g.Dom,i=g.RangeUtils,j=g.EditorUtils,k=g.Command,l=g.Tool,m=g.ToolTemplate,n=g.InlineFormatter,o=g.InlineFormatFinder,p=i.textNodes,q=g.EditorUtils.registerTool,r=d.extend({findSuitable:function(a){return h.parentOfType(a,["a"])}}),s=d.extend({init:function(){this.finder=new r},apply:function(a,b){var c,d,e,f,g=p(a);b.innerHTML?(c=i.getMarkers(a),d=i.documentFromRange(a),a.deleteContents(),f=h.create(d,"a",b),a.insertNode(f),"a"==h.name(f.parentNode)&&h.insertAfter(f,f.parentNode),c.length>1&&(h.insertAfter(c[c.length-1],f),h.insertAfter(c[1],f),h[g.length>0?"insertBefore":"insertAfter"](c[0],f))):(e=new n([{tags:["a"]}],b),e.finder=this.finder,e.apply(g))}}),t=k.extend({init:function(a){a.formatter={toggle:function(a){new n([{tags:["a"]}]).remove(p(a))}},this.options=a,k.fn.init.call(this,a)}}),u=k.extend({init:function(a){var b=this;b.options=a,k.fn.init.call(b,a),b.formatter=new s,a.url?this.exec=function(){this.formatter.apply(a.range,{href:a.url,innerHTML:a.text||a.url,target:a.target})}:(b.attributes=null,b.async=!0)},_dialogTemplate:function(){return c.template("<div class=\"k-editor-dialog k-popup-edit-form k-edit-form-container\"><div class='k-edit-label'><label for='k-editor-link-url'>#: messages.linkWebAddress #</label></div><div class='k-edit-field'><input type='text' class='k-input k-textbox' id='k-editor-link-url'></div><div class='k-edit-label k-editor-link-text-row'><label for='k-editor-link-text'>#: messages.linkText #</label></div><div class='k-edit-field k-editor-link-text-row'><input type='text' class='k-input k-textbox' id='k-editor-link-text'></div><div class='k-edit-label'><label for='k-editor-link-title'>#: messages.linkToolTip #</label></div><div class='k-edit-field'><input type='text' class='k-input k-textbox' id='k-editor-link-title'></div><div class='k-edit-label'></div><div class='k-edit-field'><input type='checkbox' class='k-checkbox' id='k-editor-link-target'><label for='k-editor-link-target'>#: messages.linkOpenInNewWindow #</label></div><div class='k-edit-buttons k-state-default'><button class=\"k-dialog-insert k-button\">#: messages.dialogInsert #</button><button class=\"k-dialog-close k-button\">#: messages.dialogCancel #</button></div></div>")({messages:this.editor.options.messages})},exec:function(){var b=this.getRange().collapsed,c=this.editor.options.messages;this._initialText="",this._range=this.lockRange(!0);var d=p(this._range),e=d.length?this.formatter.finder.findSuitable(d[0]):null,g=d.length&&"img"==h.name(d[0]),i=this.createDialog(this._dialogTemplate(),{title:c.createLink,close:f(this._close,this),visible:!1});i.find(".k-dialog-insert").click(f(this._apply,this)).end().find(".k-dialog-close").click(f(this._close,this)).end().find(".k-edit-field input").keydown(f(this._keydown,this)).end().find("#k-editor-link-url").val(this.linkUrl(e)).end().find("#k-editor-link-text").val(this.linkText(d)).end().find("#k-editor-link-title").val(e?e.title:"").end().find("#k-editor-link-target").attr("checked",e?"_blank"==e.target:!1).end().find(".k-editor-link-text-row").toggle(!g),d.length>0&&!b&&(this._initialText=a("#k-editor-link-text",i).val()),this._dialog=i.data("joyWindow").center().open(),a("#k-editor-link-url",i).focus().select()},_keydown:function(a){var b=c.keys;a.keyCode==b.ENTER?this._apply(a):a.keyCode==b.ESC&&this._close(a)},_apply:function(b){var c,d,e,f=this._dialog.element,g=a("#k-editor-link-url",f).val(),i=a("#k-editor-link-text",f);g&&"http://"!=g&&(g.indexOf("@")>0&&!/^(\w+:)|(\/\/)/i.test(g)&&(g="mailto:"+g),this.attributes={href:g},c=a("#k-editor-link-title",f).val(),c&&(this.attributes.title=c),i.is(":visible")&&(d=i.val(),d||this._initialText?d&&d!==this._initialText&&(this.attributes.innerHTML=h.stripBom(d)):this.attributes.innerHTML=g),e=a("#k-editor-link-target",f).is(":checked"),this.attributes.target=e?"_blank":null,this.formatter.apply(this._range,this.attributes)),this._close(b),this.change&&this.change()},_close:function(a){a.preventDefault(),this._dialog.destroy(),h.windowFromDocument(i.documentFromRange(this._range)).focus(),this.releaseRange(this._range)},linkUrl:function(a){return a?a.getAttribute("href",2):"http://"},linkText:function(a){var b="";return 1==a.length?b=a[0].nodeValue:a.length&&(b=a[0].nodeValue+a[1].nodeValue),h.stripBom(b||"")},redo:function(){var a=this.lockRange(!0);this.formatter.apply(a,this.attributes),this.releaseRange(a)}}),v=l.extend({init:function(b){this.options=b,this.finder=new o([{tags:["a"]}]),l.fn.init.call(this,a.extend(b,{command:t}))},initialize:function(a,b){l.fn.initialize.call(this,a,b),a.addClass("k-state-disabled")},update:function(a,b){a.toggleClass("k-state-disabled",!this.finder.isFormatted(b)).removeClass("k-state-hover")}});e(c.ui.editor,{LinkFormatFinder:r,LinkFormatter:s,UnlinkCommand:t,LinkCommand:u,UnlinkTool:v}),q("createLink",new l({key:"K",ctrl:!0,command:u,template:new m({template:j.buttonTemplate,title:"Create Link"})})),q("unlink",new v({key:"K",ctrl:!0,shift:!0,template:new m({template:j.buttonTemplate,title:"Remove Link"})}))}(window.joy.jQuery),function(a,b){var c=window.joy,d=a.extend,e=c.ui.editor,f=e.EditorUtils,g=e.Dom,h=f.registerTool,i=e.ToolTemplate,j=e.RangeUtils,k=e.Command,l=c.keys,m="#k-editor-image-url",n="#k-editor-image-title",o="#k-editor-image-width",p="#k-editor-image-height",q=k.extend({init:function(a){var b=this;k.fn.init.call(b,a),b.async=!0,b.attributes={}},insertImage:function(a,b){var c=this.attributes,d=j.documentFromRange(b);if(c.src&&"http://"!=c.src){var e=function(){setTimeout(function(){c.width||a.removeAttribute("width"),c.height||a.removeAttribute("height"),a.removeAttribute("complete")})};if(!a)return a=g.create(d,"img",c),a.onload=a.onerror=function(){e()},b.deleteContents(),b.insertNode(a),a.nextSibling||g.insertAfter(d.createTextNode("\ufeff"),a),e(),b.setStartAfter(a),b.setEndAfter(a),j.selectRange(b),!0;g.attr(a,c),e()}return!1},_dialogTemplate:function(a){return c.template('<div class="k-editor-dialog k-popup-edit-form k-edit-form-container"># if (showBrowser) { #<div class="k-imagebrowser"></div># } #<div class=\'k-edit-label\'><label for="k-editor-image-url">#: messages.imageWebAddress #</label></div><div class=\'k-edit-field\'><input type="text" class="k-input k-textbox" id="k-editor-image-url"></div><div class=\'k-edit-label\'><label for="k-editor-image-title">#: messages.imageAltText #</label></div><div class=\'k-edit-field\'><input type="text" class="k-input k-textbox" id="k-editor-image-title"></div><div class=\'k-edit-label\'><label for="k-editor-image-width">#: messages.imageWidth #</label></div><div class=\'k-edit-field\'><input type="text" class="k-input k-textbox" id="k-editor-image-width"></div><div class=\'k-edit-label\'><label for="k-editor-image-height">#: messages.imageHeight #</label></div><div class=\'k-edit-field\'><input type="text" class="k-input k-textbox" id="k-editor-image-height"></div><div class="k-edit-buttons k-state-default"><button class="k-dialog-insert k-button">#: messages.dialogInsert #</button><button class="k-dialog-close k-button">#: messages.dialogCancel #</button></div></div>')({messages:this.editor.options.messages,showBrowser:a})},redo:function(){var a=this,b=a.lockRange();a.insertImage(j.image(b),b)||a.releaseRange(b)},exec:function(){function a(a){var b=h.element,c=parseInt(b.find(o).val(),10),d=parseInt(b.find(p).val(),10);k.attributes={src:b.find(m).val().replace(/ /g,"%20"),alt:b.find(n).val()},k.attributes.width=null,k.attributes.height=null,!isNaN(c)&&c>0&&(k.attributes.width=c),!isNaN(d)&&d>0&&(k.attributes.height=d),r=k.insertImage(s,q),e(a),k.change&&k.change()}function e(a){a.preventDefault(),h.destroy(),g.windowFromDocument(j.documentFromRange(q)).focus(),r||k.releaseRange(q)}function f(b){b.keyCode==l.ENTER?a(b):b.keyCode==l.ESC&&e(b)}var h,i,k=this,q=k.lockRange(),r=!1,s=j.image(q),t=s&&s.getAttribute("width")||"",u=s&&s.getAttribute("height")||"",v=k.editor.options,w=v.messages;v.imageBrowser?(i=v.imageBrowser,i.sourceCode=v.sourceCode):(i=ImageBrowser,i.sourceCode=v.sourceCode);var x=!!(c.ui.ImageBrowser&&i&&i.transport&&i.transport.read!==b);h=this.createDialog(k._dialogTemplate(x),{title:w.insertImage,close:e,visible:!1,resizable:x}).toggleClass("k-imagebrowser-dialog",x).find(".k-dialog-insert").click(a).end().find(".k-dialog-close").click(e).end().find(".k-edit-field input").keydown(f).end().find(m).val(s?s.getAttribute("src",2):"http://").end().find(n).val(s?s.alt:"").end().find(o).val(t).end().find(p).val(u).end().data("joyWindow"),x&&new c.ui.ImageBrowser(h.element.find(".k-imagebrowser"),d({},i,{change:function(){h.element.find(m).val(this.value())},apply:a})),h.center().open(),h.element.find(m).focus().select()}});c.ui.editor.ImageCommand=q,h("insertImage",new e.Tool({command:q,template:new i({template:f.buttonTemplate,title:"Insert Image"})}))}(window.joy.jQuery),function(a,b){var c=window.joy,d=c.ui.DropDownList,e=c.ui.editor.Dom,f=d.extend({init:function(a,b){var e=this;d.fn.init.call(e,a,b),e.value(e.options.title),c.support.mobileOS.ios&&e._initSelectOverlay(),e.bind("open",function(){if(e.options.autoSize){var a,b=e.list;b.css({whiteSpace:"nowrap",width:"auto"}),a=b.width(),a?a+=20:a=e._listWidth,b.css("width",a+c.support.scrollbar()),e._listWidth=a}})},options:{name:"SelectBox"},_initSelectOverlay:function(){var b=a(this.element),c=a("<select class='k-select-overlay' />"),d=b.closest(".k-widget"),e=this;c.on("change",function(){e.value(this.value),e.trigger("change")}),this.bind("dataBound",function(){for(var a,b=e.value(),d=this.dataSource.view(),f="",g=0;g<d.length;g++)a=d[g],f+="<option value='"+a.value+"'",a.value==b&&(f+=" selected"),f+=">"+a.text+"</option>";c.html(f)}),c.insertAfter(d)},value:function(a){var c=this,e=d.fn.value.call(c,a);return a===b?e:void(a!==d.fn.value.call(c)&&(c.text(c.options.title),c._current&&c._current.removeClass("k-state-selected"),c.current(null),c._oldIndex=c.selectedIndex=-1))},decorate:function(b){var c,d,f,g,h=this,i=h.dataSource,j=i.data();for(b&&h.list.css("background-color",e.getEffectiveBackground(a(b))),c=0;c<j.length;c++)d=j[c].tag||"span",f=j[c].className,g=e.inlineStyle(b,d,{className:f}),g=g.replace(/"/g,"'"),j[c].style=g+";display:inline-block";i.trigger("change")}});c.ui.plugin(f),c.ui.editor.SelectBox=f}(window.joy.jQuery),function(a,b){function c(c,d){var e="rtl"==a(c).css("direction"),f=e?"Right":"Left",g="td"!=h.name(c)?"margin"+f:"padding"+f;return d===b?c.style[g]||0:void(d>0?c.style[g]=d+"px":(c.style[g]="",c.style.cssText||c.removeAttribute("style")))}var d=window.joy,e=d.Class,f=a.extend,g=d.ui.editor,h=g.Dom,i=g.EditorUtils,j=i.registerTool,k=g.Command,l=g.Tool,m=g.ToolTemplate,n=g.RangeUtils,o=h.blockElements,p=g.BlockFormatFinder,q=g.BlockFormatter,r=e.extend({init:function(){this.finder=new p([{tags:h.blockElements}])},apply:function(b){var d,e,f,g,i,j=this.finder.findSuitable(b),k=[];if(j.length){for(d=0,e=j.length;e>d;d++)h.is(j[d],"li")?a(j[d]).index()?a.inArray(j[d].parentNode,k)<0&&k.push(j[d]):k.push(j[d].parentNode):k.push(j[d]);for(;k.length;)if(f=k.shift(),h.is(f,"li")){g=f.parentNode,i=a(f).prev("li");var l=i.find("ul,ol").last(),m=a(f).children("ul,ol")[0];if(m&&i[0])l[0]?(l.append(f),l.append(a(m).children()),h.remove(m)):(i.append(m),m.insertBefore(f,m.firstChild));else for(m=i.children("ul,ol")[0],m||(m=h.create(f.ownerDocument,h.name(g)),i.append(m));f&&f.parentNode==g;)m.appendChild(f),f=k.shift()}else{var n=parseInt(c(f),10)+30;c(f,n);for(var o=0;o<k.length;o++)a.contains(f,k[o])&&k.splice(o,1)}}else{var p=new q([{tags:["p"]}],{style:{marginLeft:30}});p.apply(b)}},remove:function(b){var d,e,f,g,h,i,j,k,l=this.finder.findSuitable(b);for(e=0,f=l.length;f>e;e++){if(j=a(l[e]),j.is("li")){if(g=j.parent(),h=g.parent(),h.is("li,ul,ol")&&!c(g[0])){if(d&&a.contains(d,h[0]))continue;i=j.nextAll("li"),i.length&&a(g[0].cloneNode(!1)).appendTo(j).append(i),h.is("li")?j.insertAfter(h):j.appendTo(h),g.children("li").length||g.remove();continue}if(d==g[0])continue;d=g[0]}else d=l[e];k=parseInt(c(d),10)-30,c(d,k)}}}),s=k.extend({init:function(a){a.formatter={toggle:function(a){(new r).apply(n.nodes(a))}},k.fn.init.call(this,a)}}),t=k.extend({init:function(a){a.formatter={toggle:function(a){(new r).remove(n.nodes(a))}},k.fn.init.call(this,a)}}),u=l.extend({init:function(a){l.fn.init.call(this,a),this.finder=new p([{tags:o}])},initialize:function(a,b){l.fn.initialize.call(this,a,b),a.addClass("k-state-disabled")},update:function(b,d){var e,f,g,i,j=this.finder.findSuitable(d);for(g=0,i=j.length;i>g;g++)if(e=c(j[g]),e||(f=a(j[g]).parents("ul,ol").length,e=h.is(j[g],"li")&&(f>1||c(j[g].parentNode))||h.ofType(j[g],["ul","ol"])&&f>0),e)return void b.removeClass("k-state-disabled");b.addClass("k-state-disabled").removeClass("k-state-hover")}});f(g,{IndentFormatter:r,IndentCommand:s,OutdentCommand:t,OutdentTool:u}),j("indent",new l({command:s,template:new m({template:i.buttonTemplate,title:"Indent"})})),j("outdent",new u({command:t,template:new m({template:i.buttonTemplate,title:"Outdent"})}))}(window.joy.jQuery),function(a,b){var c=window.joy,d=a.extend,e=c.ui.editor,f=e.EditorUtils,g=e.Command,h=e.Tool,i=e.ToolTemplate,j=g.extend({init:function(a){var b=this;b.options=a,g.fn.init.call(b,a),b.attributes=null,b.async=!0},exec:function(){function b(a){f.value(h.find(k).val()),d(a),e.change&&e.change(),f.trigger("change")}function d(a){a.preventDefault(),h.data("joyWindow").destroy(),f.focus()}var e=this,f=e.editor,g=f.options.messages,h=a(c.template(j.template)(g)).appendTo(document.body),i=j.indent(f.value()),k=".k-editor-textarea";this.createDialog(h,{title:g.viewHtml,close:d,visible:!1}).find(k).val(i).end().find(".k-dialog-update").click(b).end().find(".k-dialog-close").click(d).end().data("joyWindow").center().open(),h.find(k).focus()}});d(j,{template:"<div class='k-editor-dialog k-popup-edit-form k-edit-form-container k-viewhtml-dialog'><textarea class='k-editor-textarea k-input'></textarea><div class='k-edit-buttons k-state-default'><button class='k-dialog-update k-button'>#: dialogUpdate #</button><button class='k-dialog-close k-button'>#: dialogCancel #</button></div></div>",indent:function(a){return a.replace(/<\/(p|li|ul|ol|h[1-6]|table|tr|td|th)>/gi,"</$1>\n").replace(/<(ul|ol)([^>]*)><li/gi,"<$1$2>\n<li").replace(/<br \/>/gi,"<br />\n").replace(/\n$/,"")}}),c.ui.editor.ViewHtmlCommand=j,e.EditorUtils.registerTool("viewHtml",new h({command:j,template:new i({template:f.buttonTemplate,title:"View HTML"})}))}(window.joy.jQuery),function(a){function b(b,c,d){return k.extend({init:function(a){k.fn.init.call(this,a),this.finder=d},command:function(b){var d=b.value;return a.isPlainObject(d)?d[c]=d.value:(b.value={},b.value[c]=d),k.fn.command.call(this,b)},initialize:function(a,b){var d,e=window.console,f=this.options.items;for(d=0;d<f.length;d++)f[d][c]=f[d].value;e&&e.warn("The `"+this.options.name+"` tool has been deprecated in favor of the `formatting` tool. See http://docs.telerik.com/joy-ui/getting-started/changes-and-backward-compatibility for more information"),k.fn.initialize.call(this,a,b)}})}var c=window.joy,d=c.ui.editor,e=d.Tool,f=d.ToolTemplate,g=d.DelayedExecutionTool,h=d.Dom,i=d.EditorUtils.dropDownListTemplate,j=d.EditorUtils.registerTool,k=g.extend({init:function(a){var b=this;e.fn.init.call(b,c.deepExtend({},b.options,a)),b.type="joySelectBox",b.finder={getFormat:function(){return""}}},options:{items:[{text:"Paragraph",value:"p"},{text:"Quotation",value:"blockquote"},{text:"Heading 1",value:"h1"},{text:"Heading 2",value:"h2"},{text:"Heading 3",value:"h3"},{text:"Heading 4",value:"h4"},{text:"Heading 5",value:"h5"},{text:"Heading 6",value:"h6"}],width:90},
toFormattingItem:function(a){var b=a.value;if(!b)return a;if(a.tag||a.className)return a;var c=b.indexOf(".");return 0===c?a.className=b.substring(1):-1==c?a.tag=b:(a.tag=b.substring(0,c),a.className=b.substring(c+1)),a},command:function(b){var c=b.value;return c=this.toFormattingItem(c),new d.FormatCommand({range:b.range,formatter:function(){var b,e=(c.tag||c.context||"span").split(","),f=[{tags:e,attr:{className:c.className||""}}];return b=a.inArray(e[0],h.inlineElements)>=0?new d.GreedyInlineFormatter(f):new d.GreedyBlockFormatter(f)}})},initialize:function(a,b){var d=b.editor,f=this.options,g=f.name,h=this;a.width(f.width),a.joySelectBox({dataTextField:"text",dataValueField:"value",dataSource:f.items||d.options[g],title:d.options.messages[g],autoSize:!0,change:function(){e.exec(d,g,this.dataItem().toJSON())},dataBound:function(){var a,b=this.dataSource.data();for(a=0;a<b.length;a++)b[a]=h.toFormattingItem(b[a])},highlightFirst:!1,template:c.template('<span unselectable="on" style="display:block;#=(data.style||"")#">#:data.text#</span>')}),a.addClass("k-decorated").closest(".k-widget").removeClass("k-"+g).find("*").addBack().attr("unselectable","on")},getFormattingValue:function(b,c){for(var d=0;d<b.length;d++){var e=b[d],f=e.tag||e.context||"",g=e.className?"."+e.className:"",h=f+g,i=a(c[0]).closest(h)[0];if(i){if(1==c.length)return e.value;for(var j=1;j<c.length&&a(c[j]).closest(h)[0];j++)if(j==c.length-1)return e.value}}return""},update:function(b,c){var d=a(b).data(this.type);if(d){var e,f,i=d.dataSource,j=i.data(),k=h.commonAncestor.apply(null,c);for(e=0;e<j.length;e++)f=j[e].context,j[e].visible=!f||!!a(k).closest(f).length;i.filter([{field:"visible",operator:"eq",value:!0}]),g.fn.update.call(this,b,c),d.value(this.getFormattingValue(i.view(),c)),d.wrapper.toggleClass("k-state-disabled",!i.view().length)}}}),l=b("style","className",new d.GreedyInlineFormatFinder([{tags:["span"]}],"className")),m=b("formatBlock","tag",new d.BlockFormatFinder([{tags:h.blockElements}]));a.extend(d,{FormattingTool:k,StyleTool:l,FormatBlockTool:m}),j("formatting",new k({template:new f({template:i,title:"Format"})})),j("style",new l({template:new f({template:i,title:"Styles"})})),j("formatBlock",new m({template:new f({template:i})}))}(window.joy.jQuery),function(a,b){var c=window.joy,d=c.ui,e=d.editor,f=d.Widget,g=a.extend,h=a.proxy,i=c.keys,j=".joyEditor",k="a.k-tool:not(.k-state-disabled),.k-widget.k-colorpicker,.k-selectbox,.k-dropdown,.k-combobox .k-input",l=f.extend({init:function(a,b){var c=this;b=g({},b,{name:"EditorToolbar"}),f.fn.init.call(c,a,b),b.popup&&c._initPopup()},events:["execute"],groups:{basic:["bold","italic","underline","strikethrough"],scripts:["subscript","superscript"],alignment:["justifyLeft","justifyCenter","justifyRight","justifyFull"],links:["insertImage","createLink","unlink"],lists:["insertUnorderedList","insertOrderedList","indent","outdent"],tables:["createTable","addColumnLeft","addColumnRight","addRowAbove","addRowBelow","deleteRow","deleteColumn"],advanced:["viewHtml"]},_initPopup:function(){this.window=a(this.element).wrap("<div class='editorToolbarWindow k-header' />").parent().prepend("<button class='k-button k-button-bare k-editortoolbar-dragHandle'><span class='k-icon k-i-move' /></button>").joyWindow({title:!1,resizable:!1,draggable:{dragHandle:".k-editortoolbar-dragHandle"},animation:{open:{effects:"fade:in"},close:{effects:"fade:out"}},minHeight:42,visible:!1,autoFocus:!1,actions:[],dragend:function(){this._moved=!0}}).on("mousedown",function(b){a(b.target).is(".k-icon")||b.preventDefault()}).data("joyWindow")},items:function(){return this.element.children().find("> *, select")},focused:function(){return this.element.find(".k-state-focused").length>0},toolById:function(a){var b,c=this.tools;for(b in c)if(b.toLowerCase()==a)return c[b]},toolGroupFor:function(b){var c,d=this.groups;if(this.isCustomTool(b))return"custom";for(c in d)if(a.inArray(b,d[c])>=0)return c},bindTo:function(b){var c=this,d=c.window;c._editor&&c._editor.unbind("select",h(c._update,c)),c._editor=b,c.tools=c.expandTools("simple"!=b.options.editorType?b.options.toolbarOptions:["formatting","bold","italic","underline","justifyLeft","justifyCenter","justifyRight"]),c.render(),c.element.find(".k-combobox .k-input").keydown(function(b){var c=a(this).closest(".k-combobox").data("joyComboBox"),d=b.keyCode;d==i.RIGHT||d==i.LEFT?c.close():d==i.DOWN&&(c.dropDown.isOpened()||(b.stopImmediatePropagation(),c.open()))}),c._attachEvents(),c.items().each(function(){var d=c._toolName(this),e=c.tools[d],f=e&&e.options,g=b.options.messages,h=f&&f.tooltip||g[d],i=a(this);if(e&&e.initialize){if("fontSize"==d||"fontName"==d){var j=g[d+"Inherit"];i.find("input").val(j).end().find("span.k-input").text(j).end()}e.initialize(i,{title:c._appendShortcutSequence(h,e),editor:c._editor}),i.closest(".k-widget",c.element).addClass("k-editor-widget"),i.closest(".k-colorpicker",c.element).next(".k-colorpicker").addClass("k-editor-widget")}}),b.bind("select",h(c._update,c)),c._updateContext(),d&&d.wrapper.css({top:"",left:"",width:""})},show:function(){var a,b,c=this,d=c.window,e=c.options.editor;d&&(a=d.wrapper,b=e.element,a.is(":visible")&&c.window.options.visible||(a[0].style.width||a.width(b.outerWidth()-parseInt(a.css("border-left-width"),10)-parseInt(a.css("border-right-width"),10)),d._moved||(a.css("top",parseInt(b.offset().top,10)-a.outerHeight()-parseInt(c.window.element.css("padding-bottom"),10)),a.css("left",parseInt(b.offset().left,10))),d.open()))},hide:function(){this.window&&this.window.close()},focus:function(){var a="tabIndex",b=this.element,c=this._editor.element.attr(a);b.attr(a,c||0).focus().find(k).first().focus(),c||0===c||b.removeAttr(a)},_appendShortcutSequence:function(a,b){if(!b.key)return a;var c=a+" (";return b.ctrl&&(c+="Ctrl + "),b.shift&&(c+="Shift + "),b.alt&&(c+="Alt + "),c+=b.key+")"},_nativeTools:["insertLineBreak","insertParagraph","redo","undo"],tools:{},isCustomTool:function(a){return!(a in c.ui.Editor.defaultTools)},expandTools:function(b){var d,f,h,i,j=this._nativeTools,k=c.deepExtend({},c.ui.Editor.defaultTools),l={};for(f=0;f<b.length;f++)d=b[f],i=d.name,a.isPlainObject(d)?i&&k[i]?(l[i]=g({},k[i]),g(l[i].options,d)):(h=g({cssClass:"k-i-custom",type:"button",title:""},d),h.name||(h.name="custom"),h.cssClass="k-"+("custom"==h.name?"i-custom":h.name),h.template||"button"!=h.type||(h.template=e.EditorUtils.buttonTemplate,h.title=h.title||h.tooltip),l[i]={options:h}):k[d]&&(l[d]=k[d]);for(f=0;f<j.length;f++)l[j[f]]||(l[j[f]]=k[j[f]]);return l},render:function(){function b(b){var d;return b.getHtml?d=b.getHtml():(a.isFunction(b)||(b=c.template(b)),d=b(f)),a.trim(d)}function d(){m.children().length&&m.appendTo(r)}function e(){m=a("<li class='k-tool-group' role='presentation' />")}var f,g,i,j,k,l,m,n,o=this,p=o.tools,q=o._editor.element,r=o.element.empty(),s=o._editor.options.toolbarOptions,t=c.support.browser;for(r.empty(),e(),n=0;n<s.length;n++)j=s[n].name||s[n],f=p[j]&&p[j].options,!f&&a.isPlainObject(j)&&(f=j),g=f&&f.template,"break"==j&&(d(),a("<li class='k-row-break' />").appendTo(o.element),e()),g&&(l=o.toolGroupFor(j),k!=l&&(d(),e(),k=l),g=b(g),i=a(g).appendTo(m),"custom"==l&&(d(),e()),f.exec&&i.hasClass("k-tool")&&i.click(h(f.exec,q[0])));d(),a(o.element).children(":has(> .k-tool)").addClass("k-button-group"),o.options.popup&&t.msie&&t.version<9&&o.window.wrapper.find("*").attr("unselectable","on"),this.updateGroups()},updateGroups:function(){a(this.element).children().each(function(){a(this).children().filter(function(){return"none"!==this.style.display}).first().addClass("k-group-start").end().last().addClass("k-group-end").end()})},decorateFrom:function(b){this.items().filter(".k-decorated").each(function(){var c=a(this).data("joySelectBox");c&&c.decorate(b)})},destroy:function(){f.fn.destroy.call(this);var a,b=this.tools;for(a in b)b[a].destroy&&b[a].destroy();this.window&&this.window.destroy()},_attachEvents:function(){var b=this,c="[role=button].k-tool",d=c+":not(.k-state-disabled)",e=c+".k-state-disabled";b.element.off(j).on("mouseenter"+j,d,function(){a(this).addClass("k-state-hover")}).on("mouseleave"+j,d,function(){a(this).removeClass("k-state-hover")}).on("mousedown"+j,c,function(a){a.preventDefault()}).on("keydown"+j,k,function(c){function d(a,c){var d=b.element.find(k),e=d.index(f)+a;return c&&(e=Math.max(0,Math.min(d.length-1,e))),d[e]}var e,f=this,g=c.keyCode;g==i.RIGHT||g==i.LEFT?a(f).hasClass(".k-dropdown")||(e=d(g==i.RIGHT?1:-1,!0)):g==i.ESC?e=b._editor:g!=i.TAB||c.ctrlKey||c.altKey||(c.shiftKey?e=d(-1):(e=d(1),e||(e=b._editor))),e&&(c.preventDefault(),e.focus())}).on("click"+j,d,function(c){var d=a(this);c.preventDefault(),c.stopPropagation(),d.removeClass("k-state-hover"),d.is("[data-popup]")||b._editor.exec(b._toolName(this))}).on("click"+j,e,function(a){a.preventDefault()})},_toolName:function(b){if(b){var c=b.className;/k-tool\b/i.test(c)&&(c=b.firstChild.className);var d=a.grep(c.split(" "),function(a){return!/^k-(widget|tool|tool-icon|state-hover|header|combobox|dropdown|selectbox|colorpicker)$/i.test(a)});return d[0]?d[0].substring(d[0].lastIndexOf("-")+1):"custom"}},_update:function(){var b=this,d=b._editor,e=d.getRange(),f=c.ui.editor.RangeUtils.textNodes(e);f.length||(f=[e.startContainer]),b.items().each(function(){var c=b.tools[b._toolName(this)];c&&c.update&&c.update(a(this),f)}),this._updateContext()},_updateContext:function(){this.element.children().children().each(function(){var b=a(this);b.css("display",b.hasClass("k-state-disabled")?"none":"")}),this.updateGroups()}});a.extend(e,{Toolbar:l})}(window.jQuery),function(a,b){var c=window.joy,d=a.extend,e=c.getPluginLang(),f=a.proxy,g=c.ui.editor,h=g.Dom,i=g.EditorUtils,j=g.Command,k=".joyEditor",l="k-state-active",m="k-state-selected",n=g.Tool,o=g.ToolTemplate,p=g.InsertHtmlCommand,q=g.BlockFormatFinder,r=g.EditorUtils.registerTool,s="<td contentEditable='true'>"+g.emptyElementContent+"</td>",t=new q([{tags:["table"]}]),u=p.extend({_tableHtml:function(a,b){return a=a||1,b=b||1,"<table class='k-table' contentEditable='false' data-last>"+new Array(a+1).join("<tr>"+new Array(b+1).join(s)+"</tr>")+"</table>"},postProcess:function(b,c){var d=a("table[data-last]",b.document).removeAttr("data-last");c.selectNodeContents(d.find("td")[0]),b.selectRange(c)},exec:function(){var a=this.options;a.html=this._tableHtml(a.rows,a.columns),a.postProcess=this.postProcess,p.fn.exec.call(this)}}),v=n.extend({initialize:function(b,c){n.fn.initialize.call(this,b,c);var d=a(this.options.popupTemplate).appendTo("body").joyPopup({anchor:b,copyAnchorStyles:!1,open:f(this._open,this),activate:f(this._activate,this),close:f(this._close,this)}).data("joyPopup");b.click(f(this._toggle,this)).keydown(f(this._keydown,this)),this._editor=c.editor,this._popup=d},popup:function(){return this._popup},_activate:a.noop,_open:function(){this._popup.options.anchor.addClass(l)},_close:function(){this._popup.options.anchor.removeClass(l)},_keydown:function(a){var b=c.keys,d=a.keyCode;d==b.DOWN&&a.altKey?this._popup.open():d==b.ESC&&this._popup.close()},_toggle:function(b){var c=a(b.target).closest(".k-tool");c.hasClass("k-state-disabled")||this.popup().toggle()},update:function(a){this.popup().close(),a.removeClass("k-state-hover")},destroy:function(){this._popup.destroy()}}),w=v.extend({init:function(b){this.cols=8,this.rows=6,v.fn.init.call(this,a.extend(b,{command:u,popupTemplate:"<div class='k-ct-popup'>"+new Array(this.cols*this.rows+1).join("<span class='k-ct-cell k-state-disabled' />")+"<div class='k-status'>"+e.editor.cancelCreateTable+"</div></div>"}))},_activate:function(){function b(b){var c=a(window);return{row:Math.floor((b.clientY+c.scrollTop()-l.top)/e)+1,col:Math.floor((b.clientX+c.scrollLeft()-l.left)/d)+1}}var d,e,f=this,g=f._popup.element,h=g.find(".k-ct-cell"),i=h.eq(0),j=h.eq(h.length-1),l=c.getOffset(i),m=c.getOffset(j),n=f.cols,o=f.rows;m.left+=j[0].offsetWidth,m.top+=j[0].offsetHeight,d=(m.left-l.left)/n,e=(m.top-l.top)/o,g.on("mousemove"+k,function(a){f._setTableSize(b(a))}).on("mouseleave"+k,function(){f._setTableSize()}).on("mouseup"+k,function(a){f._exec(b(a))})},_valid:function(a){return a&&a.row>0&&a.col>0&&a.row<=this.rows&&a.col<=this.cols},_exec:function(a){this._valid(a)&&(this._editor.exec("createTable",{rows:a.row,columns:a.col}),this._popup.close())},_setTableSize:function(b){var d=this._popup.element,f=d.find(".k-status"),g=d.find(".k-ct-cell"),h=(this.rows,this.cols);this._valid(b)?(f.text(c.format(e.editor.createTableA,b.row,b.col)),g.each(function(c){a(this).toggleClass(m,c%h<b.col&&c/h<b.row)})):(f.text(e.editor.cancelCreateTable),g.removeClass(m))},_keydown:function(a){v.fn._keydown.call(this,a);var b=c.keys,d=a.keyCode,e=this._popup.element.find(".k-ct-cell"),f=Math.max(e.filter(".k-state-selected").last().index(),0),g=Math.floor(f/this.cols),h=f%this.cols,i=!1;d!=b.DOWN||a.altKey?d==b.UP?(i=!0,g--):d==b.RIGHT?(i=!0,h++):d==b.LEFT&&(i=!0,h--):(i=!0,g++);var j={row:Math.max(1,Math.min(this.rows,g+1)),col:Math.max(1,Math.min(this.cols,h+1))};d==b.ENTER?this._exec(j):this._setTableSize(j),i&&(a.preventDefault(),a.stopImmediatePropagation())},_open:function(){v.fn._open.call(this),this.popup().element.find(".k-ct-cell").removeClass(m)},_close:function(){v.fn._close.call(this),this.popup().element.off(k)},update:function(a,b){var c;v.fn.update.call(this,a),c=t.isFormatted(b),a.toggleClass("k-state-disabled",c)}}),x=j.extend({exec:function(){for(var a,b,c,d=this.lockRange(!0),e=d.endContainer;"td"!=h.name(e);)e=e.parentNode;b=e.parentNode,a=b.children.length,c=b.cloneNode(!0);for(var f=0;f<b.cells.length;f++)c.cells[f].innerHTML=g.emptyElementContent;"before"==this.options.position?h.insertBefore(c,b):h.insertAfter(c,b),this.releaseRange(d)}}),y=j.extend({exec:function(){var a,b,c,d,e=this.lockRange(!0),f=h.closest(e.endContainer,"td"),i=h.closest(f,"table"),j=i.rows,k=this.options.position;for(a=h.findNodeIndex(f),b=0;b<j.length;b++)c=j[b].cells[a],d=c.cloneNode(),d.innerHTML=g.emptyElementContent,"before"==k?h.insertBefore(d,c):h.insertAfter(d,c);this.releaseRange(e)}}),z=j.extend({exec:function(){var a,b=this.lockRange(),c=h.closest(b.endContainer,"tr"),d=h.closest(c,"table"),e=d.rows.length;1==e?(a=h.next(d)||h.prev(d),h.remove(d)):(h.removeTextSiblings(c),a=h.next(c)||h.prev(c),a=a.cells[0],h.remove(c)),a&&(b.setStart(a,0),b.collapse(!0),this.editor.selectRange(b))}}),A=j.extend({exec:function(){var a,b,c=this.lockRange(),d=h.closest(c.endContainer,"td"),e=h.closest(d,"table"),f=e.rows,g=h.findNodeIndex(d,!0),i=f[0].cells.length;if(1==i)a=h.next(e)||h.prev(e),h.remove(e);else for(h.removeTextSiblings(d),a=h.next(d)||h.prev(d),b=0;b<f.length;b++)h.remove(f[b].cells[g]);a&&(c.setStart(a,0),c.collapse(!0),this.editor.selectRange(c))}}),B=n.extend({command:function(a){return a=d(a,this.options),"delete"==a.action?"row"==a.type?new z(a):new A(a):"row"==a.type?new x(a):new y(a)},initialize:function(a,b){n.fn.initialize.call(this,a,b),a.addClass("k-state-disabled")},update:function(a,b){var c=!t.isFormatted(b);a.toggleClass("k-state-disabled",c)}});d(c.ui.editor,{PopupTool:v,TableCommand:u,InsertTableTool:w,TableModificationTool:B,InsertRowCommand:x,InsertColumnCommand:y,DeleteRowCommand:z,DeleteColumnCommand:A}),r("createTable",new w({template:new o({template:i.buttonTemplate,popup:!0,title:"Create table"})})),r("addColumnLeft",new B({type:"column",position:"before",template:new o({template:i.buttonTemplate,title:"Add column on the left"})})),r("addColumnRight",new B({type:"column",template:new o({template:i.buttonTemplate,title:"Add column on the right"})})),r("addRowAbove",new B({type:"row",position:"before",template:new o({template:i.buttonTemplate,title:"Add row above"})})),r("addRowBelow",new B({type:"row",template:new o({template:i.buttonTemplate,title:"Add row below"})})),r("deleteRow",new B({type:"row",action:"delete",template:new o({template:i.buttonTemplate,title:"Delete row"})})),r("deleteColumn",new B({type:"column",action:"delete",template:new o({template:i.buttonTemplate,title:"Delete column"})}))}(jQuery);