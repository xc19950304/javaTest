/*! by joyone.cn 厦门展网信息技术有限公司  joyone 2015-04-30  1.0.20 */
!function(a,b){var c=window.joy,d=c.ui.Widget,e="k-invalid-msg",f=(new RegExp(e,"i"),":input:not(:button,[type=submit],[type=reset]),.joy-checkbox,.joy-radio"),g=(a.proxy,d.extend({init:function(b,e){var f=this;d.fn.init.call(f,b,e),e=f.options,f._errorTemplate=c.template(f.options.errorTemplate),f._setJoyFormObject();var g=f.element.attr("id");if(null==g){var h=c.getUuid();f.element.attr("id",h)}window[g+"_DATAMODEL"]=c.observable(new Object),f.dataModel=a.extend({},window[g+"_DATAMODEL"]),c.bind(f.element,window[g+"_DATAMODEL"]),c.notify(f)},options:{name:"Form",autoValidatable:!0,layout:"vertical",labelWidth:"120px",errorTemplate:'<span id="#=elementid#" class="k-form-validation"><span class="k-validation-icon"> </span> #=message#</span>'},events:[],_setJoyFormObject:function(){var a=this,b=this.element.find(f);a.inputs=b;for(var c=0;c<b.length;c++){b.eq(c).data("parentFormObject",a)}},load:function(d){d==b&&(d=new Object);var e=this;e.clear();var f=e.element.attr("id");window[f+"_DATAMODEL"]=c.observable(d),e.dataModel=a.extend({},window[f+"_DATAMODEL"]),c.bind(e.element,window[f+"_DATAMODEL"])},reset:function(){var a=this,b=a.element.attr("id");window[b+"_DATAMODEL"]=a.dataModel,c.bind(a.element,window[b+"_DATAMODEL"])},clear:function(){for(var a=this,b=a.inputs,c=0;c<b.length;c++){var d=b.eq(c).data("objectKey");if(d){var e=b.eq(c).data(d);e&&(e.value(""),e.hideInfo())}}},validate:function(){for(var a=this,b=a.inputs,c=!0,d=0;d<b.length;d++){var e=b.eq(d),f=e.data("objectKey");if(f){var g=b.eq(d).data(f);if(g){var h=g.validate();c=0==c?c:h}}else{e.val("")}}return c},submit:function(d,e,f,g){var h=this,i=h.element.attr("id"),j=c.getPluginLang(),k=j.common.ajaxError;a.ajax({url:d,type:"POST",data:window[i+"_DATAMODEL"].toJSON(),dataType:"json",success:function(a){a.success?f(a.resultObject):(c.showMessage(a.resultObject,"error"),g!==b&&g(a.resultObject)),null!=e&&e.enable(!0)},error:function(a,b){return c.showMessage(k,"error"),null!=e&&e.enable(!0),!1}})},submitAsa:function(a,b,d,e){var f=this,g=f.element.attr("id"),h=(c.getPluginLang(),window[g+"_DATAMODEL"].toJSON()),i={};for(var j in h){var k=j.length;"_"==j.substring(0,1)?i[j.substring(1,k-1)]=i[j.substring(1,k-1)]?i[j.substring(1,k-1)]+"~"+h[j]:h[j]:i[j]=h[j]}c.getJSONAsa(a,b,i,function(a){e(a),null!=d&&d.enable(!0)})},getDataModel:function(){var a=this,b=a.element.attr("id");return window[b+"_DATAMODEL"]},getParaMap:function(){var a=this,b=a.getDataModel().toJSON(),c={};for(var d in b){c["map['"+d+"']"]=b[d]}return c}}));c.ui.plugin(g)}(window.joy.jQuery),function(a,b){function c(b){return a(a.parseHTML?a.parseHTML(b):b)}function d(a){return a.replace(/&amp/g,"&amp;").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">")}var e=window.joy,f=e.ui,g=f.Widget,h='<span id="#=elementid#" class="k-form-validation"><span class="k-validation-icon"></span><span class="k-validation-msg">#=message#</span></span>';f.FormElement=g.extend({_initFormElement:function(){var b=this,c=b.element,d=b.options,f=b.element.data("parentFormObject");if(b.parentForm=f,null!=f){if("vertical"==f.options.layout){null==c.attr("id")&&c.attr("id",e.getUuid());var g="<div class='k-form-label'><span class='k-form-title' id='"+c.attr("id")+"_title'>"+d.label+"</span>";d.required&&(g+="<font class='k-form-required'>&nbsp;*</font>");var h=c.attr("id")+"_info",i=a("#"+h);0==i.length&&(g+="<span id='"+h+"'></span>"),g+="</div>",b.wrapper.before(g)}else{if("horizontal"==f.options.layout){null==c.attr("id")&&c.attr("id",e.getUuid());var g="<div class='k-form-label' style='width:"+f.options.labelWidth+";display:inline-block;text-align:right'>";d.required&&(g+="<font class='k-form-required'>&nbsp;*</font>"),g+="<span id='"+c.attr("id")+"_title'>"+d.label+"</span>",g+="&nbsp;:&nbsp;</div>",b.wrapper.before(g);var h=c.attr("id")+"_info",i=a("#"+h);0==i.length&&(g="<span id='"+h+"'></span>",b.wrapper.after(g))}}}},showInfo:function(b){var f=this,g=f.element.attr("id")+"_info",i=a("#"+g),j=e.template(h),k=c(j({elementid:g,message:d(b)}));i.length>0?i.replaceWith(k):k.insertAfter(f.wrapper),k.show()},hideInfo:function(){var b=this,c=b.element.attr("id")+"_info",d=a("#"+c);d.hide()},label:function(c){var d=this,e=d.element,f=e.attr("id")+"_title",g=a("#"+f);return null!=g?c===b?g.html():void g.html(c):void 0}})}(window.joy.jQuery),function(a,b){function c(b,d){b.filters&&(b.filters=a.grep(b.filters,function(a){return c(a,d),a.filters?a.filters.length:a.field!=d}))}var d=window.joy,e=d.ui,f=e.Widget,g=e.FormElement,h=d.keys,i=d.support,j=d.htmlEncode,k=d._activeElement,l="id",m="li",n="change",o="k-state-focused",p="k-state-hover",q="k-loading",r="open",s="close",t="select",u="selected",v="progress",w="requestEnd",x="width",y=a.extend,z=a.proxy,A=i.browser,B=A.msie&&A.version<9,C=/"/g,D={ComboBox:"DropDownList",DropDownList:"ComboBox"},E=g.extend({init:function(b,c){var d,e=this,g=e.ns;f.fn.init.call(e,b,c),b=e.element,e._isSelect=b.is(t),e._template(),e.ul=a('<ul unselectable="on" class="k-list k-reset"/>').css({overflow:i.kineticScrollNeeded?"":"auto"}).on("mouseenter"+g,m,function(){a(this).addClass(p)}).on("mouseleave"+g,m,function(){a(this).removeClass(p)}).on("click"+g,m,z(e._click,e)).attr({tabIndex:-1,role:"listbox","aria-hidden":!0}),e.list=a("<div class='k-list-container'/>").append(e.ul).on("mousedown"+g,function(a){a.preventDefault()}),d=b.attr(l),d&&(e.list.attr(l,d+"-list"),e.ul.attr(l,d+"_listbox"),e._optionID=d+"_option_selected"),e._header(),e._accessors(),e._initValue()},options:{valuePrimitive:!0,headerTemplate:""},setOptions:function(a){f.fn.setOptions.call(this,a),a&&a.enable!==b&&(a.enabled=a.enable)},focus:function(){this._focused.focus()},readonly:function(a){this._editable({readonly:a===b?!0:a,disable:!1})},enable:function(a){this._editable({readonly:!1,disable:!(a=a===b?!0:a)})},_filterSource:function(a){var b=this,d=b.options,e=b.dataSource,f=e.filter()||{};c(f,d.dataTextField),a&&(f=f.filters||[],f.push(a)),e.filter(f)},_header:function(){var b,c=this.options.headerTemplate;a.isFunction(c)&&(c=c({})),c&&(this.list.prepend(c),b=this.ul.prev(),this.header=b[0]?b:null)},_initValue:function(){var a=this,b=a.options.value;null!==b?a.element.val(b):(b=a._accessor(),a.options.value=b),a._old=b},_ignoreCase:function(){var a,b=this,c=b.dataSource.reader.model;c&&c.fields&&(a=c.fields[b.options.dataTextField],a&&a.type&&"string"!==a.type&&(b.options.ignoreCase=!1))},items:function(){return this.ul[0].children},current:function(a){var c=this,d=c._optionID;return a===b?c._current:(c._current&&(c._current.removeClass(o).removeAttr("aria-selected").removeAttr(l),c._focused.removeAttr("aria-activedescendant")),a&&(a.addClass(o),c._scroll(a),d&&(a.attr("id",d),c._focused.attr("aria-activedescendant",d))),c._current=a,void 0)},destroy:function(){var a=this,b=a.ns;f.fn.destroy.call(a),a._unbindDataSource(),a.ul.off(b),a.list.off(b),a._touchScroller&&a._touchScroller.destroy(),a.popup.destroy(),a._form&&a._form.off("reset",a._resetHandler)},dataItem:function(a){var c=this;return a===b&&(a=c.selectedIndex),c._data()[a]},_accessors:function(){var a=this,b=a.element,c=a.options,e=d.getter,f=b.attr(d.attr("text-field")),g=b.attr(d.attr("value-field"));f&&(c.dataTextField=f),g&&(c.dataValueField=g),a._text=e(c.dataTextField),a._value=e(c.dataValueField)},_aria:function(a){var c=this,d=c.options,e=c._focused;d.suggest!==b&&e.attr("aria-autocomplete",d.suggest?"both":"list"),a=a?a+" "+c.ul[0].id:c.ul[0].id,e.attr("aria-owns",a),c.ul.attr("aria-live",d.filter&&"none"!==d.filter?"polite":"off")},_blur:function(){var a=this;a._change(),a.close()},_change:function(){var a,c=this,d=c.selectedIndex,e=c.options.value,f=c.value();c._isSelect&&!c._bound&&e&&(f=e),f!==c._old?a=!0:d!==b&&d!==c._oldIndex&&(a=!0),a&&(c._old=f,c._oldIndex=d,c.trigger(n),c.element.trigger(n))},_click:function(b){b.isDefaultPrevented()||this._accept(a(b.currentTarget))},_data:function(){return this.dataSource.view()},_enable:function(){var a=this,c=a.options,d=a.element.is("[disabled]");c.enable!==b&&(c.enabled=c.enable),!c.enabled||d?a.enable(!1):a.readonly(a.element.is("[readonly]"))},_focus:function(a){var b=this,c=!0;return b.popup.visible()&&a&&b.trigger(t,{item:a})?void b.close():(b._select(a),b._triggerCascade(c),void b._blur())},_index:function(a){var b,c,d=this,e=d._data();for(b=0,c=e.length;c>b;b++){if(d._dataValue(e[b])==a){return b}}return -1},_dataValue:function(a){var c=this._value(a);return c===b&&(c=this._text(a)),c},_height:function(a){if(a){var b,c=this,d=c.list,e=c.popup.visible(),f=c.options.height,g=c.header;b=d.add(d.parent(".k-animation-container")).show(),f=c.ul[0].scrollHeight>f?f:"auto",b.height(f),g&&c.ul.height("auto"==f?f:d.height()-g.height()),e||b.hide()}},_adjustListWidth:function(){var a,b,c=this.list,d=c[0].style.width,e=this.wrapper;if(c.data(x)||!d){return a=window.getComputedStyle?window.getComputedStyle(e[0],null):0,b=a?parseFloat(a.width):e.outerWidth(),a&&(A.mozilla||A.msie)&&(b+=parseFloat(a.paddingLeft)+parseFloat(a.paddingRight)+parseFloat(a.borderLeftWidth)+parseFloat(a.borderRightWidth)),d="border-box"!==c.css("box-sizing")?b-(c.outerWidth()-c.width()):b,c.css({fontFamily:e.css("font-family"),width:d}).data(x,d),!0}},_popup:function(){var a=this,b=a.list,c=a._focused,f=a.options,g=a.wrapper;a.popup=new e.Popup(b,y({},f.popup,{anchor:g,open:function(b){a._adjustListWidth(),a.trigger(r)?b.preventDefault():(c.attr("aria-expanded",!0),a.ul.attr("aria-hidden",!1))},close:function(b){a.trigger(s)?b.preventDefault():(c.attr("aria-expanded",!1),a.ul.attr("aria-hidden",!0))},animation:f.animation,isRtl:i.isRtl(g)})),a.popup.one(r,function(){a._height(a._data().length)}),a._touchScroller=d.touchScroller(a.popup.element)},_makeUnselectable:function(){B&&this.list.find("*").attr("unselectable","on")},_toggleHover:function(b){a(b.currentTarget).toggleClass(p,"mouseenter"===b.type)},_toggle:function(a){var c=this,d=i.touch&&i.MSPointers&&i.pointers;a=a!==b?a:!c.popup.visible(),d||c._focused[0]===k()||c._focused.focus(),c[a?r:s]()},_scroll:function(a){if(a){a[0]&&(a=a[0]);var b,c,d=this.ul[0],e=a.offsetTop,f=a.offsetHeight,g=d.scrollTop,h=d.clientHeight,i=e+f,j=this._touchScroller;j?(b=j.dimensions.y,b.enabled&&e>b.size&&(e=e-b.size+f+4,j.scrollTo(0,-e))):(c=this.header?this.header.outerHeight():0,d.scrollTop=g>e?e-c:i>g+h?i-h-c:g)}},_template:function(){var a=this,b=a.options,c=b.template,e=b.dataSource;a._isSelect&&a.element[0].length&&(e||(b.dataTextField=b.dataTextField||"text",b.dataValueField=b.dataValueField||"value")),c?(c=d.template(c),a.template=function(a){return'<li tabindex="-1" role="option" unselectable="on" class="k-item">'+c(a)+"</li>"}):a.template=d.template('<li tabindex="-1" role="option" unselectable="on" class="k-item">${'+d.expr(b.dataTextField,"data")+"}</li>",{useWithBlock:!1})},_triggerCascade:function(a){var b=this,c=b.value();(!b._bound&&c||b._old!==c)&&b.trigger("cascade",{userTriggered:a})},_unbindDataSource:function(){var a=this;a.dataSource.unbind(n,a._refreshHandler).unbind(v,a._progressHandler).unbind(w,a._requestEndHandler).unbind("error",a._errorHandler)}});y(E,{inArray:function(a,b){var c,d,e=b.children;if(!a||a.parentNode!==b){return -1}for(c=0,d=e.length;d>c;c++){if(a===e[c]){return c}}return -1}}),d.ui.List=E,e.Select=E.extend({init:function(a,b){E.fn.init.call(this,a,b),this._initial=this.element.val()},setDataSource:function(a){this.options.dataSource=a,this._dataSource(),this._bound=!1,this.options.autoBind&&this.dataSource.fetch()},close:function(){this.popup.close()},index:function(a){var c=this;return a===b?c.selectedIndex:(c._select(a),c._triggerCascade(),c._old=c._accessor(),c._oldIndex=c.selectedIndex,c.trigger(n),c.element.trigger(n),void 0)},_accessor:function(a,c){var d,e=this.element[0],f=this._isSelect,g=e.selectedIndex;return a===b?(f?g>-1&&(d=e.options[g],d&&(a=d.value)):a=e.value,a):void (f?(g>-1&&e.options[g].removeAttribute(u),e.selectedIndex=c,d=e.options[c],d&&d.setAttribute(u,u)):e.value=a)},_hideBusy:function(){var a=this;clearTimeout(a._busy),a._arrow.removeClass(q),a._focused.attr("aria-busy",!1),a._busy=null},_showBusy:function(){var a=this;a._request=!0,a._busy||(a._busy=setTimeout(function(){a._focused.attr("aria-busy",!0),a._arrow.addClass(q)},100))},_requestEnd:function(){this._request=!1},_dataSource:function(){var b,c=this,e=c.element,f=c.options,g=f.dataSource||{};g=a.isArray(g)?{data:g}:g,c._isSelect&&(b=e[0].selectedIndex,b>-1&&(f.index=b),g.select=e,g.fields=[{field:f.dataTextField},{field:f.dataValueField}]),c.dataSource&&c._refreshHandler?c._unbindDataSource():(c._refreshHandler=z(c.refresh,c),c._progressHandler=z(c._showBusy,c),c._requestEndHandler=z(c._requestEnd,c),c._errorHandler=z(c._hideBusy,c)),c.dataSource=d.data.DataSource.create(g).bind(n,c._refreshHandler).bind(v,c._progressHandler).bind(w,c._requestEndHandler).bind("error",c._errorHandler)},_get:function(b){var c,d,e=this,f=e._data();if("function"==typeof b){for(c=0,d=f.length;d>c;c++){if(b(f[c])){b=c;break}}}if("number"==typeof b){if(0>b){return a()}b=a(e.ul[0].children[b])}return b&&b.nodeType&&(b=a(b)),b},_move:function(a){var b,c,d=this,e=a.keyCode,f=d.ul[0],g=d.popup.visible()?"_select":"_accept",i=d._current,j=e===h.DOWN;if(e===h.UP||j){if(a.altKey){d.toggle(j)}else{if(b=f.firstChild,!b&&!d._accessor()&&"filter"!==d._state){return d._fetch||(d.dataSource.one(n,function(){d._move(a),d._fetch=!1}),d._fetch=!0,d._filterSource()),a.preventDefault(),!0}j?(!i||-1===d.selectedIndex&&!d.value()&&i[0]===b?i=b:(i=i[0].nextSibling,i||b!==f.lastChild||(i=b)),d[g](i)):(i=i?i[0].previousSibling:f.lastChild,i||b!==f.lastChild||(i=b),d[g](i))}a.preventDefault(),c=!0}else{e===h.ENTER||e===h.TAB?(d.popup.visible()&&a.preventDefault(),!d._typing&&(d.popup.visible()||i&&i.hasClass("k-state-selected"))||(i=null),d._accept(i),c=!0):e===h.ESC&&(d.popup.visible()&&a.preventDefault(),d.close(),c=!0)}return c},_selectItem:function(){var a,c,d=this,e=d._bound===b,f=d.options;a=d._isSelect&&!d._initial&&!f.value&&f.index&&!d._bound,a||(c=d._selectedValue||e&&f.value||d._accessor()),c?d.value(c):e&&(d._select(f.index),d._triggerCascade(),d._old=d._accessor(),d._oldIndex=d.selectedIndex)},_fetchItems:function(a){var c=this,d=c.ul[0].firstChild;return c._request?!0:c._fetch||d?void 0:c.options.cascadeFrom?!d:(c.dataSource.one(n,function(){c._old=b,c.value(a),c._fetch=!1}),c._fetch=!0,c.dataSource.fetch(),!0)},_options:function(a,c){var d,e,f,g,h=this,i=h.element,k=a.length,l="",m=0;for(c&&(m=1,l=c);k>m;m++){d="<option",e=a[m],f=h._text(e),g=h._value(e),g!==b&&(g+="",-1!==g.indexOf('"')&&(g=g.replace(C,"&quot;")),d+=' value="'+g+'"'),d+=">",f!==b&&(d+=j(f)),d+="</option>",l+=d}i.html(l)},_reset:function(){var b=this,c=b.element,d=c.attr("form"),e=d?a("#"+d):c.closest("form");e[0]&&(b._resetHandler=function(){setTimeout(function(){b.value(b._initial)})},b._form=e.on("reset",b._resetHandler))},_cascade:function(){var b,d,e,f,g,h=this,i=h.options,j=i.cascadeFrom;if(j){if(h._selectedValue=i.value||h._accessor(),d=a("#"+j),b=d.data("joy"+i.name),b||(b=d.data("joy"+D[i.name])),!b){return}i.autoBind=!1,f=i.cascadeFromField||b.options.dataValueField,g=function(){h.dataSource.unbind(n,g);var a=h._selectedValue||h.value();h._userTriggered?h._clearSelection(b,!0):a?(h.value(a),h.dataSource.view()[0]&&-1!==h.selectedIndex||h._clearSelection(b,!0)):(h._select(i.index),h._triggerCascade(),h._old=h._accessor(),h._oldIndex=h.selectedIndex),h.enable(),h._triggerCascade(h._userTriggered),h._userTriggered=!1},e=function(){var a,d,e=b.dataItem(),i=e?b._value(e):null;if(i||0===i){a=h.dataSource.filter()||{},c(a,f),d=a.filters||[],d.push({field:f,operator:"eq",value:i});var j=function(){h.dataSource.unbind(n,j),g.apply(h,arguments)};h.first("dataBound",j),h.dataSource.filter(d)}else{h.enable(!1),h._clearSelection(b),h._triggerCascade(h._userTriggered),h._userTriggered=!1}},b.first("cascade",function(a){h._userTriggered=a.userTriggered,e()}),b._bound?e():b.value()||h.enable(!1)}}})}(window.joy.jQuery),function(a,b){var c=window.joy,d=c.ui,e=d.List,f=d.Select,g=c.caret,h=c.support,i=h.placeholder,j=c._activeElement,k=c.keys,l=".joyComboBox",m="click"+l,n="mousedown"+l,o="disabled",p="readonly",q="change",r="k-state-default",s="k-state-focused",t="k-state-disabled",u="aria-disabled",v="aria-readonly",w="k-state-selected",x="filter",y="accept",z="rebind",A="mouseenter"+l+" mouseleave"+l,B=null,C=a.proxy,D=f.extend({init:function(b,d){var e,g=this;g.ns=l,d=a.isArray(d)?{dataSource:d}:d,f.fn.init.call(g,b,d),g._focusHandler=function(){g.input.focus()},d=g.options,b=g.element.on("focus"+l,g._focusHandler),b.on("blur"+l,C(g._blurHandler,g)),d.placeholder=d.placeholder||b.attr("placeholder"),g._reset(),g._wrapper(),g._initFormElement(),g._input(),g._tabindex(g.input),g._popup(),g._dataSource(),g._ignoreCase(),g._enable(),g._cascade(),g._aria(),g._oldIndex=g.selectedIndex=-1,d.autoBind?g._filterSource():(e=d.text,!e&&g._isSelect&&(e=b.children(":selected").text()),e&&(g.input.val(e),g._prev=e)),e=d.text,e&&g.text(e),e||g._placeholder(),c.notify(g)},options:{name:"ComboBox",enabled:!0,index:-1,text:null,value:null,autoBind:!0,delay:200,dataTextField:"text",dataValueField:"value",minLength:0,height:200,highlightFirst:!0,template:"",filter:"none",placeholder:"",suggest:!1,cascadeFrom:"",cascadeFromField:"",ignoreCase:!0,selfDefinable:!1,required:!1,maxByte:100,minByte:0,animation:{},subject:"",label:""},events:["open","close",q,"select","dataBinding","dataBound","cascade"],setOptions:function(a){f.fn.setOptions.call(this,a),this._template(),this._accessors(),this._aria()},current:function(a){var c=this,d=c._current;return a===b?d:(d&&d.removeClass(w),void f.fn.current.call(c,a))},destroy:function(){var a=this;a.input.off(l),a.element.off(l),a._inputWrapper.off(l),f.fn.destroy.call(a)},_blurHandler:function(a){},_editable:function(a){var c=this,d=a.disable,e=a.readonly,f=c._inputWrapper.off(l),g=c.element.add(c.input.off(l)),h=c._arrow.parent().off(m+" "+n);e||d?(f.addClass(d?t:r).removeClass(d?r:t),g.attr(o,d).attr(p,e).attr(u,d).attr(v,e)):(f.addClass(r).removeClass(t).on(A,c._toggleHover),g.removeAttr(o).removeAttr(p).attr(u,!1).attr(v,!1),h.on(m,function(){c.toggle()}).on(n,function(a){a.preventDefault()}),c.input.on("keydown"+l,C(c._keydown,c)).on("focus"+l,function(){f.addClass(s),c._placeholder(!1)}).on("blur"+l,function(){f.removeClass(s),clearTimeout(c._typing),a=c.options;var d=c.input.val();if(d!==b){var e=c.dataSource,g=e.total();for(idx=0;idx<g;idx++){var h=e.at(idx)[a.dataTextField];if(a.ignoreCase&&(h=h.toLowerCase(),d=d.toLowerCase()),h==d){break}}idx<g&&c.value()!=e.at(idx)[a.dataValueField]&&c.text(d),idx==e.total()&&(a.selfDefinable||c.text(""))}c.options.text!==c.input.val()&&c.text(c.text()),c._placeholder(),c._blur(),c.element.blur(),null!=c.parentForm&&1==c.parentForm.options.autoValidatable&&c.validate()}))},validate:function(){var a=this,b=a.options,d=a.element,e=d.val(),f=c.getPluginLang();if(b.required&&""==e){return a.showInfo(c.format(f.form.requiredInfo,b.subject)),!1}if(""!=e){var g=a.text();if(b.selfDefinable){var h=c.getByteLength(g);if(h<b.minByte){return a.showInfo(c.format(f.form.minByteInfo,b.minByte,h)),!1}if(h>b.maxByte){return a.showInfo(c.format(f.form.maxByteInfo,b.maxByte,h)),!1}}}return a.hideInfo(),!0},open:function(){var a=this,b=a.dataSource.options.serverFiltering;a.popup.visible()||(!a.ul[0].firstChild||a._state===y&&!b?(a._open=!0,a._state=z,a._filterSource()):(a.popup.open(),a._scroll(a._current)))},refresh:function(){var d,e,f,g=this,h=g.ul[0],i=g.options,k=g._state,l=g._data(),m=l.length,n=!0;g.trigger("dataBinding"),h.innerHTML=c.render(g.template,l),g._height(m),g.popup.visible()&&g.popup._position(),g._isSelect&&(d=g.element[0].children[0],k===z&&(g._state=""),f=g._option,g._option=b,g._options(l),f&&f[0].selected?g._custom(f.val(),n):g._bound||d||g._custom("",n)),m&&(i.highlightFirst&&g.current(a(h.firstChild)),i.suggest&&g.input.val()&&g._request!==b&&g.suggest(a(h.firstChild))),k===x||g._fetch||g._selectItem(),g._open&&(g._open=!1,e=!!m,g._typing&&g.input[0]!==j()&&(e=!1),g.toggle(e),g._typing=b),g._touchScroller&&g._touchScroller.reset(),g._makeUnselectable(),g._hideBusy(),g._bound=!0,g.trigger("dataBound")},search:function(a){a="string"==typeof a?a:this.text();var b=this,c=a.length,d=b.options,e=d.ignoreCase,f=d.filter,g=d.dataTextField;clearTimeout(b._typing),c>=d.minLength&&(b._state=x,"none"===f?b._filter(a):(b._open=!0,b._filterSource({value:e?a.toLowerCase():a,field:g,operator:f,ignoreCase:e})))},suggest:function(a){var c,d=this,f=d.input[0],h=d.text(),i=g(f)[0],l=d._last;return l==k.BACKSPACE||l==k.DELETE?void (d._last=b):(a=a||"","string"!=typeof a&&(c=e.inArray(a[0],d.ul[0]),a=c>-1?d._text(d.dataSource.view()[c]):""),0>=i&&(i=h.toLowerCase().indexOf(a.toLowerCase())+1),a?(c=a.toLowerCase().indexOf(h.toLowerCase()),c>-1&&(h+=a.substring(c+h.length))):h=h.substring(0,i),void (h.length===i&&a||(f.value=h,f===j()&&g(f,i,h.length))))},text:function(a){a=null===a?"":a;var c,d,e=this,f=e.input[0],g=e.options.ignoreCase,h=a;return a===b?f.value:(c=e.dataItem(),c&&e._text(c)===a&&(d=e._value(c),null===d?d="":d+="",d===e._old)?void e._triggerCascade():(g&&(h=h.toLowerCase()),e._select(function(a){return a=e._text(a),g&&(a=(a+"").toLowerCase()),a===h}),e.selectedIndex<0&&(e._custom(a),f.value=a),e._prev=f.value,void e._triggerCascade()))},toggle:function(a){var b=this;b._toggle(a)},value:function(a){var c,d=this,e=d.options;return a===b?d._accessor():(null!==a&&(a=a.toString()),d._selectedValue=a,!d._open&&a&&d._fetchItems(a)||(c=d._index(a),c>-1?(d._select(c),d._triggerCascade(),d._old=d._accessor(),d._oldIndex=d.selectedIndex):(d.current(B),d._custom(a),(e.value!==a||e.text!==d.input.val())&&(d.text(a),d._placeholder())),d._old=d._accessor(),d._oldIndex=d.selectedIndex),void 0)},_accept:function(a){var b=this;a?b._focus(a):(b.text(b.text()),b._change())},_custom:function(b,c){var d=this,e=d.element,f=d._option;d._state!==x||c||(d._state=y),d._isSelect?(f||(f=d._option=a("<option/>"),e.append(f)),f.text(b),f[0].selected=!0):e.val(b),d._selectedValue=b},_filter:function(a){var c=this,d=c.options,e=c.dataSource,f=d.ignoreCase,g=function(d){var e=c._text(d);return e!==b?(e+="",""!==e&&""===a?!1:(f&&(e=e.toLowerCase()),0===e.indexOf(a))):void 0};return f&&(a=a.toLowerCase()),c.ul[0].firstChild?(-1!==c._highlight(g)&&(d.suggest&&c._current&&c.suggest(c._current),c.open()),void c._hideBusy()):void e.one(q,function(){e.data()[0]&&c.search(a)}).fetch()},_highlight:function(c){var d,f=this;return c===b||null===c?-1:(c=f._get(c),d=e.inArray(c[0],f.ul[0]),-1==d&&(f.options.highlightFirst&&!f.text()?(c=f.ul[0].firstChild,c&&(c=a(c))):c=B),f.current(c),d)},_input:function(){var b,c=this,d=c.element.removeClass("k-input")[0],e=d.accessKey,f=c.wrapper,g="input.k-input",h=d.name||"";h&&(h='name="'+h+'_input" '),b=f.find(g),b[0]||(f.append('<span tabindex="-1" unselectable="on" class="k-dropdown-wrap k-state-default"><input '+h+'class="k-input" type="text" autocomplete="off"/><span tabindex="-1" unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span></span>').append(c.element),b=f.find(g)),b[0].style.cssText=d.style.cssText,d.maxLength>-1&&(b[0].maxLength=d.maxLength),b.addClass(d.className).val(this.options.text||d.value).css({width:"100%",height:d.style.height}).attr({role:"combobox","aria-expanded":!1}).show(),i&&b.attr("placeholder",c.options.placeholder),e&&(d.accessKey="",b[0].accessKey=e),c._focused=c.input=b,c._inputWrapper=a(f[0].firstChild),c._arrow=f.find(".k-icon").attr({role:"button",tabIndex:-1}),d.id&&c._arrow.attr("aria-controls",c.ul[0].id)},_keydown:function(a){var b=this,c=a.keyCode;b._last=c,clearTimeout(b._typing),c==k.TAB||b._move(a)||b._search()},_placeholder:function(a){if(!i){var c,d=this,e=d.input,f=d.options.placeholder;if(f){if(c=d.value(),a===b&&(a=!c),e.toggleClass("k-readonly",a),!a){if(c){return}f=""}e.val(f),f||e[0]!==j()||g(e[0],0,0)}}},_search:function(){var a=this;a._typing=setTimeout(function(){var b=a.text();a._prev!==b&&(a._prev=b,a.search(b)),a._typing=null},a.options.delay)},_select:function(a){var c,d,e=this,f=e._data(),g=e._highlight(a);e.selectedIndex=g,-1!==g&&(e._state===x&&(e._state=y),e._current.addClass(w),f=f[g],c=e._text(f),d=e._value(f),e._prev=e.input[0].value=c,e._accessor(d!==b?d:c,g),e._selectedValue=e._accessor(),e._placeholder(),e._optionID&&e._current.attr("aria-selected",!0))},_wrapper:function(){var a=this,b=a.element,c=b.parent();c.is("span.k-widget")||(c=b.hide().wrap("<span />").parent(),c[0].style.cssText=b[0].style.cssText),a.wrapper=c.addClass("k-widget k-combobox k-header").addClass(b[0].className).css("display","")},_clearSelection:function(a,b){var c=this,d=a._selectedValue||a.value(),e=d&&-1===a.selectedIndex;(b||!d||e)&&(c.value(""),c.options.value="")}});d.plugin(D)}(window.joy.jQuery),function(a,b){function c(a,b){var c;if(null===a&&null!==b||null!==a&&null===b){return !1}if(c=a.length,c!==b.length){return !1}for(;c--;){if(a[c]!==b[c]){return !1}}return !0}function d(b){var c=b.firstChild;return c&&"none"===c.style.display&&(c=f(c,w)),c?a(c):c}function e(b){var c=b.lastChild;return c&&"none"===c.style.display&&(c=f(c,x)),c?a(c):c}function f(a,b){return a=a[b],a&&"none"===a.style.display&&(a=f(a,b)),a}var g=window.joy,h=g.ui,i=h.List,j=g.keys,k=g._activeElement,l=g.data.ObservableArray,m=a.proxy,n="id",o="li",p="accept",q="filter",r="open",s="close",t="change",u="progress",v="select",w="nextSibling",x="previousSibling",y=' style="display:none"',z="aria-disabled",A="aria-readonly",B="k-state-focused",C="k-loading-hidden",D="k-state-hover",E="k-state-disabled",F="disabled",G="readonly",H=".kendoMultiSelect",I="click"+H,J="keydown"+H,K="mouseenter"+H,L="mouseleave"+H,M=K+" "+L,N=/"/g,O=a.isArray,P=["font-family","font-size","font-stretch","font-style","font-weight","letter-spacing","text-transform","line-height"],Q=i.extend({init:function(b,c){var d,e,f=this;f.ns=H,i.fn.init.call(f,b,c),f._wrapper(),f._initFormElement(),f._tagList(),f._input(),f._textContainer(),f._loader(),f._tabindex(f.input),b=f.element.attr("multiple","multiple").hide(),c=f.options,e=c.value,c.placeholder||(c.placeholder=b.data("placeholder")),d=b.attr(n),d&&(f._tagID=d+"_tag_active",d+="_taglist",f.tagList.attr(n,d)),f._aria(d),f._dataSource(),f._ignoreCase(),f._popup(),f._values=[],f._dataItems=[],f._reset(),f._enable(),f._placeholder(),c.autoBind?f.dataSource.fetch():e&&(O(e)||(e=e.split(",")),(a.isPlainObject(e[0])||!c.dataValueField)&&(f._retrieveData=!0,f.dataSource.data(e),f.value(f._initialValues))),g.notify(f)},options:{name:"MultiSelect",required:!1,enabled:!0,autoBind:!0,autoClose:!0,highlightFirst:!0,dataTextField:"text",dataValueField:"value",filter:"startswith",ignoreCase:!0,minLength:0,delay:100,value:null,maxSelectedItemNum:null,itemTemplate:"",tagTemplate:"",placeholder:"",height:200,animation:{},subject:"",label:""},events:[r,s,t,v,"dataBinding","dataBound"],setDataSource:function(a){this.options.dataSource=a,this._dataSource(),this.options.autoBind&&this.dataSource.fetch()},setOptions:function(a){i.fn.setOptions.call(this,a),this._template(),this._accessors(),this._aria(this.tagList.attr(n))},current:function(a){return this.currentTag(null),i.fn.current.call(this,a)},currentTag:function(a){var c=this;return a===b?c._currentTag:(c._currentTag&&(c._currentTag.removeClass(B).removeAttr(n),c.input.removeAttr("aria-activedescendant")),a&&(a.addClass(B).attr(n,c._tagID),c.input.attr("aria-activedescendant",c._tagID)),c._currentTag=a,void 0)},dataItems:function(){return this._dataItems},destroy:function(){var a=this,b=a.ns;a.wrapper.off(b),a.tagList.off(b),a.input.off(b),i.fn.destroy.call(a)},_editable:function(b){var c=this,d=b.disable,e=b.readonly,f=c.wrapper.off(H),g=c.tagList.off(H),h=c.element.add(c.input.off(H));e||d?(d?f.addClass(E):f.removeClass(E),h.attr(F,d).attr(G,e).attr(z,d).attr(A,e)):(f.removeClass(E).on(M,c._toggleHover).on("mousedown"+H,function(a){var b="input"!==a.target.nodeName.toLowerCase();b&&a.preventDefault(),-1===a.target.className.indexOf("k-delete")&&(c.input[0]!==k()&&b&&c.input.focus(),0===c.options.minLength&&c.open())}),c.input.on(J,m(c._keydown,c)).on("paste"+H,m(c._search,c)).on("focus"+H,function(){c._placeholder(!1)}).on("blur"+H,function(){clearTimeout(c._typing),c._placeholder(),c.close(),c._state===q&&(c._state=p),c.element.blur(),null!=c.parentForm&&1==c.parentForm.options.autoValidatable&&c.validate()}),h.removeAttr(F).removeAttr(G).attr(z,!1).attr(A,!1),g.on(K,o,function(){a(this).addClass(D)}).on(L,o,function(){a(this).removeClass(D)}).on(I,".k-delete",function(b){c._unselect(a(b.target).closest(o)),c._change(),c.close(),c.input.focus()}))},validate:function(){var a=this,b=a.options,c=(a.element,a.value()),d=g.getPluginLang();return b.required&&""==c?(a.showInfo(g.format(d.form.requiredInfo,b.subject)),!1):(a.hideInfo(),!0)},_close:function(){var a=this;a.options.autoClose||!a._visibleItems?a.close():(a.current(a.options.highlightFirst?d(a.ul[0]):null),a.popup._position())},close:function(){this.popup.close(),this.current(null)},open:function(){var a=this;!a.ul[0].firstChild||a._state===p||a._retrieveData?(a._state="",a._open=!0,a._retrieveData=!1,a._filterSource()):a._visibleItems&&a._allowSelection()&&(a.popup.open(),a.current(a.options.highlightFirst?d(a.ul[0]):null))},toggle:function(a){a=a!==b?a:!this.popup.visible(),this[a?r:s]()},refresh:function(){var a,b=this,c=null;b.trigger("dataBinding"),a=b._render(b.dataSource.view()),b._height(a),b._setInitialValues&&(b._setInitialValues=!1,b.value(b._initialValues)),b._open&&(b._open=!1,b.toggle(a)),b.popup.visible()&&(b.popup._position(),b.options.highlightFirst&&(c=d(b.ul[0]))),b.current(c),b._touchScroller&&b._touchScroller.reset(),b._makeUnselectable(),b._hideBusy(),b.trigger("dataBound")},search:function(a){var b=this,c=b.options,d=c.ignoreCase,e=c.filter,f=c.dataTextField,g=b.input.val();c.placeholder===g&&(g=""),clearTimeout(b._typing),a="string"==typeof a?a:g,a.length>=c.minLength&&(b._state=q,b._open=!0,b._filterSource({value:d?a.toLowerCase():a,field:f,operator:e,ignoreCase:d}))},value:function(c){var d,e=this,f=a(e.tagList[0].children),g=f.length,h=0;if(c===b){return e._values.toString()}if(a.isArray(c)||(c=c.split(",")),!e._fetchItems(c)){for(;g>h;h++){e._unselect(f.eq(h))}if(null!==c){for(c=O(c)||c instanceof l?c:[c],h=0,g=c.length;g>h;h++){d=e._index(c[h]),d>-1&&e._select(d)}e._old=e._values.slice()}}},_dataSource:function(){var a=this,b=a.element,c=a.options,d=c.dataSource||{};d=O(d)?{data:d}:d,d.select=b,d.fields=[{field:c.dataTextField},{field:c.dataValueField}],a.dataSource&&a._refreshHandler?a._unbindDataSource():(a._refreshHandler=m(a.refresh,a),a._progressHandler=m(a._showBusy,a)),a.dataSource=g.data.DataSource.create(d).bind(t,a._refreshHandler).bind(u,a._progressHandler)},_fetchItems:function(b){var c=this,d=a.isArray(b)&&0===b.length;return !d&&b?c._fetch||c.ul[0].firstChild?void 0:(c.dataSource.one(t,function(){c.value(b),c._fetch=!1}),c._fetch=!0,c.dataSource.fetch(),!0):void 0},_reset:function(){var b=this,c=b.element,d=c.attr("form"),e=d?a("#"+d):c.closest("form");e[0]&&(b._resetHandler=function(){setTimeout(function(){b.value(b._initialValues)})},b._form=e.on("reset",b._resetHandler))},_initValue:function(){var a=this,c=a.options.value||a.element.val();null===c?c=[]:(O(c)||(c=c.split(",")),c=a._mapValues(c)),a._old=a._initialValues=c,a._setInitialValues=c[0]!==b},_mapValues:function(b){var c=this;return b&&a.isPlainObject(b[0])&&(b=a.map(b,function(a){return c._value(a)})),b},_change:function(){var a=this,b=a.value();c(b,a._old)||(a._old=b.slice(),a.trigger(t),a.element.trigger(t))},_click:function(b){var c=this,d=a(b.currentTarget);if(!b.isDefaultPrevented()){if(c.trigger(v,{item:d})){return void c._close()}c._select(d),c._change(),c._close()}},_item:function(a,b){return a=a[b](),a[0]&&!a.is(":visible")&&(a=this._item(a,b)),a},_keydown:function(b){var c=this,h=b.keyCode,i=c._currentTag,k=c._current,l=c.input.val(),m=g.support.isRtl(c.wrapper),n=c.popup.visible();
if(h===j.DOWN){if(b.preventDefault(),!n){return void c.open()}k=k?f(k[0],w):d(c.ul[0]),k&&c.current(a(k))}else{if(h===j.UP){n&&(k=k?f(k[0],x):e(c.ul[0]),c.current(a(k)),c._current[0]||c.close()),b.preventDefault()}else{if(h===j.LEFT&&!m||h===j.RIGHT&&m){l||(i=i?i.prev():a(c.tagList[0].lastChild),i[0]&&c.currentTag(i))}else{if(h===j.RIGHT&&!m||h===j.LEFT&&m){!l&&i&&(i=i.next(),c.currentTag(i[0]?i:null))}else{if(h===j.ENTER&&n){if(k){if(c.trigger(v,{item:k})){return void c._close()}c._select(k)}c._change(),c._close(),b.preventDefault()}else{h===j.ESC?(n?b.preventDefault():c.currentTag(null),c.close()):h===j.HOME?n?c.current(d(c.ul[0])):l||(i=c.tagList[0].firstChild,i&&c.currentTag(a(i))):h===j.END?n?c.current(e(c.ul[0])):l||(i=c.tagList[0].lastChild,i&&c.currentTag(a(i))):h!==j.DELETE&&h!==j.BACKSPACE||l?(clearTimeout(c._typing),setTimeout(function(){c._scale()}),c._search()):(h!==j.BACKSPACE||i||(i=a(c.tagList[0].lastChild)),i&&i[0]&&(c._unselect(i),c._change(),c._close()))}}}}}},_hideBusy:function(){var a=this;clearTimeout(a._busy),a.input.attr("aria-busy",!1),a._loading.addClass(C),a._busy=null},_showBusy:function(){var a=this;a._busy||(a._busy=setTimeout(function(){a.input.attr("aria-busy",!0),a._loading.removeClass(C)},100))},_placeholder:function(a){var c=this,d=c.input,e=k();a===b?(a=!1,d[0]!==e&&(a=!c._dataItems[0]),c.wrapper.removeClass(B)):c.wrapper.addClass(B),c._prev="",d.toggleClass("k-readonly",a).val(a?c.options.placeholder:""),d[0]===e&&g.caret(d[0],0,0),c._scale()},_scale:function(){var a,b=this,c=b.wrapper,d=c.width(),e=b._span.text(b.input.val());c.is(":visible")?a=e.width()+25:(e.appendTo(document.documentElement),d=a=e.width()+25,e.appendTo(c)),b.input.width(a>d?d:a)},_option:function(a,c){var d="<option",e=this._text(a),f=this._value(a);return f!==b&&(f+="",-1!==f.indexOf('"')&&(f=f.replace(N,"&quot;")),d+=' value="'+f+'"'),c&&(d+=' selected="selected"'),d+=">",e!==b&&(d+=g.htmlEncode(e)),d+="</option>"},_render:function(a){for(var b,c,d=this,e=a.length,f=d.itemTemplate,g=d._dataItems.slice(0),h=0,i=0,j="",k="";e>i;i++){b=a[i],c=d._selected(g,b),k+=f(b,i,c),j+=d._option(b,c),c||(h+=1)}if(e=g.length){for(i=0;e>i;i++){j+=d._option(g[i],!0)}}return d.ul[0].innerHTML=k,d.element.val(j),d._visibleItems=h,h},_selected:function(a,c){var d,e=this,f=e._text,g=e._value,h=g(c),i=a.length,j=!1,k=0;for(h===b&&(h=f(c));i>k;k++){if(c=a[k],d=g(c),d===b&&(d=f(c)),d!==b&&d===h){j=!0;break}}return j&&a.splice(k,1),j},_search:function(){var a=this;a._typing=setTimeout(function(){var b=a.input.val();a._prev!==b&&(a._prev=b,a.search(b))},a.options.delay)},_allowSelection:function(){var a=this.options.maxSelectedItemNum;return null===a||a>this._values.length},_select:function(a){var b,c,d=this,e=d._values;d._allowSelection()&&(isNaN(a)?c=a.hide().data("idx"):(c=a,d.ul[0].children[c].style.display="none"),b=d.dataSource.view()[c],d.tagList.append(d.tagTemplate(b)),d._dataItems.push(b),e.push(d._dataValue(b)),d._visibleItems-=1,d.currentTag(null),d._placeholder(),d._height(d._visibleItems),d._state===q&&(d._state=p))},_unselect:function(b){var c,d,e,f,g,h=this,i=b.index();if(b.remove(),h.currentTag(null),h._values.splice(i,1),c=h._dataItems.splice(i,1)[0],d=h._dataValue(c),i=h._index(d),-1!==i){a(h.ul[0].children[i]).show(),h._visibleItems+=1,h._height(h._visibleItems)}else{for(i=h.dataSource.view().length,e=h.element[0].children,g=e.length;g>i;i++){if(f=e[i],f.value==d){f.selected=!1;break}}}h._placeholder()},_template:function(){var a,b=this,c=b.options,d=c.itemTemplate,e=c.tagTemplate,f=c.dataSource;b.element[0].length&&!f&&(c.dataTextField=c.dataTextField||"text",c.dataValueField=c.dataValueField||"value"),a=g.template("#:"+g.expr(c.dataTextField,"data")+"#",{useWithBlock:!1}),d=d?g.template(d):a,e=e?g.template(e):a,b.itemTemplate=function(a,b,c){return'<li tabindex="-1" role="option" data-idx="'+b+'" unselectable="on" class="k-item"'+(c?y:"")+">"+d(a)+"</li>"},b.tagTemplate=function(a){return'<li class="k-button" unselectable="on"><span unselectable="on">'+e(a)+'</span><span unselectable="on" class="k-icon k-delete">delete</span></li>'}},_input:function(){var b=this,c=b.element[0].accessKey,d=b._innerWrapper.children("input.k-input");d[0]||(d=a('<input class="k-input" style="width: 25px" ></input>').appendTo(b._innerWrapper)),b.element.removeAttr("accesskey"),b._focused=b.input=d.attr({accesskey:c,role:"listbox","aria-expanded":!1})},_tagList:function(){var b=this,c=b._innerWrapper.children("ul");c[0]||(c=a('<ul role="listbox" unselectable="on" class="k-reset"/>').appendTo(b._innerWrapper)),b.tagList=c},_loader:function(){this._loading=a('<span class="k-icon k-loading '+C+'"></span>').insertAfter(this.input)},_textContainer:function(){var b=g.getComputedStyles(this.input[0],P);b.position="absolute",b.visibility="hidden",b.top=-3333,b.left=-3333,this._span=a("<span/>").css(b).appendTo(this.wrapper)},_wrapper:function(){var b=this,c=b.element,d=c.parent("span.k-multiselect");d[0]||(d=c.wrap('<div class="k-widget k-multiselect k-header" unselectable="on" />').parent(),d[0].style.cssText=c[0].style.cssText,a('<div class="k-multiselect-wrap k-floatwrap" unselectable="on" />').insertBefore(c)),b.wrapper=d.addClass(c[0].className).css("display",""),b._innerWrapper=a(d[0].firstChild)}});h.plugin(Q)}(window.joy.jQuery),function(a,b){function c(a,b){return'<span unselectable="on" class="k-link"><span unselectable="on" class="k-icon k-i-arrow-'+a+'" title="'+b+'">'+b+"</span></span>"}var d=window.joy,e=d.caret,f=d.getPluginLang(),g=d.keys,h=d.ui,i=h.Widget,j=h.FormElement,k=d._activeElement,l=d._extractFormat,m=d.parseFloat,n=d.support.placeholder,o=d.getPluginLang,p=d._round,q="change",r="disabled",s="readonly",t="k-input",u="spin",v=".joyNumericTextBox",w="touchend",x="mouseleave"+v,y="mouseenter"+v+" "+x,z="k-state-default",A="k-state-focused",B="k-state-hover",C="focus",D=".",E="k-state-selected",F="k-state-disabled",G="aria-disabled",H="aria-readonly",I=/^(-)?(\d*)$/,J=null,K=a.proxy,L=j.extend({init:function(a,c){var e,f,g,h,j,k=this,m=c&&c.step!==b;if(i.fn.init.call(k,a,c),c=k.options,a=k.element.on("blur"+v,K(k._focusout,k)).attr("role","spinbutton"),c.placeholder=c.placeholder||a.attr("placeholder"),k._reset(),k._wrapper(),k._initFormElement(),k._arrows(),k._input(),d.support.mobileOS?k._text.on(w+v+" "+C+v,function(b){k._toggleText(!1),b.type===C&&a.focus()}):k._text.on(C+v,K(k._click,k)),c.dataType!=J&&""!=c.dataType){var n=k.dataTypeDefine[c.dataType];n&&(n.min!=J&&(c.min=n.min),n.max!=J&&(c.max=n.max),n.step!=J&&(c.step=n.step),a.attr("aria-valuemin",c.min).attr("aria-valuemax",c.max),c.dataFormat=l(n.dataFormat))}e=k.min(a.attr("min")),f=k.max(a.attr("max")),g=k._parse(a.attr("step")),c.min===J&&e!==J&&(c.min=e),c.max===J&&f!==J&&(c.max=f),m||g===J||(c.step=g),a.attr("aria-valuemin",c.min).attr("aria-valuemax",c.max),c.dataFormat=l(c.dataFormat),h=c.value,k.value(h!==J?h:a.val()),j=a.is("[disabled]"),j?k.enable(!1):k.readonly(a.is("[readonly]")),k.options.enable||k.enable(!1),d.notify(k)},options:{name:"NumericTextBox",decimals:J,min:J,max:J,value:J,step:1,subject:"",culture:"",dataFormat:"n",required:!1,spinners:!0,placeholder:"",label:"",upArrowText:f.numerictextbox.upArrowText,downArrowText:f.numerictextbox.downArrowText,dataType:"",enable:!0},dataTypeDefine:{"+int":{dataFormat:"n0",min:1,step:1},"-int":{dataFormat:"n0",max:-1,step:1},"int":{dataFormat:"n0",step:1},"float":{dataFormat:"n",step:1},"+float":{dataFormat:"n",min:0,step:1},"-float":{dataFormat:"n",max:0,step:1}},events:[q,u],_editable:function(a){var b=this,c=b.element,d=a.disable,e=a.readonly,f=b._text.add(c),g=b._inputWrapper.off(y);b._toggleText(!0),b._upArrowEventHandler.unbind("press"),b._downArrowEventHandler.unbind("press"),c.off("keydown"+v).off("keypress"+v).off("paste"+v),e||d?(g.addClass(d?F:z).removeClass(d?z:F),f.attr(r,d).attr(s,e).attr(G,d).attr(H,e)):(g.addClass(z).removeClass(F).on(y,b._toggleHover),f.removeAttr(r).removeAttr(s).attr(G,!1).attr(H,!1),b._upArrowEventHandler.bind("press",function(a){a.preventDefault(),b._spin(1),b._upArrow.addClass(E)}),b._downArrowEventHandler.bind("press",function(a){a.preventDefault(),b._spin(-1),b._downArrow.addClass(E)}),b.element.on("keydown"+v,K(b._keydown,b)).on("keypress"+v,K(b._keypress,b)).on("paste"+v,K(b._paste,b)))},readonly:function(a){this._editable({readonly:a===b?!0:a,disable:!1})},enable:function(a){this._editable({readonly:!1,disable:!(a=a===b?!0:a)})},destroy:function(){var a=this;a.element.add(a._text).add(a._upArrow).add(a._downArrow).add(a._inputWrapper).off(v),a._upArrowEventHandler.destroy(),a._downArrowEventHandler.destroy(),a._form&&a._form.off("reset",a._resetHandler),i.fn.destroy.call(a)},min:function(a){return this._option("min",a)},max:function(a){return this._option("max",a)},step:function(a){return this._option("step",a)},value:function(a){var c,d=this;return a===b?d._value:(a=d._parse(a),c=d._adjust(a),void (a===c&&(d._update(a),d._old=d._value)))},focus:function(){this._focusin()},_adjust:function(a){var b=this,c=b.options,d=c.min,e=c.max;return a===J?a:(d!==J&&d>a?a=d:e!==J&&a>e&&(a=e),a)},_arrows:function(){var b,e=this,f=function(){clearTimeout(e._spinning),b.removeClass(E)},g=e.options,h=g.spinners,i=e.element;b=i.siblings(".k-icon"),b[0]||(b=a(c("n",g.upArrowText)+c("s",g.downArrowText)).insertAfter(i),b.wrapAll('<span class="k-select"/>')),h||(b.parent().toggle(h),e._inputWrapper.addClass("k-expand-padding")),e._upArrow=b.eq(0),e._upArrowEventHandler=new d.UserEvents(e._upArrow,{release:f}),e._downArrow=b.eq(1),e._downArrowEventHandler=new d.UserEvents(e._downArrow,{release:f})},_blur:function(){var a=this;a._toggleText(!0),a._change(a.element.val()),null!=a.parentForm&&1==a.parentForm.options.autoValidatable&&a.validate()},validate:function(){var a=this,b=a.options,c=a.element,e=c.val(),f=d.getPluginLang();return b.required&&""==e?(a.showInfo(d.format(f.form.requiredInfo,b.subject)),!1):(a.hideInfo(c),!0)},_click:function(a){var b=this;clearTimeout(b._focusing),b._focusing=setTimeout(function(){var c,d,f,g=a.target,h=e(g)[0],i=g.value.substring(0,h),j=b._format(b.options.dataFormat),k=j[","],l=0;k&&(d=new RegExp("\\"+k,"g"),f=new RegExp("([\\d\\"+k+"]+)(\\"+j[D]+")?(\\d+)?")),f&&(c=f.exec(i)),c&&(l=c[0].replace(d,"").length,-1!=i.indexOf("(")&&b._value<0&&l++),b._focusin(),e(b.element[0],l)})},_change:function(a){var b=this;b._update(a),a=b._value,b._old!=a&&(b._old=a,b.trigger(q),b.element.trigger(q))},_culture:function(a){return a||o(this.options.culture)},_focusin:function(){var a=this;a._inputWrapper.addClass(A),a._toggleText(!1),a.element[0].focus()},_focusout:function(){var a=this;clearTimeout(a._focusing),a._inputWrapper.removeClass(A).removeClass(B),a._blur()},_format:function(a,b){var c=this._culture(b).numberFormat;return a=a.toLowerCase(),a.indexOf("c")>-1?c=c.currency:a.indexOf("p")>-1&&(c=c.percent),c},_input:function(){var b,c=this,d="k-formatted-value",e=c.element.addClass(t).show()[0],f=e.accessKey,g=c.wrapper;b=g.find(D+d),b[0]||(b=a('<input type="text"/>').insertBefore(e).addClass(d));try{e.setAttribute("type","text")}catch(h){e.type="text"}b[0].tabIndex=e.tabIndex,b[0].style.cssText=e.style.cssText,b.prop("placeholder",c.options.placeholder),f&&(b.attr("accesskey",f),e.accessKey=""),c._text=b.addClass(e.className)},_keydown:function(a){var b=this,c=a.keyCode;b._key=c,c==g.DOWN?b._step(-1):c==g.UP?b._step(1):c==g.ENTER&&b._change(b.element.val())},_keypress:function(a){if(0!==a.which&&a.keyCode!==g.BACKSPACE&&a.keyCode!==g.ENTER){var b,c=this,d=c.options.min,f=c.element,h=e(f),i=h[0],j=h[1],k=String.fromCharCode(a.which),l=c._format(c.options.dataFormat),m=c._key===g.NUMPAD_DOT,n=f.val();m&&(k=l[D]),n=n.substring(0,i)+k+n.substring(j),b=c._numericRegex(l).test(n),b&&m?(f.val(n),e(f,i+k.length),a.preventDefault()):(null!==d&&d>=0&&"-"===n.charAt(0)||!b)&&a.preventDefault(),c._key=0}},_numericRegex:function(a){var b=this,c=a[D],d=b.options.decimals;return c===D&&(c="\\"+c),d===J&&(d=a.decimals),0===d?I:(b._separator!==c&&(b._separator=c,b._floatRegExp=new RegExp("^(-)?(((\\d+("+c+"\\d*)?)|("+c+"\\d*)))?$")),b._floatRegExp)},_paste:function(a){var b=this,c=a.target,d=c.value;setTimeout(function(){b._parse(c.value)===J&&b._update(d)})},_option:function(a,c){var d=this,e=d.options;return c===b?e[a]:(c=d._parse(c),void ((c||"step"!==a)&&(e[a]=c,d.element.attr("aria-value"+a,c).attr(a,c))))},_spin:function(a,b){var c=this;b=b||500,clearTimeout(c._spinning),c._spinning=setTimeout(function(){c._spin(a,50)},b),c._step(a)},_step:function(a){var b=this,c=b.element,d=b._parse(c.val())||0;k()!=c[0]&&b._focusin(),d+=b.options.step*a,b._update(b._adjust(d)),b.trigger(u)},_toggleHover:function(b){a(b.currentTarget).toggleClass(B,"mouseenter"===b.type)},_toggleText:function(a){var b=this;b._text.toggle(a),b.element.toggle(!a)},_parse:function(a,b){return m(a,this.options.dataFormat)},_update:function(a){var b,c=this,e=c.options,f=e.dataFormat,g=e.decimals,h=c._culture(),i=c._format(f,h);g===J&&(g=i.decimals),a=c._parse(a,h),b=a!==J,b&&(a=parseFloat(p(a,g))),c._value=a=c._adjust(a),c._placeholder(d.toString(a,f,h)),b?(a=a.toString(),-1!==a.indexOf("e")&&(a=p(+a,g)),a=a.replace(D,i[D])):a="",c.element.val(a).attr("aria-valuenow",a)},_placeholder:function(a){this._text.val(a),n||a||this._text.val(this.options.placeholder)},_wrapper:function(){var b,c=this,d=c.element,e=d[0];b=d.parents(".k-numerictextbox"),b.is("span.k-numerictextbox")||(b=d.hide().wrap('<span class="k-numeric-wrap k-state-default" />').parent(),b=b.wrap("<span/>").parent()),b[0].style.cssText=e.style.cssText,e.style.width="",c.wrapper=b.addClass("k-widget k-numerictextbox").addClass(e.className).css("display",""),c._inputWrapper=a(b[0].firstChild)},_reset:function(){var b=this,c=b.element,d=c.attr("form"),e=d?a("#"+d):c.closest("form");e[0]&&(b._resetHandler=function(){setTimeout(function(){b.value(c[0].value)})},b._form=e.on("reset",b._resetHandler))}});h.plugin(L)}(window.joy.jQuery),function(a,b){function c(b){var c=b.parseFormats,d=b.dataFormat;L.normalize(b),c=a.isArray(c)?c:[c],-1===a.inArray(d,c)&&c.splice(0,0,b.dataFormat),b.parseFormats=c}function d(a){a.preventDefault()}var e=window.joy,f=e.ui,g=f.Widget,h=f.FormElement,i=e.parseDate,j=e.keys,k=e.template,l=e.support.placeholder,m=e._activeElement,n="<div />",o="<span />",p=".joyDatePicker",q="click"+p,r="open",s="close",t="change",u="disabled",v="readonly",w="k-state-default",x="k-state-focused",y="k-state-selected",z="k-state-disabled",A="k-state-hover",B="mouseenter"+p+" mouseleave"+p,C="mousedown"+p,D="id",E="min",F="max",G="day",H="aria-disabled",I="aria-expanded",J="aria-hidden",K="aria-readonly",L=e.calendar,M=(L.isInRange,L.restrictValue),N=(L.isEqualDatePart,a.extend),O=a.proxy,P=Date,Q=function(b){var c,d=this,g=document.body,h=a(n).attr(J,"true").addClass("k-calendar-container").appendTo(g);d.options=b=b||{},c=b.id,c&&(c+="_dateview",h.attr(D,c),d._dateViewID=c),d.popup=new f.Popup(h,N(b.popup,b,{name:"Popup",isRtl:e.support.isRtl(b.anchor)})),d.div=h,d.value(b.value)};Q.prototype={_calendar:function(){var b,c=this,g=c.calendar,h=c.options;g||(b=a(n).attr(D,e.guid()).appendTo(c.popup.element).on(C,d).on(q,"td:has(.k-link)",O(c._click,c)),c.calendar=g=new f.Calendar(b),c._setOptions(h),e.calendar.makeUnselectable(g.element),g.navigate(c._value||c._current,h.start),c.value(c._value))},_setOptions:function(a){this.calendar.setOptions({focusOnNav:!1,change:a.change,dates:a.dates,depth:a.depth,footer:a.footer,dataFormat:a.dataFormat,max:a.max,min:a.min,month:a.month,start:a.start})},setOptions:function(a){var b=this.options;this.options=N(b,a,{change:b.change,close:b.close,open:b.open}),this.calendar&&this._setOptions(this.options)},destroy:function(){this.popup.destroy()},open:function(){var a=this;a._calendar(),a.popup.open()},close:function(){this.popup.close()},min:function(a){this._option(E,a)},max:function(a){this._option(F,a)},toggle:function(){var a=this;a[a.popup.visible()?s:r]()},move:function(a){var b=this,c=a.keyCode,d=b.calendar,e=a.ctrlKey&&c==j.DOWN||c==j.ENTER;if(c==j.ESC){return void b.close()}if(a.altKey){return void (c==j.DOWN?(b.open(),a.preventDefault()):c==j.UP&&(b.close(),a.preventDefault()))}if(b.popup.visible()){return e&&d._cell.hasClass(y)?(b.close(),void a.preventDefault()):void (b._current=d._move(a))}},current:function(a){this._current=a,this.calendar._focus(a)},value:function(a){var b=this,c=b.calendar,d=b.options;b._value=a,b._current=new P(+M(a,d.min,d.max)),c&&c.value(a)},_click:function(a){-1!==a.currentTarget.className.indexOf(y)&&this.close()},_option:function(a,b){var c=this,d=c.calendar;c.options[a]=b,d&&d[a](b)}},Q.normalize=c,e.DateView=Q;var R=h.extend({init:function(a,b){var d,f,h=this;null!=b.depth&&null==b.start&&(b.start=b.depth),null!=b.depth&&null==b.dataFormat&&("year"==b.depth?b.dataFormat="yyyy":"month"==b.depth&&(b.dataFormat="yyyy-MM")),g.fn.init.call(h,a,b),a=h.element,b=h.options,b.min=i(a.attr("min"))||i(b.min),b.max=i(a.attr("max"))||i(b.max),c(b),h._wrapper(),h._initFormElement(),h.dateView=new Q(N({},b,{id:a.attr(D),anchor:h.wrapper,change:function(){h._change(this.value()),h.close()},close:function(b){h.trigger(s)?b.preventDefault():(a.attr(I,!1),f.attr(J,!0))},open:function(b){var c,d=h.options;h.trigger(r)?b.preventDefault():(h.element.val()!==h._oldText&&(c=i(a.val(),d.parseFormats),h.dateView[c?"current":"value"](c)),a.attr(I,!0),f.attr(J,!1),h._updateARIA(c))}})),f=h.dateView.div,h._icon();try{a[0].setAttribute("type","text")}catch(j){a[0].type="text"}a.addClass("k-input").attr({role:"combobox","aria-expanded":!1,"aria-owns":h.dateView._dateViewID}),h._reset(),h._template(),d=a.is("[disabled]"),d?h.enable(!1):h.readonly(a.is("[readonly]")),h._old=h._update(b.value||h.element.val()),h._oldText=a.val(),h._placeholder(),e.notify(h)},events:[r,s,t],options:{name:"DatePicker",value:null,footer:"",dataFormat:"",parseFormats:[],min:new Date(1900,0,1),max:new Date(2099,11,31),start:G,depth:G,animation:{},month:{},dates:[],required:!1,subject:"",label:"",placeholder:"",ARIATemplate:'Current focused date is #=joy.toString(data.current, "D")#'},setOptions:function(a){var b=this,d=b._value;null!=a.depth&&null==a.start&&(a.start=a.depth),null!=a.depth&&null==a.dataFormat&&("year"==a.depth?a.dataFormat="yyyy":"month"==a.depth&&(a.dataFormat="yyyy-MM")),g.fn.setOptions.call(b,a),a=b.options,a.min=i(a.min),a.max=i(a.max),c(a),b.dateView.setOptions(a),d&&(b.element.val(e.toString(d,a.dataFormat)),b._updateARIA(d))},_editable:function(a){var b=this,c=b._dateIcon.off(p),e=b.element.off(p),f=b._inputWrapper.off(p),g=a.readonly,h=a.disable;g||h?(f.addClass(h?z:w).removeClass(h?w:z),e.attr(u,h).attr(v,g).attr(H,h).attr(K,g)):(f.addClass(w).removeClass(z).on(B,b._toggleHover),e.removeAttr(u).removeAttr(v).attr(H,!1).attr(K,!1).on("keydown"+p,O(b._keydown,b)).on("blur"+p,O(b._blur,b)).on("focus"+p,function(){b._inputWrapper.addClass(x),e.val()==b.options.placeholder&&e.val("")}),c.on(q,O(b._click,b)).on(C,d))},readonly:function(a){this._editable({readonly:a===b?!0:a,disable:!1})},enable:function(a){this._editable({readonly:!1,disable:!(a=a===b?!0:a)})},destroy:function(){var a=this;g.fn.destroy.call(a),a.dateView.destroy(),a.element.off(p),a._dateIcon.off(p),a._inputWrapper.off(p),a._form&&a._form.off("reset",a._resetHandler)},open:function(){this.dateView.open()},close:function(){this.dateView.close()},min:function(a){return this._option(E,a)},max:function(a){return this._option(F,a)},value:function(a){var c=this,d=c.options;return a===b?""==c.element.val()||c.element.val()==c.options.placeholder?"":e.toString(c._value,d.dataFormat):(c._old=c._update(a),null===c._old&&c.element.val(""),c._oldText=c.element.val(),void c._placeholder())},_toggleHover:function(b){a(b.currentTarget).toggleClass(A,"mouseenter"===b.type)},_blur:function(){var a=this,b=a.element.val();a.close(),b!==a._oldText&&a._change(b),a._inputWrapper.removeClass(x),a._placeholder(),null!=a.parentForm&&1==a.parentForm.options.autoValidatable&&a.validate()},validate:function(){var a=this,b=a.options,c=(a.element,a.value()),d=e.getPluginLang();if(b.required&&""==c){return a.showInfo(e.format(d.form.requiredInfo,b.subject)),!1}if(""!=c){if(null==a._value){return a.showInfo(d.datepicker[b.depth+"RuleInfo"]),!1}if(a._value<b.min){return a.showInfo(e.format(d.datepicker.minInfo,e.toString(b.min,b.dataFormat))),!1}if(a._value>b.max){return a.showInfo(e.format(d.datepicker.maxInfo,e.toString(b.max,b.dataFormat))),!1}}return a.hideInfo(),!0},_click:function(){var a=this,b=a.element;a.dateView.toggle(),e.support.touch||b[0]===m()||b.focus()},_change:function(a){var b=this;a=b._update(a),null!=a&&(+b._old!=+a&&(b._old=a,b._oldText=b.element.val(),b.trigger(t),b.element.trigger(t)),b._placeholder())},_keydown:function(a){var b=this,c=b.dateView,d=b.element.val();c.popup.visible()||a.keyCode!=j.ENTER||d===b._oldText?(c.move(a),b._updateARIA(c._current)):b._change(d)},_icon:function(){var b,c=this,d=c.element;b=d.next("span.k-select"),b[0]||(b=a('<span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-calendar">select</span></span>').insertAfter(d)),c._dateIcon=b.attr({role:"button","aria-controls":c.dateView._dateViewID})},_option:function(a,c){var d=this,e=d.options;return c===b?e[a]:(c=i(c,e.parseFormats),void (c&&(e[a]=new P(+c),d.dateView[a](c))))},_update:function(a){var b,c=this,d=c.options,f=(d.min,d.max,i(a,d.parseFormats));return +f===+c._value?(b=e.toString(f,d.dataFormat),b!==a&&c.element.val(null===f?a:b),f):(c.dateView.value(f),c.element.val(f?e.toString(f,d.dataFormat):a),c._updateARIA(f),c._value=f,f)},_placeholder:function(){l||this.element.val()||this.element.val(this.options.placeholder)},_wrapper:function(){var b,c=this,d=c.element;b=d.parents(".k-datepicker"),b[0]||(b=d.wrap(o).parent().addClass("k-picker-wrap k-state-default"),b=b.wrap(o).parent()),b[0].style.cssText=d[0].style.cssText,d.css({width:"100%",height:d[0].style.height}),c.wrapper=b.addClass("k-widget k-datepicker k-header").addClass(d[0].className),c._inputWrapper=a(b[0].firstChild)},_reset:function(){var b=this,c=b.element,d=c.attr("form"),e=d?a("#"+d):c.closest("form");e[0]&&(b._resetHandler=function(){b.value(c[0].defaultValue)},b._form=e.on("reset",b._resetHandler))},_template:function(){this._ariaTemplate=k(this.options.ARIATemplate)},_updateARIA:function(a){var b,c=this,d=c.dateView.calendar;c.element.removeAttr("aria-activedescendant"),d&&(b=d._cell,b.attr("aria-label",c._ariaTemplate({current:a||d.current()})),c.element.attr("aria-activedescendant",b.attr("id")))}});f.plugin(R)}(window.joy.jQuery),function(a,b){function c(a,b,c){var d,e=a.getTimezoneOffset();a.setTime(a.getTime()+b),c||(d=a.getTimezoneOffset()-e,a.setTime(a.getTime()+d*H))}function d(){var a=new V,b=new V(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),c=new V(a.getFullYear(),a.getMonth(),a.getDate(),12,0,0);return -1*(b.getTimezoneOffset()-c.getTimezoneOffset())}function e(a){return 60*a.getHours()*H+a.getMinutes()*H+1000*a.getSeconds()+a.getMilliseconds()}function f(a,b,c){var d,f=e(b),g=e(c);return a&&f!=g?(d=e(a),f>d&&(d+=I),f>g&&(g+=I),d>=f&&g>=d):!0}function g(a){var b=a.parseFormats;a.dataFormat=m(a.dataFormat||i.getPluginLang().calendars.standard.patterns.t),b=S(b)?b:[b],b.splice(0,0,a.dataFormat),a.parseFormats=b}function h(a){a.preventDefault()}var i=window.joy,j=i.keys,k=i.parseDate,l=i._activeElement,m=i._extractFormat,n=i.support,o=i.support.placeholder,p=n.browser,q=i.ui,r=q.Widget,s=q.FormElement,t="open",u="close",v="change",w=".kendoTimePicker",x="click"+w,y="k-state-default",z="disabled",A="readonly",B="li",C="<span/>",D="k-state-focused",E="k-state-hover",F="mouseenter"+w+" mouseleave"+w,G="mousedown"+w,H=60000,I=86400000,J="k-state-selected",K="k-state-disabled",L="aria-selected",M="aria-expanded",N="aria-hidden",O="aria-disabled",P="aria-readonly",Q="aria-activedescendant",R="id",S=a.isArray,T=a.extend,U=a.proxy,V=Date,W=new V;W=new V(W.getFullYear(),W.getMonth(),W.getDate(),0,0,0),TOMORROW=new V(W.getFullYear(),W.getMonth(),W.getDate()+1,0,0,0);var X=function(b){var c=this,d=b.id;c.options=b,c.ul=a('<ul tabindex="-1" role="listbox" aria-hidden="true" unselectable="on" class="k-list k-reset"/>').css({overflow:n.kineticScrollNeeded?"":"auto"}).on(x,B,U(c._click,c)).on("mouseenter"+w,B,function(){a(this).addClass(E)}).on("mouseleave"+w,B,function(){a(this).removeClass(E)}),c.list=a("<div class='k-list-container'/>").append(c.ul).on(G,h),d&&(c._timeViewID=d+"_timeview",c._optionID=d+"_option_selected",c.ul.attr(R,c._timeViewID)),c._popup(),c.template=i.template('<li tabindex="-1" role="option" class="k-item" unselectable="on">#=data#</li>',{useWithBlock:!1})};X.prototype={current:function(c){var d=this,e=d.options.active;return c===b?d._current:(d._current&&d._current.removeClass(J).removeAttr(L).removeAttr(R),c&&(c=a(c).addClass(J).attr(R,d._optionID).attr(L,!0),d.scroll(c[0])),d._current=c,e&&e(c),void 0)},close:function(){this.popup.close()},destroy:function(){var a=this;a.ul.off(w),a.list.off(w),a._touchScroller&&a._touchScroller.destroy(),a.popup.destroy()},open:function(){var a=this;a.ul[0].firstChild||a.bind(),a.popup.open(),a._current&&a.scroll(a._current[0])},dataBind:function(a){for(var b,c=this,d=c.options,e=d.dataFormat,g=i.toString,h=c.template,j=a.length,k=0,l="";j>k;k++){b=a[k],f(b,d.min,d.max)&&(l+=h(g(b,e)))}c._html(l,j)},refresh:function(){var a,b,f,g=this,h=g.options,j=h.dataFormat,k=d(),l=0>k,m=h.min,n=h.max,o=e(m),p=e(n),q=h.step*H,r=i.toString,s=g.template,t=new V(+m),u=t.getDate(),v=0,w="";for(f=l?(I+k*H)/q:I/q,o!=p&&(o>p&&(p+=I),f=(p-o)/q+1),b=parseInt(f,10);f>v;v++){v&&c(t,q,l),p&&b==v&&(a=e(t),u<t.getDate()&&(a+=I),a>p&&(t=new V(+n))),w+=s(r(t,j))}g._html(w,f)},bind:function(){var a=this,b=a.options.dates;b&&b[0]?a.dataBind(b):a.refresh()},_html:function(a,b){var c=this;c.ul[0].innerHTML=a,c._height(b),c.current(null),c.select(c._value)},scroll:function(a){if(a){var b,c=this.ul[0],d=a.offsetTop,e=a.offsetHeight,f=c.scrollTop,g=c.clientHeight,h=d+e,i=this._touchScroller;i?(b=this.list.height(),d>b&&(d=d-b+e),i.scrollTo(0,-d)):c.scrollTop=f>d?d:h>f+g?h-g:f}},select:function(b){var c=this,d=c.options,e=c._current;b instanceof Date&&(b=i.toString(b,d.dataFormat)),"string"==typeof b&&(e&&e.text()===b?b=e:(b=a.grep(c.ul[0].childNodes,function(a){return(a.textContent||a.innerText)==b}),b=b[0]?b:null)),c.current(b)},setOptions:function(a){var b=this.options;a.min=k(a.min),a.max=k(a.max),this.options=T(b,a,{active:b.active,change:b.change,close:b.close,open:b.open}),this.bind()},toggle:function(){var a=this;a.popup.visible()?a.close():a.open()},value:function(a){var b=this;b._value=a,b.ul[0].firstChild&&b.select(a)},_click:function(b){var c=this,d=a(b.currentTarget);b.isDefaultPrevented()||(c.select(d),c.options.change(d.text(),!0),c.close())},_height:function(a){if(a){var b=this,c=b.list,d=c.parent(".k-animation-container"),e=b.options.height;c.add(d).show().height(b.ul[0].scrollHeight>e?e:"auto").hide()}},_parse:function(a){var b=this,c=b.options,d=b._value||W;return a instanceof V?a:(a=k(a,c.parseFormats),a&&(a=new V(d.getFullYear(),d.getMonth(),d.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())),a)},_adjustListWidth:function(){var a,b,c=this.list,d=c[0].style.width,e=this.options.anchor;(c.data("width")||!d)&&(a=window.getComputedStyle?window.getComputedStyle(e[0],null):0,b=a?parseFloat(a.width):e.outerWidth(),a&&(p.mozilla||p.msie)&&(b+=parseFloat(a.paddingLeft)+parseFloat(a.paddingRight)+parseFloat(a.borderLeftWidth)+parseFloat(a.borderRightWidth)),d=b-(c.outerWidth()-c.width()),c.css({fontFamily:e.css("font-family"),width:d}).data("width",d))},_popup:function(){var a=this,b=a.list,c=a.options,d=c.anchor;a.popup=new q.Popup(b,T(c.popup,{anchor:d,open:c.open,close:c.close,animation:c.animation,isRtl:n.isRtl(c.anchor)})),a._touchScroller=i.touchScroller(a.popup.element)},move:function(a){var b=this,c=a.keyCode,d=b.ul[0],e=b._current,f=c===j.DOWN;if(c===j.UP||f){if(a.altKey){return void b.toggle(f)}e=f?e?e[0].nextSibling:d.firstChild:e?e[0].previousSibling:d.lastChild,e&&b.select(e),b.options.change(b._current.text()),a.preventDefault()}else{(c===j.ENTER||c===j.TAB||c===j.ESC)&&(a.preventDefault(),e&&b.options.change(e.text(),!0),b.close())}}},X.getMilliseconds=e,i.TimeView=X;var Y=s.extend({init:function(a,b){var c,d,e,f=this;r.fn.init.call(f,a,b),a=f.element,b=f.options,b.min=k(a.attr("min"))||k(b.min),b.max=k(a.attr("max"))||k(b.max),g(b),f._wrapper(),f._initFormElement(),f.timeView=d=new X(T({},b,{id:a.attr(R),anchor:f.wrapper,dataFormat:b.dataFormat,change:function(b,c){c?f._change(b):a.val(b)},open:function(b){f.timeView._adjustListWidth(),f.trigger(t)?b.preventDefault():(a.attr(M,!0),c.attr(N,!1))},close:function(b){f.trigger(u)?b.preventDefault():(a.attr(M,!1),c.attr(N,!0))},active:function(b){a.removeAttr(Q),b&&a.attr(Q,d._optionID)}})),c=d.ul,f._icon(),f._reset();try{a[0].setAttribute("type","text")}catch(h){a[0].type="text"}a.addClass("k-input").attr({role:"combobox","aria-expanded":!1,"aria-owns":d._timeViewID}),e=a.is("[disabled]"),e?f.enable(!1):f.readonly(a.is("[readonly]")),f._old=f._update(b.value||f.element.val()),f._oldText=a.val(),f._placeholder(),i.notify(f)},options:{name:"TimePicker",min:W,max:TOMORROW,dataFormat:"",dates:[],label:"",subject:"",required:!1,parseFormats:[],value:null,step:60,height:200,placeholder:"",animation:{}},events:[t,u,v],setOptions:function(a){var b=this,c=b._value;r.fn.setOptions.call(b,a),a=b.options,g(a),b.timeView.setOptions(a),c&&b.element.val(i.toString(c,a.dataFormat))},dataBind:function(a){S(a)&&this.timeView.dataBind(a)},_editable:function(a){var b=this,c=a.disable,d=a.readonly,e=b._arrow.off(w),f=b.element.off(w),g=b._inputWrapper.off(w);d||c?(g.addClass(c?K:y).removeClass(c?y:K),f.attr(z,c).attr(A,d).attr(O,c).attr(P,d)):(g.addClass(y).removeClass(K).on(F,b._toggleHover),f.removeAttr(z).removeAttr(A).attr(O,!1).attr(P,!1).on("keydown"+w,U(b._keydown,b)).on("blur"+w,U(b._blur,b)).on("focus"+w,function(){b._inputWrapper.addClass(D),f.val()==b.options.placeholder&&f.val("")}),e.on(x,U(b._click,b)).on(G,h))},readonly:function(a){this._editable({readonly:a===b?!0:a,disable:!1})},enable:function(a){this._editable({readonly:!1,disable:!(a=a===b?!0:a)})},destroy:function(){var a=this;r.fn.destroy.call(a),a.timeView.destroy(),a.element.off(w),a._arrow.off(w),a._inputWrapper.off(w),a._form&&a._form.off("reset",a._resetHandler)},close:function(){this.timeView.close()},open:function(){this.timeView.open()},min:function(a){return this._option("min",a)},max:function(a){return this._option("max",a)},value:function(a){var c=this,d=c.options;return a===b?""==c.element.val()||c.element.val()==c.options.placeholder?"":i.toString(c._value,d.dataFormat):(c._old=c._update(a),null===c._old&&c.element.val(""),c._oldText=c.element.val(),void c._placeholder())},_blur:function(){var a=this,b=a.element.val();a.close(),b!==a._oldText&&a._change(b),a._inputWrapper.removeClass(D),a._placeholder(),null!=a.parentForm&&1==a.parentForm.options.autoValidatable&&a.validate()},validate:function(){var a=this,b=a.options,c=(a.element,a.value()),d=i.getPluginLang();if(b.required&&""==c){return a.showInfo(i.format(d.form.requiredInfo,b.subject)),!1}if(""!=c){if(null==a._value){return a.showInfo(d.datepicker.timeRuleInfo),!1}if(a._value<b.min){return a.showInfo(i.format(d.datepicker.minInfo,i.toString(b.min,b.dataFormat))),!1}if(a._value>b.max){return a.showInfo(i.format(d.datepicker.maxInfo,i.toString(b.max,b.dataFormat))),!1}}return a.hideInfo(),!0},_click:function(){var a=this,b=a.element;a.timeView.toggle(),n.touch||b[0]===l()||b.focus()},_change:function(a){var b=this;a=b._update(a),+b._old!=+a&&(b._old=a,b._oldText=b.element.val(),b.trigger(v),b.element.trigger(v)),b._placeholder()},_placeholder:function(){o||this.element.val()||this.element.val(this.options.placeholder)},_icon:function(){var b,c=this,d=c.element;b=d.next("span.k-select"),b[0]||(b=a('<span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-clock">select</span></span>').insertAfter(d)),c._arrow=b.attr({role:"button","aria-controls":c.timeView._timeViewID})
},_keydown:function(a){var b=this,c=a.keyCode,d=b.timeView,e=b.element.val();d.popup.visible()||a.altKey?d.move(a):c===j.ENTER&&e!==b._oldText&&b._change(e)},_option:function(a,c){var d=this,e=d.options;return c===b?e[a]:(c=d.timeView._parse(c),void (c&&(c=new V(+c),e[a]=c,d.timeView.options[a]=c,d.timeView.bind())))},_toggleHover:function(b){a(b.currentTarget).toggleClass(E,"mouseenter"===b.type)},_update:function(a){var b=this,c=b.options,d=b.timeView,e=d._parse(a);return b._value=e,b.element.val(e?i.toString(e,c.dataFormat):a),d.value(e),e},_wrapper:function(){var b,c=this,d=c.element;b=d.parents(".k-timepicker"),b[0]||(b=d.wrap(C).parent().addClass("k-picker-wrap k-state-default"),b=b.wrap(C).parent()),b[0].style.cssText=d[0].style.cssText,c.wrapper=b.addClass("k-widget k-timepicker k-header").addClass(d[0].className),d.css({width:"100%",height:d[0].style.height}),c._inputWrapper=a(b[0].firstChild)},_reset:function(){var b=this,c=b.element,d=c.attr("form"),e=d?a("#"+d):c.closest("form");e[0]&&(b._resetHandler=function(){b.value(c[0].defaultValue)},b._form=e.on("reset",b._resetHandler))}});q.plugin(Y)}(window.joy.jQuery),function(a,b){function c(a){var b=new Date(2100,0,1);return b.setMinutes(-a),b}function d(a){a.preventDefault()}function e(b){var c,d=f.getPluginLang().calendars.standard.patterns;b.dataFormat=j(b.dataFormat||d.g),b.timeFormat=c=j(b.timeFormat||d.t),f.DateView.normalize(b),-1===a.inArray(c,b.parseFormats)&&b.parseFormats.splice(1,0,c)}var f=window.joy,g=f.TimeView,h=f.parseDate,i=f._activeElement,j=f._extractFormat,k=f.calendar,l=f.support.placeholder,m=k.isInRange,n=(k.restrictValue,k.isEqualDatePart),o=g.getMilliseconds,p=f.ui,q=p.Widget,r=p.FormElement,s="open",t="close",u="change",v=".kendoDateTimePicker",w="click"+v,x="disabled",y="readonly",z="k-state-default",A="k-state-focused",B="k-state-hover",C="k-state-disabled",D="mouseenter"+v+" mouseleave"+v,E="mousedown"+v,F="day",G="<span/>",H="aria-activedescendant",I="aria-expanded",J="aria-hidden",K="aria-owns",L="aria-disabled",M="aria-readonly",N=Date,O=new N(1900,0,1),P=new N(2099,11,31),Q={view:"date"},R={view:"time"},S=a.extend,T=r.extend({init:function(a,b){var c,d=this;q.fn.init.call(d,a,b),a=d.element,b=d.options,b.min=h(a.attr("min"))||h(b.min),b.max=h(a.attr("max"))||h(b.max),e(b),d._wrapper(),d._initFormElement(),d._views(),d._icons(),d._reset(),d._template();try{a[0].setAttribute("type","text")}catch(g){a[0].type="text"}a.addClass("k-input").attr({role:"combobox","aria-expanded":!1}),d._midnight=o(b.min)+o(b.max)===0,c=a.is("[disabled]"),c?d.enable(!1):d.readonly(a.is("[readonly]")),d._old=d._update(b.value||d.element.val()),d._oldText=a.val(),d._placeholder(),f.notify(d)},options:{name:"DateTimePicker",value:null,dataFormat:"",timeFormat:"",culture:"",parseFormats:[],dates:[],subject:"",required:!1,label:"",min:new N(O),max:new N(P),step:60,height:200,footer:"",start:F,depth:F,animation:{},month:{},placeholder:"",ARIATemplate:'Current focused date is #=joy.toString(data.current, "d")#'},events:[s,t,u],setOptions:function(a){var b,c,d,g=this,i=g._value;g.dateView.options,g.timeView.options;q.fn.setOptions.call(g,a),a=g.options,a.min=b=h(a.min),a.max=c=h(a.max),e(a),d=a.value||g._value||g.dateView._current,b&&!n(b,d)&&(b=new N(O)),c&&!n(c,d)&&(c=new N(P)),g.dateView.setOptions(a),g.timeView.setOptions(S({},a,{dataFormat:a.timeFormat,min:b,max:c})),i&&(g.element.val(f.toString(i,a.dataFormat,a.culture)),g._updateARIA(i))},_editable:function(b){var c=this,e=c.element.off(v),g=c._dateIcon.off(v),h=c._timeIcon.off(v),j=c._inputWrapper.off(v),k=b.readonly,l=b.disable;k||l?(j.addClass(l?C:z).removeClass(l?z:C),e.attr(x,l).attr(y,k).attr(L,l).attr(M,k)):(j.addClass(z).removeClass(C).on(D,c._toggleHover),e.removeAttr(x).removeAttr(y).attr(L,!1).attr(M,!1).on("keydown"+v,a.proxy(c._keydown,c)).on("focus"+v,function(){c._inputWrapper.addClass(A),e.val()==c.options.placeholder&&e.val("")}).on("blur"+v,function(){c._inputWrapper.removeClass(A),e.val()!==c._oldText&&c._change(e.val()),c.close("date"),c.close("time"),c._placeholder(),null!=c.parentForm&&1==c.parentForm.options.autoValidatable&&c.validate()}),g.on(E,d).on(w,function(){c.toggle("date"),f.support.touch||e[0]===i()||e.focus()}),h.on(E,d).on(w,function(){c.toggle("time"),f.support.touch||e[0]===i()||e.focus()}))},readonly:function(a){this._editable({readonly:a===b?!0:a,disable:!1})},enable:function(a){this._editable({readonly:!1,disable:!(a=a===b?!0:a)})},destroy:function(){var a=this;q.fn.destroy.call(a),a.dateView.destroy(),a.timeView.destroy(),a.element.off(v),a._dateIcon.off(v),a._timeIcon.off(v),a._inputWrapper.off(v),a._form&&a._form.off("reset",a._resetHandler)},close:function(a){"time"!==a&&(a="date"),this[a+"View"].close()},open:function(a){"time"!==a&&(a="date"),this[a+"View"].open()},min:function(a){return this._option("min",a)},max:function(a){return this._option("max",a)},toggle:function(a){var b="timeView";"time"!==a?a="date":b="dateView",this[a+"View"].toggle(),this[b].close()},validate:function(){var a=this,b=a.options,c=(a.element,a.value()),d=f.getPluginLang();if(b.required&&""==c){return a.showInfo(f.format(d.form.requiredInfo,b.subject)),!1}if(""!=c){if(null==a._value){return a.showInfo(d.datepicker.dayTimeRuleInfo),!1}if(a._value<b.min){return a.showInfo(f.format(d.datepicker.minInfo,f.toString(b.min,b.dataFormat))),!1}if(a._value>b.max){return a.showInfo(f.format(d.datepicker.maxInfo,f.toString(b.max,b.dataFormat))),!1}}return a.hideInfo(),!0},value:function(a){var c=this,d=c.options;return a===b?""==c.element.val()||c.element.val()==c.options.placeholder?"":f.toString(c._value,d.dataFormat):(c._old=c._update(a),null===c._old&&c.element.val(""),c._oldText=c.element.val(),void c._placeholder())},_change:function(a){var b=this;a=b._update(a),+b._old!=+a&&(b._old=a,b._oldText=b.element.val(),b.trigger(u),b.element.trigger(u)),b._placeholder()},_placeholder:function(){l||this.element.val()||this.element.val(this.options.placeholder)},_option:function(a,d){var e,f,g=this,i=g.options,j=g.timeView,k=j.options,l=g._value||g._old;if(d===b){return i[a]}if(d=h(d,i.parseFormats,i.culture)){if(i.min.getTime()===i.max.getTime()&&(k.dates=[]),i[a]=new N(d.getTime()),g.dateView[a](d),g._midnight=o(i.min)+o(i.max)===0,l&&(e=n(i.min,l),f=n(i.max,l)),e||f){if(k[a]=d,e&&!f&&(k.max=c(i.step)),f){if(g._midnight){return void j.dataBind([P])}e||(k.min=O)}}else{k.max=P,k.min=O}j.bind()}},_toggleHover:function(b){a(b.currentTarget).toggleClass(B,"mouseenter"===b.type)},_update:function(b){var d,e,g,i,j,k=this,l=k.options,m=l.min,o=l.max,p=l.dates,q=k.timeView,r=h(b,l.parseFormats,l.culture);return +r===+k._value?(j=f.toString(r,l.dataFormat,l.culture),j!==b&&k.element.val(null===r?b:j),r):(k._value=r,q.value(r),k.dateView.value(r),r&&(g=k._old,e=q.options,p[0]&&(p=a.grep(p,function(a){return n(r,a)}),p[0]&&(q.dataBind(p),i=!0)),i||(n(r,m)&&(e.min=m,e.max=c(l.step),d=!0),n(r,o)&&(k._midnight?(q.dataBind([P]),i=!0):(e.max=o,d||(e.min=O),d=!0))),!i&&(!g&&d||g&&!n(g,r))&&(d||(e.max=P,e.min=O),q.bind())),k.element.val(r?f.toString(r,l.dataFormat,l.culture):b),k._updateARIA(r),r)},_keydown:function(a){var b=this,c=b.dateView,d=b.timeView,e=b.element.val(),g=c.popup.visible();a.altKey&&a.keyCode===f.keys.DOWN?b.toggle(g?"time":"date"):g?(c.move(a),b._updateARIA(c._current)):d.popup.visible()?d.move(a):a.keyCode===f.keys.ENTER&&e!==b._oldText&&b._change(e)},_views:function(){var a,b,c,d,e,i,j=this,k=j.element,l=j.options,n=k.attr("id");j.dateView=a=new f.DateView(S({},l,{id:n,anchor:j.wrapper,change:function(){var b,c=a.calendar.value(),d=+c,e=+l.min,f=+l.max;(d===e||d===f)&&(b=new N(+j._value),b.setFullYear(c.getFullYear(),c.getMonth(),c.getDate()),m(b,e,f)&&(c=b)),j._change(c),j.close("date")},close:function(a){j.trigger(t,Q)?a.preventDefault():(k.attr(I,!1),c.attr(J,!0),b.popup.visible()||k.removeAttr(K))},open:function(b){j.trigger(s,Q)?b.preventDefault():(j.element.val()!==j._oldText&&(i=h(k.val(),l.parseFormats,l.culture),j.dateView[i?"current":"value"](i)),c.attr(J,!1),k.attr(I,!0).attr(K,a._dateViewID),j._updateARIA(i))}})),c=a.div,e=l.min.getTime(),j.timeView=b=new g({id:n,value:l.value,anchor:j.wrapper,animation:l.animation,dataFormat:l.timeFormat,culture:l.culture,height:l.height,step:l.step,min:new N(O),max:new N(P),dates:e===l.max.getTime()?[new Date(e)]:[],parseFormats:l.parseFormats,change:function(c,d){c=b._parse(c),c<l.min?(c=new N(+l.min),b.options.min=c):c>l.max&&(c=new N(+l.max),b.options.max=c),d?(j._timeSelected=!0,j._change(c)):(k.val(f.toString(c,l.dataFormat,l.culture)),a.value(c),j._updateARIA(c))},close:function(b){j.trigger(t,R)?b.preventDefault():(d.attr(J,!0),k.attr(I,!1),a.popup.visible()||k.removeAttr(K))},open:function(a){b._adjustListWidth(),j.trigger(s,R)?a.preventDefault():(d.attr(J,!1),k.attr(I,!0).attr(K,b._timeViewID),b.options.active(b.current()))},active:function(a){k.removeAttr(H),a&&k.attr(H,b._optionID)}}),d=b.ul},_icons:function(){var b,c=this,d=c.element;b=d.next("span.k-select"),b[0]||(b=a('<span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-calendar">select</span><span unselectable="on" class="k-icon k-i-clock">select</span></span>').insertAfter(d)),b=b.children(),c._dateIcon=b.eq(0).attr({role:"button","aria-controls":c.dateView._dateViewID}),c._timeIcon=b.eq(1).attr({role:"button","aria-controls":c.timeView._timeViewID})},_wrapper:function(){var b,c=this,d=c.element;b=d.parents(".k-datetimepicker"),b[0]||(b=d.wrap(G).parent().addClass("k-picker-wrap k-state-default"),b=b.wrap(G).parent()),b[0].style.cssText=d[0].style.cssText,d.css({width:"100%",height:d[0].style.height}),c.wrapper=b.addClass("k-widget k-datetimepicker k-header").addClass(d[0].className),c._inputWrapper=a(b[0].firstChild)},_reset:function(){var b=this,c=b.element,d=c.attr("form"),e=d?a("#"+d):c.closest("form");e[0]&&(b._resetHandler=function(){b.value(c[0].defaultValue)},b._form=e.on("reset",b._resetHandler))},_template:function(){this._ariaTemplate=f.template(this.options.ARIATemplate)},_updateARIA:function(a){var b,c=this,d=c.dateView.calendar;c.element.removeAttr(H),d&&(b=d._cell,b.attr("aria-label",c._ariaTemplate({current:a||d.current()})),c.element.attr(H,b.attr("id")))}});p.plugin(T)}(window.joy.jQuery),function(a,b){function c(b){var c,d=h.ui.validator.ruleResolvers||{},e={};for(c in d){a.extend(!0,e,d[c].resolve(b))}return e}function d(a){return a.replace(/&amp/g,"&amp;").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">")}function e(a){return a=(a+"").split("."),a.length>1?a[1].length:0}function f(b){return a(a.parseHTML?a.parseHTML(b):b)}function g(b,c){for(var d,e,f=a(),g=0,i=b.length;i>g;g++){d=b[g],l.test(d.className)&&(e=d.getAttribute(h.attr("for")),e===c&&(f=f.add(d)))}return f}var h=window.joy,i=h.ui.Widget,j=".joyValidator",k="k-invalid-msg",l=new RegExp(k,"i"),m="k-invalid",n=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,o=/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,p=":input:not(:button,[type=submit],[type=reset],[disabled],[readonly])",q=":checkbox:not([disabled],[readonly])",r="[type=number],[type=range]",s="blur",t="name",u="form",v="novalidate",w=a.proxy,x=function(a,b){return"string"==typeof b&&(b=new RegExp("^(?:"+b+")$")),b.test(a)},y=function(a,b,c){var d=a.val();return a.filter(b).length&&""!==d?x(d,c):!0},z=function(a,b){return a.length?null!=a[0].attributes[b]:!1};h.ui.validator||(h.ui.validator={rules:{},messages:{}});var A=i.extend({init:function(b,d){var e=this,f=c(b);d=d||{},d.rules=a.extend({},h.ui.validator.rules,f.rules,d.rules),d.messages=a.extend({},h.ui.validator.messages,f.messages,d.messages),i.fn.init.call(e,b,d),e._errorTemplate=h.template(e.options.errorTemplate),e.element.is(u)&&e.element.attr(v,v),e._errors={},e._attachEvents()},events:["validate"],options:{name:"Validator",errorTemplate:'<span class="k-widget k-tooltip k-tooltip-validation"><span class="k-icon k-warning"> </span> #=message#</span>',messages:{required:"{0} is required",pattern:"{0} is not valid",min:"{0} should be greater than or equal to {1}",max:"{0} should be smaller than or equal to {1}",step:"{0} is not valid",email:"{0} is not valid email",url:"{0} is not valid URL",date:"{0} is not valid date"},rules:{required:function(a){var b=a.filter("[type=checkbox]").length&&!a.is(":checked"),c=a.val();return !(z(a,"required")&&(""===c||!c||b))},pattern:function(a){return a.filter("[type=text],[type=email],[type=url],[type=tel],[type=search],[type=password]").filter("[pattern]").length&&""!==a.val()?x(a.val(),a.attr("pattern")):!0},min:function(a){if(a.filter(r+",["+h.attr("type")+"=number]").filter("[min]").length&&""!==a.val()){var b=parseFloat(a.attr("min"))||0,c=h.parseFloat(a.val());return c>=b}return !0},max:function(a){if(a.filter(r+",["+h.attr("type")+"=number]").filter("[max]").length&&""!==a.val()){var b=parseFloat(a.attr("max"))||0,c=h.parseFloat(a.val());return b>=c}return !0},step:function(a){if(a.filter(r+",["+h.attr("type")+"=number]").filter("[step]").length&&""!==a.val()){var b,c=parseFloat(a.attr("min"))||0,d=parseFloat(a.attr("step"))||1,f=parseFloat(a.val()),g=e(d);return g?(b=Math.pow(10,g),(f-c)*b%(d*b)/Math.pow(100,g)===0):(f-c)%d===0}return !0},email:function(a){return y(a,"[type=email],["+h.attr("type")+"=email]",n)},url:function(a){return y(a,"[type=url],["+h.attr("type")+"=url]",o)},date:function(a){return a.filter("[type^=date],["+h.attr("type")+"=date]").length&&""!==a.val()?null!==h.parseDate(a.val(),a.attr(h.attr("format"))):!0}},validateOnBlur:!0},destroy:function(){i.fn.destroy.call(this),this.element.off(j)},_submit:function(a){return this.validate()?!0:(a.stopPropagation(),a.stopImmediatePropagation(),a.preventDefault(),!1)},_attachEvents:function(){var b=this;b.element.is(u)&&b.element.on("submit"+j,w(b._submit,b)),b.options.validateOnBlur&&(b.element.is(p)?(b.element.on(s+j,function(){b.validateInput(b.element)}),b.element.is(q)&&b.element.on("click"+j,function(){b.validateInput(b.element)})):(b.element.on(s+j,p,function(){b.validateInput(a(this))}),b.element.on("click"+j,q,function(){b.validateInput(a(this))})))},validate:function(){var a,b,c,d=!1;if(this._errors={},this.element.is(p)){d=this.validateInput(this.element)}else{var e=!1;for(a=this.element.find(p),b=0,c=a.length;c>b;b++){this.validateInput(a.eq(b))||(e=!0)}d=!e}return this.trigger("validate",{valid:d}),d},validateInput:function(b){b=a(b);var c,e=this,g=e._errorTemplate,h=e._checkValidity(b),i=h.valid,j="."+k,l=b.attr(t)||"",n=e._findMessageContainer(l).add(b.next(j)).hide();if(b.removeAttr("aria-invalid"),!i){c=e._extractMessage(b,h.key),e._errors[l]=c;var o=f(g({message:d(c)}));e._decorateMessageContainer(o,l),n.replaceWith(o).length||o.insertAfter(b),o.show(),b.attr("aria-invalid",!0)}return b.toggleClass(m,!i),i},hideMessages:function(){var a=this,b="."+k,c=a.element;c.is(p)?c.next(b).hide():c.find(b).hide()},_findMessageContainer:function(b){for(var c,d=h.ui.validator.messageLocators,e=a(),f=0,i=this.element.length;i>f;f++){e=e.add(g(this.element[f].getElementsByTagName("*"),b))}for(c in d){e=e.add(d[c].locate(this.element,b))}return e},_decorateMessageContainer:function(a,b){var c,d=h.ui.validator.messageLocators;a.addClass(k).attr(h.attr("for"),b||"");for(c in d){d[c].decorate(a,b)}a.attr("role","alert")},_extractMessage:function(a,b){var c=this,d=c.options.messages[b],e=a.attr(t);return d=h.isFunction(d)?d(a):d,h.format(a.attr(h.attr(b+"-msg"))||a.attr("validationMessage")||a.attr("title")||d||"",e,a.attr(b))},_checkValidity:function(a){var b,c=this.options.rules;for(b in c){if(!c[b](a)){return{valid:!1,key:b}}}return{valid:!0}},errors:function(){var a,b=[],c=this._errors;for(a in c){b.push(c[a])}return b}});h.ui.plugin(A)}(jQuery),function(a,b){function c(a,b,c){for(var d,e=0,f=b.length-1;f>e;++e){d=b[e],d in a||(a[d]={}),a=a[d]}a[b[f]]=c}var d=window.joy,e=d.ui,f=e.Select,g=d.support.mobileOS,h=".joyDropDownList",i="disabled",j="readonly",k="change",l="k-state-focused",m="k-state-default",n="k-state-disabled",o="aria-disabled",p="aria-readonly",q="k-state-selected",r="mouseenter"+h+" mouseleave"+h,s="tabindex",t=a.proxy,u=f.extend({init:function(c,e){var g,i,j,k=this,l=e&&e.index;k.ns=h,e=a.isArray(e)?{dataSource:e}:e,f.fn.init.call(k,c,e),k._focusHandler=function(){k.wrapper.focus()},e=k.options,c=k.element.on("focus"+h,k._focusHandler),this._inputTemplate(),k._reset(),k._word="",k._wrapper(),k._tabindex(),k.wrapper.data(s,k.wrapper.attr(s)),k._aria(),k._span(),k._popup(),k._mobile(),k._dataSource(),k._ignoreCase(),k._enable(),k._oldIndex=k.selectedIndex=-1,k._cascade(),l!==b&&(e.index=l),e.autoBind?k.dataSource.fetch():-1===k.selectedIndex&&(j=e.text||"",j||(g=e.optionLabel,i=g&&0===e.index,k._isSelect?j=i?g:c.children(":selected").text():!c[0].value&&i&&(j=g)),k._textAccessor(j)),d.notify(k)},options:{name:"DropDownList",enabled:!0,autoBind:!0,index:0,text:null,value:null,template:"",valueTemplate:"",delay:500,height:200,dataTextField:"",dataValueField:"",optionLabel:"",cascadeFrom:"",cascadeFromField:"",ignoreCase:!0,animation:{}},events:["open","close",k,"select","dataBinding","dataBound","cascade"],setOptions:function(a){f.fn.setOptions.call(this,a),this._template(),this._inputTemplate(),this._accessors(),this._aria()},destroy:function(){var a=this;a.wrapper.off(h),a.element.off(h),a._inputWrapper.off(h),f.fn.destroy.call(a)},open:function(){var a=this;a.ul[0].firstChild?(a.popup.open(),a._scroll(a._current)):(a._open=!0,a._request||a.dataSource.fetch())},toggle:function(a){this._toggle(a)},refresh:function(){var a,b=this,c=b._data(),e=c.length,f=b.options.optionLabel,g=b.element[0];b.trigger("dataBinding"),b._current&&b.current(null),b.ul[0].innerHTML=d.render(b.template,c),b._height(e),b.popup.visible()&&b.popup._position(),b._isSelect&&(a=g.selectedIndex,f&&e&&(f='<option value="">'+b._optionLabelText(f)+"</option>"),b._options(c,f),g.selectedIndex=-1===a?0:a),b._open&&(b._open=!1,b.toggle(!!e)),b._hideBusy(),b._makeUnselectable(),b._fetch||(e?b._selectItem():b._textAccessor()!==f&&(b.element.val(""),b._textAccessor(""))),b._bound=!!e,b.trigger("dataBound")},search:function(a){if(a){var c=this,d=c.options.ignoreCase;d&&(a=a.toLowerCase()),c._select(function(e){var f=c._text(e);return f!==b?(f+="",d&&(f=f.toLowerCase()),0===f.indexOf(a)):void 0})}},text:function(a){var c,d,e=this,f=e.options.ignoreCase;return a=null===a?"":a,a===b?e._textAccessor():("string"==typeof a&&(d=f?a.toLowerCase():a,c=e._select(function(a){return a=e._text(a),f&&(a=(a+"").toLowerCase()),a===d}),c&&(a=c)),void e._textAccessor(a))},value:function(a){var c,d,e=this;return a===b?e._accessor():(null!==a&&(a=a.toString()),e._selectedValue=a,d=a||e.options.optionLabel&&!e.element[0].disabled&&""===a,d&&e._fetchItems(a)||(c=e._index(a),e.selet&&e.select(c>-1?c:0)),void 0)},_editable:function(a){var b=this,c=b.element,e=a.disable,f=a.readonly,g=b.wrapper.off(h),k=b._inputWrapper.off(r),q=function(){k.addClass(l),b._blured=!1},u=function(){if(!b._blured){b._triggerCascade();var a=window.self!==window.top;d.support.mobileOS.ios&&a?b._change():b._blur(),k.removeClass(l),b._blured=!0,c.blur()}};f||e?(e?(g.removeAttr(s),k.addClass(n).removeClass(m)):(k.addClass(m).removeClass(n),g.on("focusin"+h,q).on("focusout"+h,u)),c.attr(i,e).attr(j,f),g.attr(o,e).attr(p,f)):(c.removeAttr(i).removeAttr(j),k.addClass(m).removeClass(n).on(r,b._toggleHover),g.attr(s,g.data(s)).attr(o,!1).attr(p,!1).on("click"+h,function(a){b._blured=!1,a.preventDefault(),b.toggle()}).on("keydown"+h,t(b._keydown,b)).on("keypress"+h,t(b._keypress,b)).on("focusin"+h,q).on("focusout"+h,u))},_accept:function(a){this._focus(a)},_optionLabelText:function(){var a=this.options,b=a.dataTextField,c=a.optionLabel;return c&&b&&"object"==typeof c?this._text(c):c},_data:function(){var a=this,b=a.options,e=b.optionLabel,f=b.dataTextField,g=b.dataValueField,h=a.dataSource.view(),i=h.length,j=e,k=0;if(e&&i){for("object"==typeof e?j=e:f&&(j={},f=f.split("."),g=g.split("."),c(j,g,""),c(j,f,e)),j=new d.data.ObservableArray([j]);i>k;k++){j.push(h[k])}h=j}return h},_selectItem:function(){f.fn._selectItem.call(this),this.current()||this.select&&this.select(0)},_keydown:function(a){var b=this,c=a.keyCode,e=d.keys,f=b.ul[0];c===e.LEFT?c=e.UP:c===e.RIGHT&&(c=e.DOWN),a.keyCode=c,b._move(a),c===e.HOME?(a.preventDefault(),b._select(f.firstChild)):c===e.END&&(a.preventDefault(),b._select(f.lastChild))},_selectNext:function(a,b){for(var c,d=this,e=b,f=d._data(),g=f.length,h=d.options.ignoreCase,i=function(b,c){return b+="",h&&(b=b.toLowerCase()),0===b.indexOf(a)?(d._select(c),d._triggerEvents(),!0):void 0};g>b;b++){if(c=d._text(f[b]),c&&i(c,b)){return !0}}if(e>0){for(console.log(e),b=0;e>=b;b++){if(c=d._text(f[b]),c&&i(c,b)){return !0}}}return !1},_keypress:function(a){if(0!==a.which&&a.keyCode!==d.keys.ENTER){var b=this,c=String.fromCharCode(a.charCode||a.keyCode),e=b.selectedIndex,f=b._word;b.options.ignoreCase&&(c=c.toLowerCase())," "===c&&a.preventDefault(),b._last===c&&f.length<=1&&e>-1&&(f||(f=c),b._selectNext(f,e+1))||(b._word=f+c,b._last=c,b._search())}},_popup:function(){f.fn._popup.call(this),this.popup.one("open",t(function(){var a=this.popup;a.wrapper=d.wrap(a.element),a.element.closest(".km-root")[0]&&(a.wrapper.addClass("km-popup km-widget"),this.wrapper.addClass("km-widget"))},this))},_search:function(){var a=this,b=a.dataSource,c=a.selectedIndex,d=a._word;return clearTimeout(a._typing),a._typing=setTimeout(function(){a._word=""},a.options.delay),-1===c&&(c=0),a.ul[0].firstChild?(a._selectNext(d,c),void a._triggerEvents()):void b.one(k,function(){b.data()[0]&&c>-1&&a._selectNext(d,c)}).fetch()},_select:function(a){var c,d,f=this,g=f._current,h=null;return a=f._get(a),a&&a[0]&&!a.hasClass(q)&&(g&&g.removeClass(q),d=e.List.inArray(a[0],f.ul[0]),d>-1&&(h=f._data()[d],c=f._value(h),f.selectedIndex=d,f._textAccessor(h),f._accessor(c!==b?c:f._text(h),d),f._selectedValue=f._accessor(),f.current(a.addClass(q)),f._optionID&&f._current.attr("aria-selected",!0))),h},_triggerEvents:function(){this.popup.visible()||(this._triggerCascade(),this._change())},_mobile:function(){var a=this,b=a.popup,c=b.element.parents(".km-root").eq(0);c.length&&g&&(b.options.animation.open.effects=g.android||g.meego?"fadeIn":g.ios||g.wp?"slideIn:up":b.options.animation.open.effects)},_span:function(){var b,c=this,d=c.wrapper,e="span.k-input";b=d.find(e),b[0]||(d.append('<span unselectable="on" class="k-dropdown-wrap k-state-default"><span unselectable="on" class="k-input">&nbsp;</span><span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span></span>').append(c.element),b=d.find(e)),c.span=b,c._inputWrapper=a(d[0].firstChild),c._arrow=d.find(".k-icon").mousedown(function(a){a.preventDefault()})},_wrapper:function(){var a,b=this,c=b.element,d=c[0];a=c.parent(),a.is("span.k-widget")||(a=c.wrap("<span />").parent(),a[0].style.cssText=d.style.cssText),c.hide(),b._focused=b.wrapper=a.addClass("k-widget k-dropdown k-header").addClass(d.className).css("display","").attr({unselectable:"on",role:"listbox","aria-haspopup":!0,"aria-expanded":!1})},_clearSelection:function(){var a=this,b=a.options.optionLabel;return a.options.value="",a._selectedValue="",a.dataSource.view()[0]&&(b||a._userTriggered)?void a.select(0):(a.selectedIndex=-1,a.element.val(""),void a._textAccessor(a.options.optionLabel))},_inputTemplate:function(){var b=this,c=b.options.valueTemplate;c=c?d.template(c):a.proxy(d.template("#:this._text(data)#",{useWithBlock:!1}),b),b.valueTemplate=c},_textAccessor:function(e){var f=this.dataItem(),g=this.options,h=this.span;return e===b?h.text():(a.isPlainObject(e)||e instanceof d.data.ObservableObject?f=e:f&&this._text(f)===e||(g.dataTextField?(f={},c(f,g.dataTextField.split("."),e),c(f,g.dataValueField.split("."),this._accessor())):f=e),void h.html(this.valueTemplate(f)))}});e.plugin(u)}(window.joy.jQuery),function($,undefined){var joy=window.joy,caret=joy.caret,keys=joy.keys,ui=joy.ui,placeholderSupported=joy.support.placeholder,Widget=ui.Widget,FormElement=joy.ui.FormElement,ns=".joyTextBox",proxy=$.proxy,joyLang=joy.getPluginLang(),lang=joy.getLang(),INPUT_EVENT_NAME=(joy.support.propertyChangeEvent?"propertychange":"input")+ns,STATEDISABLED="k-state-disabled",DISABLED="disabled",READONLY="readonly",CHANGE="change",TextBox=FormElement.extend({init:function(a,b){var c,d=this;Widget.fn.init.call(d,a,b),d._rules=$.extend({},d.rules,d.options.rules),a=d.element,c=a[0],d.wrapper=a,d._tokenize(),d._reset(),d._initFormElement(),d.element.addClass("k-textbox").attr("autocomplete","off").on("focus"+ns,function(){d._oldValue=c.value,a.val()==d.options.placeholder&&a.val(""),a.val()?d._timeoutId=setTimeout(function(){a.select()}):c.value=d._old=d._emptyMask}).on("blur"+ns,function(){clearTimeout(d._timeoutId),a.val()===d._emptyMask&&(c.value=d._old=""),d._placeholder(),d._change(),d._blur()});var e=a.is("[disabled]");e?d.enable(!1):d.readonly(a.is("[readonly]")),d.options.enable||d.enable(!1),d.value(d.options.value||a.val()),joy.notify(d)},options:{name:"TextBox",promptChar:"_",required:!1,maxByte:"",minByte:"",placeholder:"",dataRule:"",dataRuleInfo:"",culture:"",rules:{},value:"",subject:"",label:"",dataFormat:"",dataType:"",enable:!0},dataTypeDefine:{email:{dataRule:/^(()|[a-zA-Z0-9\.\!\#\$\%\&\'\*\+\-\/\=\?\^\_\`\{\}\~]+\@[a-zA-Z0-9\!\#\$\%\&\'\*\+\-\/\=\?\^\_\`\{\}\~]+(\.[a-zA-Z0-9]+)+)$/,dataRuleInfo:joyLang.textbox.email,dataFormat:""},postCode:{dataRule:joyLang.textbox.postCodeRule,dataRuleInfo:joyLang.textbox.postCode,dataFormat:""},tel:{dataRule:joyLang.textbox.telRule,dataRuleInfo:joyLang.textbox.tel,dataFormat:""},mobileTel:{dataRule:joyLang.textbox.mobileTelRule,dataRuleInfo:joyLang.textbox.mobileTel,dataFormat:""},idCard:{dataRule:joyLang.textbox.idCardRule,dataRuleInfo:joyLang.textbox.idCard,dataFormat:""},entCode:{dataRule:joyLang.textbox.entCodeRule,dataRuleInfo:joyLang.textbox.entCode,dataFormat:""},IP:{dataRule:/^((?:(?:25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))\.){3}(?:25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d))))$/,dataRuleInfo:joyLang.textbox.IP,dataFormat:""},numCode:{dataRule:joyLang.textbox.numCodeRule,dataRuleInfo:joyLang.textbox.numCode,dataFormat:""}},events:[CHANGE],rules:{0:/\d/,9:/\d|\s/,"#":/\d|\s|\+|\-/,L:/[a-zA-Z]/,"?":/[a-zA-Z]|\s/,"&":/\S/,C:/./,A:/[a-zA-Z0-9]/,a:/[a-zA-Z0-9]|\s/},setOptions:function(a){var b=this;Widget.fn.setOptions.call(b,a),b._rules=$.extend({},b.rules,b.options.rules),b._tokenize(),this._unbindInput(),this._bindInput(),b.value(b.element.val())},_placeholder:function(){placeholderSupported||this.element.val()||this.element.val(this.options.placeholder)},destroy:function(){var a=this;a.element.off(ns),a._form&&a._form.off("reset",a._resetHandler),Widget.fn.destroy.call(a)},value:function(a){var b=this.element,c=this._emptyMask;return a===undefined?b.val()==this.options.placeholder?"":this.element.val():c?(a=this._unmask(a+""),b.val(a?c:""),this._mask(0,this._maskLength,a),joy._activeElement()!==b&&b.val()===c&&b.val(""),void that._placeholder()):(b.val(a),void this._placeholder())},readonly:function(a){this._editable({readonly:a===undefined?!0:a,disable:!1})},enable:function(a){this._editable({readonly:!1,disable:!(a=a===undefined?!0:a)})},_bindInput:function(){var a=this;a._maskLength&&a.element.on("keydown"+ns,proxy(a._keydown,a)).on("keypress"+ns,proxy(a._keypress,a)).on("paste"+ns,proxy(a._paste,a)).on(INPUT_EVENT_NAME,proxy(a._propertyChange,a))},_unbindInput:function(){this.element.off("keydown"+ns).off("keypress"+ns).off("paste"+ns).off(INPUT_EVENT_NAME)},_editable:function(a){var b=this,c=b.element,d=a.disable,e=a.readonly;b._unbindInput(),e||d?c.attr(DISABLED,d).attr(READONLY,e).toggleClass(STATEDISABLED,d):(c.removeAttr(DISABLED).removeAttr(READONLY).removeClass(STATEDISABLED),b._bindInput())},_change:function(){var a=this,b=a.value();b!==a._oldValue&&(a._oldValue=b,a.trigger(CHANGE),a.element.trigger(CHANGE))},_propertyChange:function(){var a,b,c=this,d=c.element[0],e=d.value;e===c._old||c._pasting||(b=caret(d)[0],a=c._unmask(e.substring(b),b),d.value=c._old=e.substring(0,b)+c._emptyMask.substring(b),c._mask(b,b,a),caret(d,b))},_paste:function(a){var b=this,c=a.target,d=caret(c),e=d[0],f=d[1],g=b._unmask(c.value.substring(f),f);b._pasting=!0,setTimeout(function(){var a=c.value,d=a.substring(e,caret(c)[0]);c.value=b._old=a.substring(0,e)+b._emptyMask.substring(e),b._mask(e,e,d),e=caret(c)[0],b._mask(e,e,g),caret(c,e),b._pasting=!1})},_reset:function(){var a=this,b=a.element,c=b.attr("form"),d=c?$("#"+c):b.closest("form");d[0]&&(a._resetHandler=function(){setTimeout(function(){a.value(b[0].value)})},a._form=d.on("reset",a._resetHandler))},_keydown:function(a){var b,c=a.keyCode,d=this.element[0],e=caret(d),f=e[0],g=e[1],h=c===keys.BACKSPACE;h||c===keys.DELETE?(f===g&&(h?f-=1:g+=1,b=this._find(f,h)),b!==undefined&&b!==f?(h&&(b+=1),caret(d,b)):f>-1&&this._mask(f,g,"",h),a.preventDefault()):c===keys.ENTER&&(this._change(),a.preventDefault())},_keypress:function(a){if(0!==a.which){var b=caret(this.element);this._mask(b[0],b[1],String.fromCharCode(a.which)),a.preventDefault()}},_find:function(a,b){var c=this.element.val()||this._emptyMask,d=1;for(b===!0&&(d=-1);a>-1||a<=this._maskLength;){if(c.charAt(a)!==this.tokens[a]){return a}a+=d}return -1},_mask:function(a,b,c,d){var e,f,g,h,i=this.element[0],j=i.value||this._emptyMask,k=this.options.promptChar,l=0;for(a=this._find(a,d),a>b&&(b=a),f=this._unmask(j.substring(b),b),c=this._unmask(c,a),e=c.length,c&&(f=f.replace(new RegExp("^_{0,"+e+"}"),"")),c+=f,j=j.split(""),g=c.charAt(l);a<this._maskLength;){j[a]=g||k,g=c.charAt(++l),h===undefined&&l>e&&(h=a),a=this._find(a+1)}i.value=this._old=j.join(""),joy._activeElement()===i&&(h===undefined&&(h=this._maskLength),caret(i,h))},_unmask:function(a,b){if(!a){return""}a=(a+"").split("");for(var c,d,e=0,f=b||0,g=this.options.promptChar,h=a.length,i=this.tokens.length,j="";i>f&&(c=a[e],d=this.tokens[f],c===d||c===g?(j+=c===g?g:"",e+=1,f+=1):"string"!=typeof d?((d.test&&d.test(c)||$.isFunction(d)&&d(c))&&(j+=c,f+=1),e+=1):f+=1,!(e>=h));){}return j
},_tokenize:function(){for(var a,b,c=[],d=0,e=this.options.dataFormat||"",f=e.split(""),g=f.length,h=0,i="",j=this.options.promptChar,k=joyLang.numberFormat,l=this._rules;g>h;h++){if(a=f[h],b=l[a]){c[d]=b,i+=j,d+=1}else{"."===a||","===a?a=k[a]:"$"===a?a=k.currency.symbol:"\\"===a&&(h+=1,a=f[h]),a=a.split("");for(var m=0,n=a.length;n>m;m++){c[d]=a[m],i+=a[m],d+=1}}}this.tokens=c,this._emptyMask=i,this._maskLength=i.length},_blur:function(){var a=this;null!=a.parentForm&&1==a.parentForm.options.autoValidatable&&a.validate()},validate:function(){var that=this,options=that.options,element=that.element,value=that.value(),joyLang=joy.getPluginLang(),valuetext=value.replace(/\s/gi,"");if(options.required&&""==valuetext){return that.showInfo(joy.format(joyLang.form.requiredInfo,options.subject)),!1}var length=joy.getByteLength(value);if(""!=options.minByte&&length<parseInt(options.minByte)){return that.showInfo(joy.format(joyLang.form.minByteInfo,options.minByte,length)),!1}if(""!=options.maxByte&&length>parseInt(options.maxByte)){return that.showInfo(joy.format(joyLang.form.maxByteInfo,options.maxByte,length)),!1}if(""!=options.dataType&&that.dataTypeDefine[options.dataType]&&!that.dataTypeDefine[options.dataType].dataRule.test(value)){return that.showInfo(that.dataTypeDefine[options.dataType].dataRuleInfo),!1}if(""!=options.dataRule&&!eval(options.dataRule).test(value)){if(null!=options.dataRuleInfo){var title="",tt=options.dataRuleInfo.split(":");title="lg"==tt[0]?lang[tt[1]]:options.dataRuleInfo,that.showInfo(title)}return !1}return that.hideInfo(element),!0}});ui.plugin(TextBox)}(jQuery),function(a,b){var c=window.joy,d=c.ui.Widget,e=c.ui.FormElement,f=a.proxy,g=(c.keys,"click"),h=".joyRadio",i="change",j="j-radio focus",k="j-radio checked",l="j-radio unchecked",m=e.extend({init:function(b,e){var j=this;d.fn.init.call(j,b,e),j.ns=h,j.enableDiv=a("<div style='position:absolute;z-index:999;'></div>");var m=j.enableDiv;b=j.element,b.attr("tabindex","-1"),e=j.options;var n=e.dataSource;j.dataSource=e.dataSource;var o=e.dataValueField,p=e.dataTextField;j.dataSource&&j._refreshHandler?j._unbindDataSource():j._refreshHandler=f(j.refresh,j),j.dataSource=c.data.DataSource.create(n).bind(i,j._refreshHandler);var q="<input type='hidden' name='"+e.formname+"' value='"+e.value+"'  ></input>",r=a(q);b.append(r);for(var s=!0,t=0;t<n.length;t++){if(n[t][o]==e.value&&s){s=!1;var u="<div class='"+k+"' value='"+n[t][o]+"' ><div></div><label >"+n[t][p]+"</label></div> ",v=a(u);v.on(g+h,f(j._click,v)).on("mouseover"+h,f(j._mouseover,v)).on("mouseout"+h,f(j._mouseout,v)),b.append(v)}else{var u="<div class='"+l+"'  value='"+n[t][o]+"' ><div></div><label >"+n[t][p]+"</label></div> ",v=a(u);v.on(g+h,f(j._click,v)).on("mouseover"+h,f(j._mouseover,v)).on("mouseout"+h,f(j._mouseout,v)),b.append(v)}}b.on("blur"+h,f(j._blur,j)).on(g+h,f(j._change,j)),m.width(b.width()),m.height(b.height()),b.append(m),j.enable(e.enable),j.wrapper=b,j._initFormElement(),c.notify(j)},events:[i,"dataBinding","dataBound"],options:{name:"Radio",autoValidatable:!0,label:"",value:"",formname:"",subject:"",enable:!0,dataTextField:"text",dataValueField:"value",required:!1,dataSource:{},valuePrimitive:!0},value:function(a){if(null!=a){""==a&&(this._oldValue=""),this.element.attr("value",a),this.element.find("input").val(a);for(var b=this.element.find(".j-radio"),c=0;c<b.length;c++){b.eq(c).attr("class",l),b.eq(c).attr("value")==a&&b.eq(c).attr("class",k)}}return this.element.attr("value")},items:function(){return this.dataSource},_data:function(){return this.dataSource.view()},refresh:function(){var b=this,c=b.options,d=b._data(),e=b.element,i=b.enableDiv,j=c.dataValueField,m=c.dataTextField;e.html(""),b.trigger("dataBinding");for(var n=!0,o=0;o<d.length;o++){if(d[o][j]==c.value&&n){n=!1;var p="<div class='"+k+"' value='"+d[o][j]+"' ><div></div><label >"+d[o][m]+"</label></div> ",q=a(p);q.on(g+h,f(b._click,q)).on("mouseover"+h,f(b._mouseover,q)).on("mouseout"+h,f(b._mouseout,q)),e.append(q)}else{var p="<div class='"+l+"'  value='"+d[o][j]+"' ><div></div><label >"+d[o][m]+"</label></div> ",q=a(p);q.on(g+h,f(b._click,q)).on("mouseover"+h,f(b._mouseover,q)).on("mouseout"+h,f(b._mouseout,q)),e.append(q)}}i.width(e.width()),i.height(e.height()),e.append(i),b.enable(c.enable),b.trigger("dataBound")},_blur:function(){var a=this;null!=a.parentForm&&1==a.parentForm.options.autoValidatable&&a.validate()},validate:function(){var a=this,b=a.options,d=a.element,e=a.value(),f=c.getPluginLang();return b.required&&""==e?(a.showInfo(c.format(f.form.requiredInfo,b.subject)),!1):(a.hideInfo(d),!0)},_change:function(a){var b=this,a=b.element.attr("value");a!==b._oldValue&&1==b.options.enable&&(b._oldValue=a,b.trigger(i),b.element.trigger(i))},_click:function(a){var b=this.attr("value"),c=this.parent();"false"!=c.attr("enable")&&(c.attr("value",b),c.find("input").val(b),this.parent().find(".j-radio").attr("class",l),this.attr("class",k))},_mouseover:function(){var a=this.parent();"false"!=a.attr("enable")&&this.attr("class")!=k&&this.attr("class",j)},_mouseout:function(){var a=this.parent();"false"!=a.attr("enable")&&this.attr("class")!=k&&this.attr("class",l)},enable:function(b){var c=this,d=c.options,e=c.element,f=c.enableDiv;b?(d.enable=!0,e.attr("enable","true"),f.hide(),e.find(".j-radio").each(function(){a(this).attr("class")==j&&a(this).attr("class",k)})):(d.enable=!1,f.show(),e.attr("enable","false"),e.find(".j-radio").each(function(){a(this).attr("class")==k&&a(this).attr("class",j)}))}});c.ui.plugin(m)}(jQuery),function(a,b){var c=window.joy,d=c.ui.Widget,e=c.ui.FormElement,f=a.proxy,g=(c.keys,"click"),h=".joyCheckbox",i="change",j="j-checkbox focus",k="j-checkbox checked",l="j-checkbox unchecked",m=e.extend({init:function(b,e){var j=this;d.fn.init.call(j,b,e);var m=a("<div style='position:absolute;z-index:999;'></div>");j.enableDiv=m,b=j.wrapper=j.element,b.attr("tabindex","-1"),e=j.options;var n=e.dataValueField,o=e.dataTextField,p=e.dataSource;j.dataSource=p,j.dataSource&&j._refreshHandler?j._unbindDataSource():j._refreshHandler=f(j.refresh,j),j.dataSource=c.data.DataSource.create(p).bind(i,j._refreshHandler);var q="<input type='hidden' name='"+e.formname+"' value='"+e.value+"'  ></input>",r=a(q);b.append(r),b.attr("value",e.value),b.on(g+h,f(j._change,j));for(var s=0;s<p.length;s++){if(j.matchValue(p[s][n])){var t="<div class='"+k+"'  value='"+p[s][n]+"' ><div></div><label >"+p[s][o]+"</label></div> ",u=a(t);u.on(g+h,f(j._click,u)).on("mouseover"+h,f(j._mouseover,u)).on("mouseout"+h,f(j._mouseout,u)),b.append(u)}else{var t="<div class='"+l+"'   value='"+p[s][n]+"' ><div></div><label >"+p[s][o]+"</label></div> ",u=a(t);u.on(g+h,f(j._click,u)).on("mouseover"+h,f(j._mouseover,u)).on("mouseout"+h,f(j._mouseout,u)),b.append(u)}}j.enableDiv.width(b.width()),j.enableDiv.height(b.height()),b.append(j.enableDiv),j.enable(e.enable),j.wrapper=b,j._initFormElement(),c.notify(j)},events:[g,i,"dataBinding","dataBound"],options:{name:"Checkbox",autoValidatable:!0,formname:"",label:"",value:"",subject:"",enable:!0,required:!1,dataTextField:"text",dataValueField:"value",dataSource:{},valuePrimitive:!0},matchValue:function(a){a+="";for(var b=(this.options.value+"").split(","),c=0;c<b.length;c++){if(a==b[c]){return !0}}return !1},setDataSource:function(b){var c=this;c.options.dataSource=b;var d=c.options,e=c.element,i=d.dataValueField,j=d.dataTextField;e.html("");var m="<input type='hidden' name='"+d.formname+"' value='"+d.value+"'  ></input>",n=a(m);e.append(n);for(var o=0;o<b.length;o++){if(c.matchValue(b[o][i])){var p="<div class='"+k+"'  value='"+b[o][i]+"' ><div></div><label >"+b[o][j]+"</label></div> ",q=a(p);q.on(g+h,f(c._click,q)).on("mouseover"+h,f(c._mouseover,q)).on("mouseout"+h,f(c._mouseout,q)),e.append(q)}else{var p="<div class='"+l+"'   value='"+b[o][i]+"' ><div></div><label >"+b[o][j]+"</label></div> ",q=a(p);q.on(g+h,f(c._click,q)).on("mouseover"+h,f(c._mouseover,q)).on("mouseout"+h,f(c._mouseout,q)),e.append(q)}}c.enableDiv.width(e.width()),c.enableDiv.height(e.height()),e.append(c.enableDiv),c.enable(d.enable)},items:function(){return this.dataSource},_data:function(){return this.dataSource.view()},refresh:function(){var b=this,c=b.options,d=b._data(),e=b.element,i=c.dataValueField,j=c.dataTextField;b.trigger("dataBinding"),e.html("");for(var m=0;m<d.length;m++){if(b.matchValue(d[m][i])){var n="<div class='"+k+"'  value='"+d[m][i]+"' ><div></div><label >"+d[m][j]+"</label></div> ",o=a(n);o.on(g+h,f(b._click,o)).on("mouseover"+h,f(b._mouseover,o)).on("mouseout"+h,f(b._mouseout,o)),e.append(o)}else{var n="<div class='"+l+"'   value='"+d[m][i]+"' ><div></div><label >"+d[m][j]+"</label></div> ",o=a(n);o.on(g+h,f(b._click,o)).on("mouseover"+h,f(b._mouseover,o)).on("mouseout"+h,f(b._mouseout,o)),e.append(o)}}b.value(""),b.enableDiv.width(e.width()),b.enableDiv.height(e.height()),e.append(b.enableDiv),b.enable(c.enable),b.trigger("dataBound")},value:function(a){if(null!=a){this.element.attr("value",a),this.element.find("input").val(a);for(var b=this.element.find(".j-checkbox"),c=(a+"").split(","),d=0;d<b.length;d++){""!=b.eq(d).attr("value")&&b.eq(d).attr("class",l);for(var e=0;e<c.length;e++){b.eq(d).attr("value")==c[e]&&b.eq(d).attr("class",k)}}}return this.element.attr("value")},validate:function(){var a=this,b=a.options,d=a.element,e=a.value(),f=c.getPluginLang();return b.required&&""==e?(a.showInfo(c.format(f.form.requiredInfo,b.subject)),!1):(a.hideInfo(d),!0)},_change:function(a){var b=this,a=b.element.attr("value");a!==b._oldValue&&1==b.options.enable&&(b.trigger(i),b.element.trigger(i),b._oldValue=a),b.validate()},_click:function(a){var b="",c=this.parent(),d=c.find("div"),e="";if("false"!=c.attr("enable")){if(this.attr("class")!=k){this.attr("class",k);for(var f=0;f<d.length;f++){d.eq(f).attr("class")==k&&(b+=e+d.eq(f).attr("value"),e=",")}c.attr("value",b),c.find("input").val(b)}else{this.attr("class",l);for(var f=0;f<d.length;f++){d.eq(f).attr("class")==k&&(b+=e+d.eq(f).attr("value"),e=",")}c.attr("value",b),c.find("input").val(b)}c.attr("value",b),c.find("input").val(b)}},_mouseover:function(){var a=this.parent();"false"!=a.attr("enable")&&this.attr("class")!=k&&this.attr("class",j)},_mouseout:function(){var a=this.parent();"false"!=a.attr("enable")&&this.attr("class")!=k&&this.attr("class",l)},enable:function(b){var c=this,d=c.options,e=c.element;b?(d.enable=!0,e.attr("enable","true"),c.enableDiv.hide(),e.find(".j-checkbox").each(function(){a(this).attr("class")==j&&a(this).attr("class",k)})):(d.enable=!1,c.enableDiv.show(),e.attr("enable","false"),e.find(".j-checkbox").each(function(){a(this).attr("class")==k&&a(this).attr("class",j)}))}});c.ui.plugin(m)}(jQuery),function(a,b){var c=window.joy,d=c.ui.Widget,e=c.ui.FormElement,f=c.support.placeholder,g=a.proxy,h=(c.keys,".joyTextarea"),i="change",j=e.extend({init:function(a,b){var e=this;d.fn.init.call(e,a,b),a=e.wrapper=e.element,b=e.options,e._initFormElement(),a.on("blur"+h,g(e._blur,e)),a.on("focus"+h,function(){a.val()==e.options.placeholder&&a.val("")}),c.notify(e)},events:[i],options:{name:"Textarea",autoValidatable:!0,minByte:"",subject:"",label:"",maxByte:"",required:!1,placeholder:"",enable:!0},_change:function(a){var b=this,a=b.value();a!==b._oldValue&&(b._oldValue=a,b.trigger(i),b.element.trigger(i)),b._placeholder()},_blur:function(){var a=this;a._change(),null!=a.parentForm&&1==a.parentForm.options.autoValidatable&&a.validate()},value:function(a){var c=this;return a===b?c.element.val()==this.options.placeholder?"":this.element.val():(c.element.val(a),void c._placeholder())},_placeholder:function(){f||this.element.val()||this.element.val(this.options.placeholder)},validate:function(){var a=this,b=a.options,d=a.element,e=a.value(),f=c.getPluginLang();if(b.required&&""==e){return a.showInfo(c.format(f.form.requiredInfo,b.subject)),!1}var g=c.getByteLength(e);return""!=b.minByte&&g<parseInt(b.minByte)?(a.showInfo(c.format(f.form.minByteInfo,b.minByte,g)),!1):""!=b.maxByte&&g>parseInt(b.maxByte)?(a.showInfo(c.format(f.form.maxByteInfo,b.maxByte,g)),!1):(a.hideInfo(d),!0)},enable:function(a){var b=this,c=(b.options,b.element);a?(c.prop("readonly",!1),c.css("color","")):(c.prop("readonly",!0),c.css("color","#C5C5C5"))}});c.ui.plugin(j)}(jQuery),function(a,b,c){function d(a,b,c){c=g(c),c&&!c.equals(a.color())&&("change"==b&&(a._value=c),c=1!=c.a?c.toCssRgba():c.toCss(),a.trigger(b,{value:c}))}function e(a,b,c){for(c||(c="0"),a=a.toString(16);b>a.length;){a="0"+a}return a}function f(a){return parseFloat((+a).toFixed(3))}function g(a,d){if(null==a||"transparent"==a){return null}if(a instanceof E){return a}var e=/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(a);return e?new G(b(e[1],16),b(e[2],16),b(e[3],16),1):(e=/^#?([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a))?new G(b(e[1]+e[1],16),b(e[2]+e[2],16),b(e[3]+e[3],16),1):(e=/^rgb\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/.exec(a))?new G(b(e[1],10),b(e[2],10),b(e[3],10),1):(e=/^rgba\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9.]+)\s*\)/.exec(a))?new G(b(e[1],10),b(e[2],10),b(e[3],10),parseFloat(e[4])):(e=/^rgb\(\s*([0-9]*\.?[0-9]+)%\s*,\s*([0-9]*\.?[0-9]+)%\s*,\s*([0-9]*\.?[0-9]+)%\s*\)/.exec(a))?new F(parseFloat(e[1])/100,parseFloat(e[2])/100,parseFloat(e[3])/100,1):(e=/^rgba\(\s*([0-9]*\.?[0-9]+)%\s*,\s*([0-9]*\.?[0-9]+)%\s*,\s*([0-9]*\.?[0-9]+)%\s*,\s*([0-9.]+)\s*\)/.exec(a),e?new F(parseFloat(e[1])/100,parseFloat(e[2])/100,parseFloat(e[3])/100,parseFloat(e[4])):d?c:new F(0,0,0,100))}function h(a,b,c){a=Array.prototype.slice.call(a);var d=a.length,e=a.indexOf(b);return 0>e?0>c?a[d-1]:a[0]:(e+=c,0>e?e+=d:e%=d,a[e])}function i(a){a.preventDefault()}function j(a,b){return function(){return a.apply(b,arguments)}}var k=window.joy,l=k.ui.FormElement,m=k.getPluginLang(),n=k.Class,o=k.ui,p=o.Widget,q=k.keys,r="background-color",s="k-state-selected",t="000000,7f7f7f,880015,ed1c24,ff7f27,fff200,22b14c,00a2e8,3f48cc,a349a4,ffffff,c3c3c3,b97a57,ffaec9,ffc90e,efe4b0,b5e61d,99d9ea,7092be,c8bfe7",u="FFFFFF,FFCCFF,FF99FF,FF66FF,FF33FF,FF00FF,CCFFFF,CCCCFF,CC99FF,CC66FF,CC33FF,CC00FF,99FFFF,99CCFF,9999FF,9966FF,9933FF,9900FF,FFFFCC,FFCCCC,FF99CC,FF66CC,FF33CC,FF00CC,CCFFCC,CCCCCC,CC99CC,CC66CC,CC33CC,CC00CC,99FFCC,99CCCC,9999CC,9966CC,9933CC,9900CC,FFFF99,FFCC99,FF9999,FF6699,FF3399,FF0099,CCFF99,CCCC99,CC9999,CC6699,CC3399,CC0099,99FF99,99CC99,999999,996699,993399,990099,FFFF66,FFCC66,FF9966,FF6666,FF3366,FF0066,CCFF66,CCCC66,CC9966,CC6666,CC3366,CC0066,99FF66,99CC66,999966,996666,993366,990066,FFFF33,FFCC33,FF9933,FF6633,FF3333,FF0033,CCFF33,CCCC33,CC9933,CC6633,CC3333,CC0033,99FF33,99CC33,999933,996633,993333,990033,FFFF00,FFCC00,FF9900,FF6600,FF3300,FF0000,CCFF00,CCCC00,CC9900,CC6600,CC3300,CC0000,99FF00,99CC00,999900,996600,993300,990000,66FFFF,66CCFF,6699FF,6666FF,6633FF,6600FF,33FFFF,33CCFF,3399FF,3366FF,3333FF,3300FF,00FFFF,00CCFF,0099FF,0066FF,0033FF,0000FF,66FFCC,66CCCC,6699CC,6666CC,6633CC,6600CC,33FFCC,33CCCC,3399CC,3366CC,3333CC,3300CC,00FFCC,00CCCC,0099CC,0066CC,0033CC,0000CC,66FF99,66CC99,669999,666699,663399,660099,33FF99,33CC99,339999,336699,333399,330099,00FF99,00CC99,009999,006699,003399,000099,66FF66,66CC66,669966,666666,663366,660066,33FF66,33CC66,339966,336666,333366,330066,00FF66,00CC66,009966,006666,003366,000066,66FF33,66CC33,669933,666633,663333,660033,33FF33,33CC33,339933,336633,333333,330033,00FF33,00CC33,009933,006633,003333,000033,66FF00,66CC00,669900,666600,663300,660000,33FF00,33CC00,339900,336600,333300,330000,00FF00,00CC00,009900,006600,003300,000000",v={apply:m.colorpicker.apply,cancel:m.colorpicker.cancel},w=".joyColorTools",x="click"+w,y="keydown"+w,z=k.support.browser,A=z.msie&&z.version<9,B=p.extend({init:function(a,b){var c,d=this;p.fn.init.call(d,a,b),a=d.element,b=d.options,d._value=b.value=g(b.value),c=d._ariaId=b.ariaId,c&&a.attr("aria-labelledby",c),b._standalone&&(d._triggerSelect=d._triggerChange)},options:{name:"ColorSelector",value:null,_standalone:!0},events:["change","select","cancel"],color:function(a){return a!==c&&(this._value=g(a),this._updateUI(this._value)),this._value},value:function(a){return a=this.color(a),a&&(a=this.options.opacity?a.toCssRgba():a.toCss()),a||null},enable:function(b){0===arguments.length&&(b=!0),b?a(".k-disabled-overlay",this.wrapper).remove():this.wrapper.append("<div class='k-disabled-overlay'></div>"),this._onEnable(b)},_select:function(a,b){var c=this._value;a=this.color(a),b||(this.element.trigger("blur"),a.equals(c)?this._standalone||this.trigger("cancel"):this.trigger("change",{value:this.value()}))},_triggerSelect:function(a){d(this,"select",a)},_triggerChange:function(a){d(this,"change",a)},destroy:function(){this.element&&this.element.off(w),this.wrapper&&this.wrapper.off(w).find("*").off(w),this.wrapper=null,p.fn.destroy.call(this)},_updateUI:a.noop,_selectOnHide:function(){return null},_cancel:function(){this.trigger("cancel")}}),C=B.extend({init:function(b,c){var d=this;B.fn.init.call(d,b,c),b=d.wrapper=d.element,c=d.options;var e=c.palette;"websafe"==e?(e=u,c.columns=18):"basic"==e&&(e=t),"string"==typeof e&&(e=e.split(",")),a.isArray(e)&&(e=a.map(e,function(a){return g(a)})),this._selectedID=(c.ariaId||k.guid())+"_selected",b.addClass("k-widget k-colorpalette").attr("role","grid").attr("aria-readonly","true").append(a(d._template({colors:e,columns:c.columns,tileSize:c.tileSize,value:d._value,id:c.ariaId}))).on(x,".k-item",function(b){d._select(a(b.currentTarget).css(r))}).attr("tabIndex",0).on(y,j(d._keydown,d));var f,h,i=c.tileSize;if(i){if(/number|string/.test(typeof i)){f=h=parseFloat(i)}else{if("object"!=typeof i){throw new Error("Unsupported value for the 'tileSize' argument")}f=parseFloat(i.width),h=parseFloat(i.height)}b.find(".k-item").css({width:f,height:h})}},focus:function(){this.wrapper.focus()},options:{name:"ColorPalette",columns:10,tileSize:null,palette:"basic"},_onEnable:function(a){a?this.wrapper.removeAttr("tabIndex"):this.wrapper.attr("tabIndex",0)},_keydown:function(b){var c,d=this.wrapper,e=d.find(".k-item"),f=e.filter("."+s).get(0),j=b.keyCode;if(j==q.LEFT?c=h(e,f,-1):j==q.RIGHT?c=h(e,f,1):j==q.DOWN?c=h(e,f,this.options.columns):j==q.UP?c=h(e,f,-this.options.columns):j==q.ENTER?(i(b),f&&this._select(a(f).css(r))):j==q.ESC&&this._cancel(),c){i(b),this._current(c);try{var k=g(c.css(r));this._triggerSelect(k)}catch(l){}}},_current:function(b){this.wrapper.find("."+s).removeClass(s).attr("aria-selected",!1).removeAttr("id"),a(b).addClass(s).attr("aria-selected",!0).attr("id",this._selectedID),this.element.removeAttr("aria-activedescendant").attr("aria-activedescendant",this._selectedID)},_updateUI:function(b){var c=null;this.wrapper.find(".k-item").each(function(){var d=g(a(this).css(r));return d&&d.equals(b)?(c=this,!1):void 0}),this._current(c)},_template:k.template('<table class="k-palette k-reset" role="presentation"><tr role="row"># for (var i = 0; i < colors.length; ++i) { ## var selected = colors[i].equals(value); ## if (i && i % columns == 0) { # </tr><tr role="row"> # } #<td role="gridcell" unselectable="on" style="background-color:#= colors[i].toCss() #"#= selected ? " aria-selected=true" : "" # #=(id && i === 0) ? "id=\\""+id+"\\" " : "" # class="k-item#= selected ? " '+s+'" : "" #" aria-label="#= colors[i].toCss() #"></td># } #</tr></table>')}),D=B.extend({init:function(b,c){var d=this;B.fn.init.call(d,b,c),c=d.options,b=d.element,d.wrapper=b.addClass("k-widget k-flatcolorpicker").append(d._template(c)),d._hueElements=a(".k-hsv-rectangle, .k-transparency-slider .k-slider-track",b),d._selectedColor=a(".k-selected-color-display",b),d._colorAsText=a("input.k-color-value",b),d._sliders(),d._hsvArea(),d._updateUI(d._value||new F(1,0,0,1)),b.find("input.k-color-value").on(y,function(b){var c=this;if(b.keyCode==q.ENTER){try{var e=g(c.value),f=d.color();d._select(e,e.equals(f))}catch(h){a(c).addClass("k-state-error")}}else{d.options.autoupdate&&setTimeout(function(){var a=g(c.value,!0);a&&d._updateUI(a,!0)},10)}}).end().on(x,".k-controls button.apply",function(){d._select(d._getHSV())}).on(x,".k-controls button.cancel",function(){d._updateUI(d.color()),d._cancel()}),A&&d._applyIEFilter()},destroy:function(){this._hueSlider.destroy(),this._opacitySlider&&this._opacitySlider.destroy(),this._hueSlider=this._opacitySlider=this._hsvRect=this._hsvHandle=this._hueElements=this._selectedColor=this._colorAsText=null,B.fn.destroy.call(this)},options:{name:"FlatColorPicker",opacity:!1,buttons:!1,input:!0,preview:!0,autoupdate:!0,messages:v},_applyIEFilter:function(){var a=this.element.find(".k-hue-slider .k-slider-track")[0],b=a.currentStyle.backgroundImage;b=b.replace(/^url\([\'\"]?|[\'\"]?\)$/g,""),a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b+"', sizingMethod='scale')"},_sliders:function(){function a(a){c._updateUI(c._getHSV(a.value,null,null,null))}function b(a){c._updateUI(c._getHSV(null,null,null,a.value/100))}var c=this,d=c.element;c._hueSlider=d.find(".k-hue-slider").joySlider({min:0,max:359,tickPlacement:"none",showButtons:!1,slide:a,change:a}).data("joySlider"),c._opacitySlider=d.find(".k-transparency-slider").joySlider({min:0,max:100,tickPlacement:"none",showButtons:!1,slide:b,change:b}).data("joySlider")},_hsvArea:function(){function a(a,c){var d=this.offset,e=a-d.left,f=c-d.top,g=this.width,h=this.height;e=0>e?0:e>g?g:e,f=0>f?0:f>h?h:f,b._svChange(e/g,1-f/h)}var b=this,c=b.element,d=c.find(".k-hsv-rectangle"),e=d.find(".k-draghandle").attr("tabIndex",0).on(y,j(b._keydown,b));b._hsvEvents=new k.UserEvents(d,{global:!0,press:function(b){this.offset=k.getOffset(d),this.width=d.width(),this.height=d.height(),e.focus(),a.call(this,b.x.location,b.y.location)},start:function(){d.addClass("k-dragging"),e.focus()},move:function(b){b.preventDefault(),a.call(this,b.x.location,b.y.location)},end:function(){d.removeClass("k-dragging")}}),b._hsvRect=d,b._hsvHandle=e},_onEnable:function(a){this._hueSlider.enable(a),this._opacitySlider&&this._opacitySlider.enable(a),this.wrapper.find("input").attr("disabled",!a);var b=this._hsvRect.find(".k-draghandle");a?b.attr("tabIndex",0):b.removeAttr("tabIndex")},_keydown:function(a){function b(b,c){var e=d._getHSV();e[b]+=c*(a.shiftKey?0.01:0.05),e[b]<0&&(e[b]=0),e[b]>1&&(e[b]=1),d._updateUI(e),i(a)}function c(b){var c=d._getHSV();c.h+=b*(a.shiftKey?1:5),c.h<0&&(c.h=0),c.h>359&&(c.h=359),d._updateUI(c),i(a)}var d=this;switch(a.keyCode){case q.LEFT:a.ctrlKey?c(-1):b("s",-1);break;case q.RIGHT:a.ctrlKey?c(1):b("s",1);break;case q.UP:b(a.ctrlKey&&d._opacitySlider?"a":"v",1);break;case q.DOWN:b(a.ctrlKey&&d._opacitySlider?"a":"v",-1);break;case q.ENTER:d._select(d._getHSV());break;case q.F2:d.wrapper.find("input.k-color-value").focus().select();break;case q.ESC:d._cancel()}},focus:function(){this._hsvHandle.focus()},_getHSV:function(a,b,c,d){var e=this._hsvRect,f=e.width(),g=e.height(),h=this._hsvHandle.position();return null==a&&(a=this._hueSlider.value()),null==b&&(b=h.left/f),null==c&&(c=1-h.top/g),null==d&&(d=this._opacitySlider?this._opacitySlider.value()/100:1),new H(a,b,c,d)},_svChange:function(a,b){var c=this._getHSV(null,a,b,null);this._updateUI(c)},_updateUI:function(a,b){var c=this,d=c._hsvRect;a&&(this._colorAsText.removeClass("k-state-error"),c._selectedColor.css(r,a.toDisplay()),b||c._colorAsText.val(c._opacitySlider?a.toCssRgba():a.toCss()),c._triggerSelect(a),a=a.toHSV(),c._hsvHandle.css({left:a.s*d.width()+"px",top:(1-a.v)*d.height()+"px"}),c._hueElements.css(r,new H(a.h,1,1,1).toCss()),c._hueSlider.value(a.h),c._opacitySlider&&c._opacitySlider.value(100*a.a))},_selectOnHide:function(){return this.options.buttons?null:this._getHSV()},_template:k.template('# if (preview) { #<div class="k-selected-color"><div class="k-selected-color-display"><input class="k-color-value" #= !data.input ? \'style="visibility: hidden;"\' : "" #></div></div># } #<div class="k-hsv-rectangle"><div class="k-hsv-gradient"></div><div class="k-draghandle"></div></div><input class="k-hue-slider" /># if (opacity) { #<input class="k-transparency-slider" /># } ## if (buttons) { #<div unselectable="on" class="k-controls"><button class="k-button apply">#: messages.apply #</button> <button class="k-button cancel">#: messages.cancel #</button></div># } #')}),E=n.extend({toHSV:function(){return this},toRGB:function(){return this},toHex:function(){return this.toBytes().toHex()},toBytes:function(){return this},toCss:function(){return"#"+this.toHex()},toCssRgba:function(){var a=this.toBytes();return"rgba("+a.r+", "+a.g+", "+a.b+", "+f(this.a)+")"},toDisplay:function(){return A?this.toCss():this.toCssRgba()},equals:function(a){return a===this||null!==a&&this.toCssRgba()==g(a).toCssRgba()},diff:function(a){if(null==a){return 0/0}var b=this.toBytes();return a=a.toBytes(),Math.sqrt(Math.pow(0.3*(b.r-a.r),2)+Math.pow(0.59*(b.g-a.g),2)+Math.pow(0.11*(b.b-a.b),2))},clone:function(){var a=this.toBytes();return a===this&&(a=new G(a.r,a.g,a.b,a.a)),a}}),F=E.extend({init:function(a,b,c,d){this.r=a,this.g=b,this.b=c,this.a=d},toHSV:function(){var a,b,c,d,e,f,g=this.r,h=this.g,i=this.b;return a=Math.min(g,h,i),b=Math.max(g,h,i),f=b,c=b-a,0===c?new H(0,0,f,this.a):(0!==b?(e=c/b,d=g==b?(h-i)/c:h==b?2+(i-g)/c:4+(g-h)/c,d*=60,0>d&&(d+=360)):(e=0,d=-1),new H(d,e,f,this.a))},toBytes:function(){return new G(255*this.r,255*this.g,255*this.b,this.a)}}),G=F.extend({init:function(a,b,c,d){this.r=Math.round(a),this.g=Math.round(b),this.b=Math.round(c),this.a=d},toRGB:function(){return new F(this.r/255,this.g/255,this.b/255,this.a)},toHSV:function(){return this.toRGB().toHSV()},toHex:function(){return e(this.r,2)+e(this.g,2)+e(this.b,2)},toBytes:function(){return this}}),H=E.extend({init:function(a,b,c,d){this.h=a,this.s=b,this.v=c,this.a=d},toRGB:function(){var a,b,c,d,e,f,g,h,i=this.h,j=this.s,k=this.v;if(0===j){b=c=d=k}else{switch(i/=60,a=Math.floor(i),e=i-a,f=k*(1-j),g=k*(1-j*e),h=k*(1-j*(1-e)),a){case 0:b=k,c=h,d=f;break;case 1:b=g,c=k,d=f;break;case 2:b=f,c=k,d=h;break;case 3:b=f,c=g,d=k;break;case 4:b=h,c=f,d=k;break;default:b=k,c=f,d=g}}return new F(b,c,d,this.a)},toBytes:function(){return this.toRGB().toBytes()}}),I=l.extend({init:function(b,c){var d=this;p.fn.init.call(d,b,c),c=d.options,b=d.element;var e=b.attr("value")||b.val();e=e?g(e,!0):g(c.value,!0),d._value=c.value=e;var f=d.wrapper=a(d._template(c));b.hide().after(f),b.is("input")&&b.appendTo(f),d.enable(!b.attr("disabled"));var h=b.attr("accesskey");h&&(b.attr("accesskey",null),f.attr("accesskey",h)),d.bind("activate",function(a){a.isDefaultPrevented()||d.toggle()}),d._initFormElement(),d._updateUI(e)},destroy:function(){this.wrapper.off(w).find("*").off(w),this._popup&&(this._selector.destroy(),this._popup.destroy()),this._selector=this._popup=this.wrapper=null,p.fn.destroy.call(this)},enable:function(a){var b=this,c=b.wrapper,d=c.children(".k-picker-wrap"),e=d.find(".k-select");0===arguments.length&&(a=!0),b.element.attr("disabled",!a),c.attr("aria-disabled",!a),e.off(w).on("mousedown"+w,i),c.addClass("k-state-disabled").removeAttr("tabIndex").add("*",c).off(w),a&&c.removeClass("k-state-disabled").attr("tabIndex",0).on("mouseenter"+w,function(){d.addClass("k-state-hover")}).on("mouseleave"+w,function(){d.removeClass("k-state-hover")}).on("focus"+w,function(){d.addClass("k-state-focused")}).on("blur"+w,function(){d.removeClass("k-state-focused")}).on(y,j(b._keydown,b)).on(x,".k-select",j(b.toggle,b)).on(x,b.options.toolIcon?".k-tool-icon":".k-selected-color",function(){b.trigger("activate")})},_template:k.template('<span role="textbox" aria-haspopup="true" class="k-widget k-colorpicker k-header"><span class="k-picker-wrap k-state-default"># if (toolIcon) { #<span class="k-tool-icon #= toolIcon #"><span class="k-selected-color"></span></span># } else { #<span class="k-selected-color"></span># } #<span class="k-select" unselectable="on"><span class="k-icon k-i-arrow-s" unselectable="on"></span></span></span></span>'),options:{name:"ColorPicker",palette:null,columns:10,toolIcon:null,value:null,messages:v,opacity:!1,buttons:!0,preview:!0,ARIATemplate:m.colorpicker.ARIATemplate,required:!1,placeholder:"",subject:"",label:""},events:["activate","change","select","open","close"],open:function(){this._getPopup().open()},close:function(){this._getPopup().close()},toggle:function(){this._getPopup().toggle()},color:B.fn.color,value:B.fn.value,_select:B.fn._select,_triggerSelect:B.fn._triggerSelect,_isInputTypeColor:function(){var a=this.element[0];return/^input$/i.test(a.tagName)&&/^color$/i.test(a.type)},_updateUI:function(a){var b="";a&&(b=this._isInputTypeColor()||1==a.a?a.toCss():a.toCssRgba(),this.element.val(b)),this._ariaTemplate||(this._ariaTemplate=k.template(this.options.ARIATemplate)),this.wrapper.attr("aria-label",this._ariaTemplate(b)),this._triggerSelect(a),this.wrapper.find(".k-selected-color").css(r,a?a.toDisplay():"transparent")},_keydown:function(a){var b=a.keyCode;this._getPopup().visible()?(b==q.ESC?this._selector._cancel():this._selector._keydown(a),i(a)):(b==q.ENTER||b==q.DOWN)&&(this.open(),i(a))},_getPopup:function(){var b=this,c=b._popup;if(!c){var d,e=b.options;d=e.palette?C:D,e._standalone=!1,delete e.select,delete e.change,delete e.cancel;var f=k.guid(),h=b._selector=new d(a('<div id="'+f+'"/>').appendTo(document.body),e);b.wrapper.attr("aria-owns",f),b._popup=c=h.wrapper.joyPopup({anchor:b.wrapper}).data("joyPopup"),h.bind({select:function(a){b._updateUI(g(a.value))},change:function(){b._select(h.color()),b.close()},cancel:function(){b.close()}}),c.bind({close:function(a){if(b.trigger("close")){return void a.preventDefault()}b.wrapper.children(".k-picker-wrap").removeClass("k-state-focused");var c=h._selectOnHide();c?b._select(c):(b.wrapper.focus(),b._updateUI(b.color())),null!=b.parentForm&&1==b.parentForm.options.autoValidatable&&b.validate()},open:function(a){b.trigger("open")?a.preventDefault():b.wrapper.children(".k-picker-wrap").addClass("k-state-focused")},activate:function(){h._select(b.color(),!0),h.focus(),b.wrapper.children(".k-picker-wrap").addClass("k-state-focused")}})}return c},validate:function(){var a=this,b=a.options,c=a.element,d=c.val(),e=k.getPluginLang();return b.required&&""==d?(a.showInfo(k.format(e.form.requiredInfo,b.subject)),!1):(a.hideInfo(c),!0)}});o.plugin(C),o.plugin(D),o.plugin(I),k.parseColor=g,k.Color={fromBytes:function(a,b,c,d){return new G(a,b,c,null!=d?d:1)},fromRGB:function(a,b,c,d){return new F(a,b,c,null!=d?d:1)},fromHSV:function(a,b,c,d){return new H(a,b,c,null!=d?d:1)}}}(jQuery,parseInt),function(a,b){function c(a,b,c){var d,e;a.on("dragenter"+u,function(){b(),e=new Date,d||(d=setInterval(function(){var a=new Date-e;a>100&&(c(),clearInterval(d),d=null)},100))}).on("dragover"+u,function(){e=new Date})}function d(a,c){return a!==b&&a.match(/\/$/)||(a=(a||"")+"/"),a+c}function e(a){if(!a){return""}var b=" bytes";return a>=1073741824?(b=" GB",a/=1073741824):a>=1048576?(b=" MB",a/=1048576):a>=1024&&(b=" KB",a/=1024),Math.round(100*a)/100+b}function f(a,b){var c=a[b];return j(c)?c.from||c.field||b:c}var g=window.joy,h=g.getPluginLang(),i=g.ui.Widget,j=a.isPlainObject,k=a.proxy,l=a.extend,m=g.support.placeholder,n=g.support.browser,o=g.isFunction,p=/(^\/|\/$)/g,q="change",r="apply",s="error",t="click",u=".joyImageBrowser",v=".joyBreadcrumbs",w=".joySearchBox",x="fileName",y="fileSize",z="postfix",A="id",B={field:"createTime",dir:"desc"},C=g.template('<li class="k-tile-empty"><strong>${text}</strong></li>'),D='<div class="k-widget k-toolbar k-header k-floatwrap"><div class="k-toolbar-wrap"># if (showUpload) { # <div class="k-widget k-upload"><div class="k-button k-button-icontext k-upload-button"><span class="k-icon k-add"></span>#=messages.uploadFile#<input type="file" name="file" /></div></div># } ## if (showCreate) { #<button type="button" class="k-button k-button-icon"><span class="k-icon k-addfolder" /></button># } ## if (showDelete) { #<button type="button" class="k-button k-button-icon k-state-disabled"><span class="k-icon k-delete" /></button>&nbsp;# } #</div><div class="k-tiles-arrange"><label>#=messages.orderBy#: <select /></label></a></div></div>';l(!0,g.data,{schemas:{imagebrowser:{data:function(a){return a.items||a||[]
},model:{idField:A,id:A,fields:{createTime:{type:"number"},fileName:{type:"string"},fileSize:{type:"number"},id:{type:"string"},name:{type:"string"},postfix:{type:"string"},sequ:{type:"number"},sourceCode:{type:"string"},sourceId:{type:"string"},userId:{type:"string"}}}}}}),l(!0,g.data,{transports:{imagebrowser:g.data.RemoteTransport.extend({init:function(b){g.data.RemoteTransport.fn.init.call(this,a.extend(!0,{},this.options,b))},_call:function(b,c){c.data=a.extend({},c.data,{path:this.options.path()}),o(this.options[b])?this.options[b].call(this,c):g.data.RemoteTransport.fn[b].call(this,c)},read:function(a){this._call("read",a)},create:function(a){this._call("create",a)},destroy:function(a){this._call("destroy",a)},update:function(){},options:{read:{type:"POST"},update:{type:"POST"},create:{type:"POST"},destroy:{type:"POST"}}})}});var E;E=n.msie&&n.version<8?function(a){return a.offsetTop}:function(b){return b.offsetTop-a(b).height()};var F=i.extend({init:function(a,b){var c=this;b=b||{},i.fn.init.call(c,a,b),c.element.addClass("k-imagebrowser"),c.element.on(t+u,".k-toolbar button:not(.k-state-disabled):has(.k-delete)",k(c._deleteClick,c)).on(t+u,".k-toolbar button:not(.k-state-disabled):has(.k-addfolder)",k(c._addClick,c)).on("keydown"+u,"li.k-state-selected input",k(c._directoryKeyDown,c)).on("blur"+u,"li.k-state-selected input",k(c._directoryBlur,c)),c._dataSource(),c.refresh(),c.path(c.options.sourceCode)},options:{name:"ImageBrowser",messages:h.imagebrower.messages,transport:{},path:"/",fileTypes:"*.png,*.gif,*.jpg,*.jpeg"},events:[s,q,r],destroy:function(){var a=this;i.fn.destroy.call(a),a.dataSource.unbind(s,a._errorHandler),a.element.add(a.list).add(a.toolbar).off(u),a.arrangeBy&&a.arrangeBy.destroy(),g.destroy(a.element)},value:function(){var a,b=this,c=b._selectedItem(),d=b.options.transport.imageUrl;return c&&"d"!=c.get(z)?(a=c.get("id"),d&&(a=o(d)?d(a):g.format(d,encodeURIComponent(a))),a):void 0},_selectedItem:function(){var a=this.listView,b=a.select();return b.length?this.dataSource.getByUid(b.attr(g.attr("uid"))):void 0},_toolbar:function(){var b=this,c=g.template(D),d=b.options.messages,e=[{text:d.orderByName,value:"name"},{text:d.orderBySize,value:"size"},{text:d.orderByDate,value:"date"}];b.toolbar=a(c({messages:d,showUpload:b.options.transport.uploadUrl,showCreate:!1,showDelete:b.options.transport.destroy})).appendTo(b.element).find(".k-upload input").joyUpload({multiple:!1,localization:{dropFilesHere:d.dropFilesHere},async:{saveUrl:b.options.transport.uploadUrl,autoUpload:!0},upload:k(b._fileUpload,b),error:function(a){b._error({xhr:a.XMLHttpRequest,status:"error"})}}).end(),b.upload=b.toolbar.find(".k-upload input").data("joyUpload"),b.arrangeBy=b.toolbar.find(".k-tiles-arrange select").joyDropDownList({dataSource:e,dataTextField:"text",dataValueField:"value",change:function(){b.orderBy(this.value())}}).data("joyDropDownList"),b._attachDropzoneEvents()},_attachDropzoneEvents:function(){var b=this;b.options.transport.uploadUrl&&(c(a(document.documentElement),a.proxy(b._dropEnter,b),a.proxy(b._dropLeave,b)),b._scrollHandler=k(b._positionDropzone,b))},_dropEnter:function(){this._positionDropzone(),a(document).on("scroll"+u,this._scrollHandler)},_dropLeave:function(){this._removeDropzone(),a(document).off("scroll"+u,this._scrollHandler)},_positionDropzone:function(){var a=this,b=a.element,c=b.offset();a.toolbar.find(".k-dropzone").addClass("k-imagebrowser-dropzone").offset(c).css({width:b[0].clientWidth,height:b[0].clientHeight,lineHeight:b[0].clientHeight+"px"})},_removeDropzone:function(){this.toolbar.find(".k-dropzone").removeClass("k-imagebrowser-dropzone").css({width:"",height:"",lineHeight:"",top:"",left:""})},_deleteClick:function(){var a=this,b=a.listView.select(),c=g.format(a.options.messages.deleteFile,b.find("strong").text());b.length&&a._showMessage(c,"confirm")&&a.listView.remove(b)},_addClick:function(){this.createDirectory()},_getFieldName:function(a){return f(this.dataSource.reader.model.fields,a)},_fileUpload:function(a){var b,c=this,d=c.options,e=d.fileTypes,f=new RegExp(("("+e.split(",").join(")|(")+")").replace(/\*\./g,".*."),"i"),h=a.files[0].name,i=x,j=y;f.test(h)?(a.data={sourceCode:c._path},b=c._createFile(h),b?c.upload.one("success",function(a){b.set(i,a.response[c._getFieldName(i)]),b.set(j,a.response[c._getFieldName(j)]),b.set("id",a.response.id),c._tiles=c.listView.items(),c._scroll()}):a.preventDefault()):(a.preventDefault(),c._showMessage(g.format(d.messages.invalidFileType,h,e)))},_findFile:function(a){var b,c,d,e=this.dataSource.data(),f=z,g=x;for(a=a.toLowerCase(),b=0,d=e.length;d>b;b++){if("d"!=e[b].get(f)&&e[b].get(g).toLowerCase()===a){c=e[b];break}}return c},_createFile:function(a){var b,c,d=this,e=0,f={},h=z,i=d.dataSource.view(),j=d._findFile(a);if(j&&!d._showMessage(g.format(d.options.messages.overwriteFile,a),"confirm")){return null}if(j){return j}for(b=0,c=i.length;c>b;b++){if("d"!=i[b].get(h)){e=b;break}}return f[h]="f",f[x]=a,f[y]=0,d.dataSource.insert(++e,f)},createDirectory:function(){var a,b,c=this,d=0,e=z,f=x,h=c.dataSource.data(),i=c._nameDirectory(),j=new c.dataSource.reader.model;for(a=0,b=h.length;b>a;a++){"d"===h[a].get(e)&&(d=a)}j.set(e,"d"),j.set(f,i),c.listView.one("dataBound",function(){var a=c.listView.items().filter("["+g.attr("uid")+"="+j.uid+"]"),b=a.find("input");a.length&&this.edit(a),this.element.scrollTop(a.attr("offsetTop")-this.element[0].offsetHeight),setTimeout(function(){b.select()})}).one("save",function(a){var b=a.model.get(f);b?a.model.set(f,c._nameExists(b,j.uid)?c._nameDirectory():b):a.model.set(f,i)}),c.dataSource.insert(++d,j)},_directoryKeyDown:function(a){13==a.keyCode&&a.currentTarget.blur()},_directoryBlur:function(){this.listView.save()},_nameExists:function(a,b){var c,d,e=this.dataSource.data(),f=z,g=x;for(c=0,d=e.length;d>c;c++){if("d"===e[c].get(f)&&e[c].get(g).toLowerCase()===a.toLowerCase()&&e[c].uid!==b){return !0}}return !1},_nameDirectory:function(){var b,c,d,e="New folder",f=this.dataSource.data(),g=[],h=z,i=x;for(c=0,d=f.length;d>c;c++){"d"===f[c].get(h)&&f[c].get(i).toLowerCase().indexOf(e.toLowerCase())>-1&&g.push(f[c].get(i))}if(a.inArray(e,g)>-1){c=2;do{b=e+" ("+c+")",c++}while(a.inArray(b,g)>-1);e=b}return e},orderBy:function(a){this.dataSource.sort([{field:z,dir:"asc"},{field:a,dir:"asc"},{field:"createTime",dir:"desc"}])},search:function(a){this.dataSource.filter({field:x,operator:"contains",value:a})},_content:function(){var b=this;b.list=a('<ul class="k-reset k-floats k-tiles" />').appendTo(b.element).on("scroll"+u,k(b._scroll,b)).on("dblclick"+u,"li",k(b._dblClick,b)),b.listView=new g.ui.ListView(b.list,{dataSource:b.dataSource,template:b._itemTmpl(),editTemplate:b._editTmpl(),selectable:!0,autoBind:!1,dataBinding:function(a){b.toolbar.find(".k-delete").parent().addClass("k-state-disabled"),("remove"===a.action||"sync"===a.action)&&a.preventDefault()},dataBound:function(){b.dataSource.view().length?(b._tiles=this.items(),b._scroll()):this.wrapper.append(C({text:b.options.messages.emptyFolder}))},change:k(b._listViewChange,b)})},_dblClick:function(b){var c=this,e=a(b.currentTarget);if(e.hasClass("k-edit-item")&&c._directoryBlur(),e.filter("["+g.attr("type")+"=d]").length){var f=c.dataSource.getByUid(e.attr(g.attr("uid")));f&&(c.path(d(c.path(),f.get(x))),c.breadcrumbs.value(c.path()))}else{e.filter("["+g.attr("type")+"=f]").length&&c.trigger(r)}},_listViewChange:function(){var a=this._selectedItem();a&&(this.toolbar.find(".k-delete").parent().removeClass("k-state-disabled"),"d"!=a.get(z)&&this.trigger(q))},_dataSource:function(){var a,b=this,c=b.options,d=c.transport,e=l({},B),f={field:x,dir:"asc"},h={type:d.type||"imagebrowser",sort:[e,f]};j(d)&&(d.path=k(b.path,b),h.transport=d),j(c.schema)?h.schema=c.schema:d.type&&j(g.data.schemas[d.type])&&(a=g.data.schemas[d.type]),b.dataSource&&b._errorHandler?b.dataSource.unbind(s,b._errorHandler):b._errorHandler=k(b._error,b),b.dataSource=g.data.DataSource.create(h).bind(s,b._errorHandler)},_navigation:function(){var b=this,c=a('<div class="k-floatwrap"><input/><input/></div>').appendTo(this.element);b.breadcrumbs=c.find("input:first").joyBreadcrumbs({value:b.options.path,change:function(){b.path(this.value())}}).data("joyBreadcrumbs"),b.searchBox=c.parent().find("input:last").joySearchBox({label:b.options.messages.search,change:function(){b.search(this.value())}}).data("joySearchBox")},_error:function(a){var b,c=this;c.trigger(s,a)||(b=a.xhr.status,"error"==a.status?"404"==b?c._showMessage(c.options.messages.directoryNotFound):"0"!=b&&c._showMessage("Error! The requested URL returned "+b+" - "+a.xhr.statusText):"timeout"==b&&c._showMessage("Error! Server timeout."))},_showMessage:function(a,b){return window[b||"alert"](a)},refresh:function(){var a=this;a._navigation(),a._toolbar(),a._content()},_loadImage:function(b){var c=this,d=a(b),e=c.dataSource.getByUid(d.attr(g.attr("uid"))),f=e.get(x),h=c.options.transport.thumbnailUrl,i=a("<img width='80px' height='80px' />",{alt:f}),j="?";i.hide().on("load"+u,function(){a(this).prev().remove().end().addClass("k-image").fadeIn()}),d.find(".k-loading").after(i),o(h)?h=h(c.path(),encodeURIComponent(f)):(h.indexOf("?")>=0&&(j="&"),h=h+j+"id="+e.get("id")),i.attr("src",h),b.loaded=!0},_scroll:function(){var a=this;a.options.transport&&a.options.transport.thumbnailUrl&&(clearTimeout(a._timeout),a._timeout=setTimeout(function(){var b=a.list.outerHeight(),c=a.list.scrollTop(),d=c+b;a._tiles.each(function(){var b=E(this),e=b+this.offsetHeight;return(b>=c&&d>b||e>=c&&d>e)&&a._loadImage(this),b>d?!1:void 0}),a._tiles=a._tiles.filter(function(){return !this.loaded})},250))},_editTmpl:function(){var a='<li class="k-tile k-state-selected" '+g.attr("uid")+'="#=uid#" ';return a+=g.attr("type")+'="${'+z+'}">',a+="#if("+z+' == "d") { #',a+='<div class="k-thumb"><span class="k-icon k-folder"></span></div>',a+="#}else{#",a+='<div class="k-thumb"><span class="k-icon k-loading"></span></div>',a+="#}#",a+="#if("+z+' == "d") { #',a+='<input class="k-input" '+g.attr("bind")+'="value:'+x+'"/>',a+="#}#",a+="</li>",k(g.template(a),{sizeFormatter:e})},_itemTmpl:function(){var a=this,b='<li class="k-tile" '+g.attr("uid")+'="#=uid#" ';return b+=g.attr("type")+'="${'+z+'}">',b+="#if("+z+' == "d") { #',b+='<div class="k-thumb"><span class="k-icon k-folder"></span></div>',b+="#}else{#",b+=a.options.transport&&a.options.transport.thumbnailUrl?'<div class="k-thumb"><span class="k-icon k-loading"></span></div>':'<div class="k-thumb"><span class="k-icon k-file"></span></div>',b+="#}#",b+="<strong>${"+x+"}</strong>",b+="#if("+z+' != "d") { # <span class="k-filesize">${this.sizeFormatter('+y+")}</span> #}#",b+="</li>",k(g.template(b),{sizeFormatter:e})},path:function(a){var c=this,d=c._path||"";return a!==b?(c._path=a.replace(p,""),void c.dataSource.read({sourceCode:c._path})):(d&&(d=d.replace(p,"")),"/"===d||""===d?"":d+"/")}}),G=i.extend({init:function(a,b){var c=this;b=b||{},i.fn.init.call(c,a,b),m&&c.element.attr("placeholder",c.options.label),c._wrapper(),c.element.on("keydown"+w,k(c._keydown,c)).on("change"+w,k(c._updateValue,c)),c.wrapper.on(t+w,"a",k(c._click,c)),m||c.element.on("focus"+w,k(c._focus,c)).on("blur"+w,k(c._blur,c))},options:{name:"SearchBox",label:"Search",value:""},events:[q],destroy:function(){var a=this;a.wrapper.add(a.element).add(a.label).off(w),i.fn.destroy.call(a)},_keydown:function(a){13===a.keyCode&&this._updateValue()},_click:function(a){a.preventDefault(),this._updateValue()},_updateValue:function(){var a=this,b=a.element.val();b!==a.value()&&(a.value(b),a.trigger(q))},_blur:function(){this._updateValue(),this._toggleLabel()},_toggleLabel:function(){m||this.label.toggle(!this.element.val())},_focus:function(){this.label.hide()},_wrapper:function(){var b=this.element,c=b.parents(".k-search-wrap");b[0].style.width="",b.addClass("k-input"),c.length||(c=b.wrap(a('<div class="k-widget k-search-wrap k-textbox"/>')).parent(),m||a('<label style="display:block">'+this.options.label+"</label>").insertBefore(b),a('<a href="#" class="k-icon k-i-search k-search"/>').appendTo(c)),this.wrapper=c,this.label=c.find(">label")},value:function(a){var c=this;return a!==b?(c.options.value=a,c.element.val(a),void c._toggleLabel()):c.options.value}}),H=i.extend({init:function(a,b){var c=this;b=b||{},i.fn.init.call(c,a,b),c._wrapper(),c.wrapper.on("focus"+v,"input",k(c._focus,c)).on("blur"+v,"input",k(c._blur,c)).on("keydown"+v,"input",k(c._keydown,c)).on(t+v,"a.k-i-arrow-n:first",k(c._rootClick,c)).on(t+v,"a:not(.k-i-arrow-n)",k(c._click,c)),c.value(c.options.value)},options:{name:"Breadcrumbs",gap:50},events:[q],destroy:function(){var a=this;i.fn.destroy.call(a),a.wrapper.add(a.wrapper.find("input")).add(a.wrapper.find("a")).off(v)},_update:function(a){a="/"===(a||"").charAt(0)?a:"/"+(a||""),a!==this.value()&&(this.value(a),this.trigger(q))},_click:function(b){b.preventDefault(),this._update(this._path(a(b.target).prevAll("a:not(.k-i-arrow-n)").addBack()))},_rootClick:function(a){a.preventDefault(),this._update("")},_focus:function(){var a=this,b=a.element;a.overlay.hide(),a.element.val(a.value()),setTimeout(function(){b.select()})},_blur:function(){if(!this.overlay.is(":visible")){var a=this,b=a.element,c=b.val().replace(/\/{2,}/g,"/");a.overlay.show(),b.val(""),a._update(c)}},_keydown:function(a){var b=this;13===a.keyCode&&(b._blur(),setTimeout(function(){b.overlay.find("a:first").focus()}))},_wrapper:function(){var b,c=this.element,d=c.parents(".k-breadcrumbs");c[0].style.width="",c.addClass("k-input"),d.length||(d=c.wrap(a('<div class="k-widget k-breadcrumbs k-textbox"/>')).parent()),b=d.find(".k-breadcrumbs-wrap"),b.length||(b=a('<div class="k-breadcrumbs-wrap"/>').appendTo(d)),this.wrapper=d,this.overlay=b},refresh:function(){var c,d,e,f,g="",h=this.value();for(h!==b&&h.match(/^\//)||(h="/"+(h||"")),c=h.split("/"),e=0,f=c.length;f>e;e++){d=c[e],d&&(g||(g+='<a href="#" class="k-icon k-i-arrow-n">root</a>'),g+='<a class="k-link" href="#">'+c[e]+"</a>",g+='<span class="k-icon k-i-arrow-e">&gt;</span>')}this.overlay.empty().append(a(g)),this._adjustSectionWidth()},_adjustSectionWidth:function(){var b,c=this,d=c.wrapper,e=d.width()-c.options.gap,f=c.overlay.find("a");f.each(function(c){b=a(this),b.parent().width()>e&&(c==f.length-1?b.width(e):b.prev().addBack().hide())})},value:function(a){return a!==b?(this._value=a.replace(/\/{2,}/g,"/"),void this.refresh()):this._value},_path:function(b){return"/"+a.map(b,function(b){return a(b).text()}).join("/")}});g.ui.plugin(F),g.ui.plugin(H),g.ui.plugin(G)}(window.joy.jQuery),function(a,b){function c(a,b,c){var d=c?" k-slider-horizontal":" k-slider-vertical",e=a.style?a.style:b.attr("style"),f=b.attr("class")?" "+b.attr("class"):"",g="";return"bottomRight"==a.tickPlacement?g=" k-slider-bottomright":"topLeft"==a.tickPlacement&&(g=" k-slider-topleft"),e=e?" style='"+e+"'":"","<div class='k-widget k-slider"+d+f+"'"+e+"><div class='k-slider-wrap"+(a.showBtn?" k-slider-buttons":"")+g+"'></div></div>"}function d(a,b,c){var d="";return d="increase"==b?c?"k-i-arrow-e":"k-i-arrow-n":c?"k-i-arrow-w":"k-i-arrow-s","<a class='k-button k-button-"+b+"'><span class='k-icon "+d+"' title='"+a[b+"ButtonTitle"]+"'>"+a[b+"ButtonTitle"]+"</span></a>"}function e(a,b){var c,d="<ul class='k-reset k-slider-items'>",e=w.floor(j(b/a.smallStep))+1;for(c=0;e>c;c++){d+="<li class='k-tick' role='presentation'>&nbsp;</li>"}return d+="</ul>"}function f(a,b){var c=b.is("input")?1:2,d=2==c?a.leftDragHandleTitle:a.dragHandleTitle;return"<div class='k-slider-track'><div class='k-slider-selection'><!-- --></div><a href='#' class='k-draghandle' title='"+d+"' role='slider' aria-valuemin='"+a.min+"' aria-valuemax='"+a.max+"' aria-valuenow='"+(c>1?a.selectionStart||a.min:a.value||a.min)+"'>Drag</a>"+(c>1?"<a href='#' class='k-draghandle' title='"+a.rightDragHandleTitle+"'role='slider' aria-valuemin='"+a.min+"' aria-valuemax='"+a.max+"' aria-valuenow='"+(a.selectionEnd||a.max)+"'>Drag</a>":"")+"</div>"}function g(a){return function(b){return b+a}}function h(a){return function(){return a}}function i(a){return(a+"").replace(".",".")}function j(a){a=parseFloat(a,10);var b=w.pow(10,U||0);return w.round(a*b)/b}function k(a,c){var d=t(a.getAttribute(c));return null===d&&(d=b),d}function l(a){return typeof a!==W}var m=window.joy,n=m.getPluginLang(),o=m.ui.Widget,p=m.ui.FormElement,q=m.ui.Draggable,r=a.extend,s=m.format,t=m.parseFloat,u=a.proxy,v=a.isArray,w=Math,x=m.support,y=x.pointers,z=x.msPointers,A="change",B="slide",C=".slider",D="touchstart"+C+" mousedown"+C,E=y?"pointerdown"+C:z?"MSPointerDown"+C:D,F="touchend"+C+" mouseup"+C,G=y?"pointerup":z?"MSPointerUp"+C:F,H="moveSelection",I="keydown"+C,J="click"+C,K="mouseover"+C,L="focus"+C,M="blur"+C,N=".k-draghandle",O=".k-slider-track",P=".k-tick",Q="k-state-selected",R="k-state-focused",S="k-state-default",T="k-state-disabled",U=3,V="disabled",W="undefined",X="tabindex",Y=m.getTouches,Z=p.extend({init:function(a,b){var c=this;o.fn.init.call(c,a,b),b=c.options,c._distance=b.max-b.min,c._isHorizontal="horizontal"==b.orientation,c._isRtl=c._isHorizontal&&m.support.isRtl(a),c._position=c._isHorizontal?"left":"bottom",c._sizeFn=c._isHorizontal?"width":"height",c._outerSize=c._isHorizontal?"outerWidth":"outerHeight",b.tooltip.format=b.tooltip.enabled?b.tooltip.format||"{0}":"{0}",c._createHtml(),c.wrapper=c.element.closest(".k-slider"),c._initFormElement(),c._trackDiv=c.wrapper.find(O),c._setTrackDivWidth(),c._maxSelection=c._trackDiv[c._sizeFn](),c._sliderItemsInit(),c._tabindex(c.wrapper.find(N)),c[b.enabled?"enable":"disable"]();var d=m.support.isRtl(c.wrapper)?-1:1;c._keyMap={37:g(-1*d*b.smallStep),40:g(-b.smallStep),39:g(1*d*b.smallStep),38:g(+b.smallStep),35:h(b.max),36:h(b.min),33:g(+b.largeStep),34:g(-b.largeStep)},m.notify(c)},events:[A,B],options:{enabled:!0,min:0,max:10,smallStep:1,subject:"",label:"",required:!1,largeStep:5,orientation:"horizontal",tickPlacement:"both",tooltip:{enabled:!0,format:"{0}"}},_resize:function(){this._setTrackDivWidth(),this.wrapper.find(".k-slider-items").remove(),this._maxSelection=this._trackDiv[this._sizeFn](),this._sliderItemsInit(),this._refresh()},_sliderItemsInit:function(){var a=this,b=a.options,c=a._maxSelection/((b.max-b.min)/b.smallStep),d=a._calculateItemsWidth(w.floor(a._distance/b.smallStep));"none"!=b.tickPlacement&&c>=2&&(a._trackDiv.before(e(b,a._distance)),a._setItemsWidth(d),a._setItemsTitle()),a._calculateSteps(d),"none"!=b.tickPlacement&&c>=2&&b.largeStep>=b.smallStep&&a._setItemsLargeTick()},getSize:function(){return m.dimensions(this.wrapper)},_setTrackDivWidth:function(){var a=this,b=2*parseFloat(a._trackDiv.css(a._isRtl?"right":a._position),10);a._trackDiv[a._sizeFn](a.wrapper[a._sizeFn]()-2-b)},_setItemsWidth:function(b){var c,d=this,e=d.options,f=0,g=b.length-1,h=d.wrapper.find(P),i=0,j=2,k=h.length,l=0;for(c=0;k-2>c;c++){a(h[c+1])[d._sizeFn](b[c])}if(d._isHorizontal?(a(h[f]).addClass("k-first")[d._sizeFn](b[g-1]),a(h[g]).addClass("k-last")[d._sizeFn](b[g])):(a(h[g]).addClass("k-first")[d._sizeFn](b[g]),a(h[f]).addClass("k-last")[d._sizeFn](b[g-1])),d._distance%e.smallStep!==0&&!d._isHorizontal){for(c=0;c<b.length;c++){l+=b[c]}i=d._maxSelection-l,i+=parseFloat(d._trackDiv.css(d._position),10)+j,d.wrapper.find(".k-slider-items").css("padding-top",i)}},_setItemsTitle:function(){for(var b=this,c=b.options,d=b.wrapper.find(P),e=c.min,f=d.length,g=b._isHorizontal&&!b._isRtl?0:f-1,h=b._isHorizontal&&!b._isRtl?f:-1,i=b._isHorizontal&&!b._isRtl?1:-1;g-h!==0;g+=i){a(d[g]).attr("title",s(c.tooltip.format,j(e))),e+=c.smallStep}},_setItemsLargeTick:function(){var b,c,d=this,e=d.options,f=d.wrapper.find(P),g=0;if(1000*e.largeStep%(1000*e.smallStep)===0||d._distance/e.largeStep>=3){for(d._isHorizontal&&!d._isRtl&&(f=a.makeArray(f).reverse()),g=0;g<f.length;g++){b=a(f[g]),c=d._values[g],c%e.smallStep===0&&c%e.largeStep===0&&(b.addClass("k-tick-large").html("<span class='k-label'>"+b.attr("title")+"</span>"),0!==g&&g!==f.length-1&&b.css("line-height",b[d._sizeFn]()+"px"))}}},_calculateItemsWidth:function(a){var b,c,d,e=this,f=e.options,g=parseFloat(e._trackDiv.css(e._sizeFn))+1,h=g/e._distance;for(e._distance/f.smallStep-w.floor(e._distance/f.smallStep)>0&&(g-=e._distance%f.smallStep*h),b=g/a,c=[],d=0;a-1>d;d++){c[d]=b}return c[a-1]=c[a]=b/2,e._roundWidths(c)},_roundWidths:function(a){var b,c=0,d=a.length;for(b=0;d>b;b++){c+=a[b]-w.floor(a[b]),a[b]=w.floor(a[b])}return c=w.round(c),this._addAdditionalSize(c,a)},_addAdditionalSize:function(a,b){if(0===a){return b}var c,d=parseFloat(b.length-1)/parseFloat(1==a?a:a-1);for(c=0;a>c;c++){b[parseInt(w.round(d*c),10)]+=1}return b},_calculateSteps:function(a){var b,c=this,d=c.options,e=d.min,f=0,g=w.ceil(c._distance/d.smallStep),h=1;if(g+=c._distance/d.smallStep%1===0?1:0,a.splice(0,0,2*a[g-2]),a.splice(g-1,1,2*a.pop()),c._pixelSteps=[f],c._values=[e],0!==g){for(;g>h;){f+=(a[h-1]+a[h])/2,c._pixelSteps[h]=f,c._values[h]=e+=d.smallStep,h++}b=c._distance%d.smallStep===0?g-1:g,c._pixelSteps[b]=c._maxSelection,c._values[b]=d.max,c._isRtl&&(c._pixelSteps.reverse(),c._values.reverse())}},_getValueFromPosition:function(a,b){var c,d=this,e=d.options,f=w.max(e.smallStep*(d._maxSelection/d._distance),0),g=0,h=f/2;if(d._isHorizontal?(g=a-b.startPoint,d._isRtl&&(g=d._maxSelection-g)):g=b.startPoint-a,d._maxSelection-(parseInt(d._maxSelection%f,10)-3)/2<g){return e.max}for(c=0;c<d._pixelSteps.length;c++){if(w.abs(d._pixelSteps[c]-g)-1<=h){return j(d._values[c])}}},_getFormattedValue:function(a,b){var c,d,e,f=this,g="",h=f.options.tooltip;return v(a)?(d=a[0],e=a[1]):b&&b.type&&(d=b.selectionStart,e=b.selectionEnd),b&&(c=b.tooltipTemplate),!c&&h.template&&(c=m.template(h.template)),v(a)||b&&b.type?c?g=c({selectionStart:d,selectionEnd:e}):(d=s(h.format,d),e=s(h.format,e),g=d+" - "+e):(b&&(b.val=a),g=c?c({value:a}):s(h.format,a)),g},_getDraggableArea:function(){var a=this,b=m.getOffset(a._trackDiv);return{startPoint:a._isHorizontal?b.left:b.top+a._maxSelection,endPoint:a._isHorizontal?b.left+a._maxSelection:b.top}},_createHtml:function(){var a=this,b=a.element,e=a.options,g=b.find("input");2==g.length?(g.eq(0).val(e.selectionStart),g.eq(1).val(e.selectionEnd)):b.val(e.value),b.wrap(c(e,b,a._isHorizontal)).hide(),e.showBtn&&b.before(d(e,"increase",a._isHorizontal)).before(d(e,"decrease",a._isHorizontal)),b.before(f(e,b))},_focus:function(b){var c=this,d=b.target,e=c.value(),f=c._drag;f||(d==c.wrapper.find(N).eq(0)[0]?(f=c._firstHandleDrag,c._activeHandle=0):(f=c._lastHandleDrag,c._activeHandle=1),e=e[c._activeHandle]),a(d).addClass(R+" "+Q),f&&(c._activeHandleDrag=f,f.selectionStart=c.options.selectionStart,f.selectionEnd=c.options.selectionEnd,f._updateTooltip(e))},_focusWithMouse:function(b){b=a(b);var c=this,d=b.is(N)?b.index():0;window.setTimeout(function(){c.wrapper.find(N)[2==d?1:0].focus()},1),c._setTooltipTimeout()},_blur:function(b){var c=this,d=c._activeHandleDrag;a(b.target).removeClass(R+" "+Q),d&&(d._removeTooltip(),delete c._activeHandleDrag,delete c._activeHandle),null!=c.parentForm&&1==c.parentForm.options.autoValidatable&&c.validate()},validate:function(){var a=this,b=a.options,c=a.element,d=c.val(),e=m.getPluginLang();return b.required&&""==d?(a.showInfo(m.format(e.form.requiredInfo,b.subject)),!1):(a.hideInfo(c),!0)},_setTooltipTimeout:function(){var a=this;a._tooltipTimeout=window.setTimeout(function(){var b=a._drag||a._activeHandleDrag;b&&b._removeTooltip()},300)},_clearTooltipTimeout:function(){var a=this;window.clearTimeout(this._tooltipTimeout);var b=a._drag||a._activeHandleDrag;b&&b.tooltipDiv&&b.tooltipDiv.stop(!0,!1).css("opacity",1)}}),$=Z.extend({init:function(c,d){var e,f=this;c.type="text",d=r({},{value:k(c,"value"),min:k(c,"min"),max:k(c,"max"),smallStep:k(c,"step")},d),c=a(c),d&&d.enabled===b&&(d.enabled=!c.is("[disabled]")),Z.fn.init.call(f,c,d),d=f.options,l(d.value)&&null!==d.value||(d.value=d.min,c.val(d.min)),d.value=w.max(w.min(d.value,d.max),d.min),e=f.wrapper.find(N),new $.Selection(e,f,d),f._drag=new $.Drag(e,"",f,d)},options:{name:"Slider",showBtn:!0,increaseButtonTitle:n.slider.increaseButtonTitle,decreaseButtonTitle:n.slider.decreaseButtonTitle,dragHandleTitle:n.slider.dragHandleTitle,tooltip:{format:"{0:#,#.##}"},value:null},enable:function(b){var c,d,e=this,f=e.options;if(e.disable(),b!==!1){if(e.wrapper.removeClass(T).addClass(S),e.wrapper.find("input").removeAttr(V),c=function(b){var c=Y(b)[0];if(c){var d=e._isHorizontal?c.location.pageX:c.location.pageY,f=e._getDraggableArea(),g=a(b.target);if(g.hasClass("k-draghandle")){return void g.addClass(R+" "+Q)}e._update(e._getValueFromPosition(d,f)),e._focusWithMouse(b.target),e._drag.dragstart(b),b.preventDefault()}},e.wrapper.find(P+", "+O).on(E,c).end().on(E,function(){a(document.documentElement).one("selectstart",m.preventDefault)}).on(G,function(){e._drag._end()}),e.wrapper.find(N).attr(X,0).on(F,function(){e._setTooltipTimeout()}).on(J,function(a){e._focusWithMouse(a.target),a.preventDefault()}).on(L,u(e._focus,e)).on(M,u(e._blur,e)),d=u(function(a){var b=e._nextValueByIndex(e._valueIndex+1*a);e._setValueInRange(b),e._drag._updateTooltip(b)},e),f.showBtn){var g=u(function(a,b){this._clearTooltipTimeout(),(1===a.which||x.touch&&0===a.which)&&(d(b),this.timeout=setTimeout(u(function(){this.timer=setInterval(function(){d(b)},60)},this),200))},e);e.wrapper.find(".k-button").on(F,u(function(a){this._clearTimer(),e._focusWithMouse(a.target)},e)).on(K,function(b){a(b.currentTarget).addClass("k-state-hover")}).on("mouseout"+C,u(function(b){a(b.currentTarget).removeClass("k-state-hover"),this._clearTimer()},e)).eq(0).on(D,u(function(a){g(a,1)},e)).click(!1).end().eq(1).on(D,u(function(a){g(a,-1)},e)).click(m.preventDefault)}e.wrapper.find(N).off(I,!1).on(I,u(this._keydown,e)),f.enabled=!0}},disable:function(){var b=this;b.wrapper.removeClass(S).addClass(T),a(b.element).prop(V,V),b.wrapper.find(".k-button").off(D).on(D,m.preventDefault).off(F).on(F,m.preventDefault).off("mouseleave"+C).on("mouseleave"+C,m.preventDefault).off(K).on(K,m.preventDefault),b.wrapper.find(P+", "+O).off(E).off(G),b.wrapper.find(N).attr(X,-1).off(F).off(I).off(J).off(L).off(M),b.options.enabled=!1},_update:function(a){var b=this,c=b.value()!=a;b.value(a),c&&b.trigger(A,{value:b.options.value})},value:function(a){var b=this,c=b.options;return a=j(a),isNaN(a)?c.value:void (a>=c.min&&a<=c.max&&c.value!=a&&(b.element.prop("value",i(a)),c.value=a,b._refreshAriaAttr(a),b._refresh()))},_refresh:function(){this.trigger(H,{value:this.options.value})},_refreshAriaAttr:function(a){var b,c=this,d=c._drag;b=d&&d._tooltipDiv?d._tooltipDiv.text():c._getFormattedValue(a,null),this.wrapper.find(N).attr("aria-valuenow",a).attr("aria-valuetext",b)},_clearTimer:function(){clearTimeout(this.timeout),clearInterval(this.timer)},_keydown:function(a){var b=this;a.keyCode in b._keyMap&&(b._clearTooltipTimeout(),b._setValueInRange(b._keyMap[a.keyCode](b.options.value)),b._drag._updateTooltip(b.value()),a.preventDefault())},_setValueInRange:function(a){var b=this,c=b.options;return a=j(a),isNaN(a)?void b._update(c.min):(a=w.max(w.min(a,c.max),c.min),void b._update(a))},_nextValueByIndex:function(a){var b=this._values.length;return this._isRtl&&(a=b-1-a),this._values[w.max(0,w.min(a,b-1))]},destroy:function(){var a=this;o.fn.destroy.call(a),a.wrapper.off(C).find(".k-button").off(C).end().find(N).off(C).end().find(P+", "+O).off(C).end(),a._drag.draggable.destroy(),a._drag._removeTooltip(!0)}});$.Selection=function(a,b,c){function d(d){var e=d-c.min,f=b._valueIndex=w.ceil(j(e/c.smallStep)),g=parseInt(b._pixelSteps[f],10),h=b._trackDiv.find(".k-slider-selection"),i=parseInt(a[b._outerSize]()/2,10),k=b._isRtl?2:0;h[b._sizeFn](b._isRtl?b._maxSelection-g:g),a.css(b._position,g-i-k)}d(c.value),b.bind([A,B,H],function(a){d(parseFloat(a.value,10))})},$.Drag=function(a,b,c,d){var e=this;e.owner=c,e.options=d,e.element=a,e.type=b,e.draggable=new q(a,{distance:0,dragstart:u(e._dragstart,e),drag:u(e.drag,e),dragend:u(e.dragend,e),dragcancel:u(e.dragcancel,e)}),a.click(!1)},$.Drag.prototype={dragstart:function(a){this.owner._activeDragHandle=this,this.draggable.userEvents.cancel(),this.draggable.userEvents._start(a)},_dragstart:function(b){var c=this,d=c.owner,e=c.options;return e.enabled?(this.owner._activeDragHandle=this,d.element.off(K),c.element.addClass(R+" "+Q),a(document.documentElement).css("cursor","pointer"),c.dragableArea=d._getDraggableArea(),c.step=w.max(e.smallStep*(d._maxSelection/d._distance),0),c.type?(c.selectionStart=e.selectionStart,c.selectionEnd=e.selectionEnd,d._setZIndex(c.type)):c.oldVal=c.val=e.value,c._removeTooltip(!0),void c._createTooltip()):void b.preventDefault()},_createTooltip:function(){var b,c,d=this,e=d.owner,f=d.options.tooltip,g="",h=a(window);f.enabled&&(f.template&&(b=d.tooltipTemplate=m.template(f.template)),a(".k-slider-tooltip").remove(),d.tooltipDiv=a("<div class='k-widget k-tooltip k-slider-tooltip'><!-- --></div>").appendTo(document.body),g=e._getFormattedValue(d.val||e.value(),d),d.type||(c="k-callout-"+(e._isHorizontal?"s":"e"),d.tooltipInnerDiv="<div class='k-callout "+c+"'><!-- --></div>",g+=d.tooltipInnerDiv),d.tooltipDiv.html(g),d._scrollOffset={top:h.scrollTop(),left:h.scrollLeft()},d.moveTooltip())},drag:function(a){var b,c=this,d=c.owner,e=a.x.location,f=a.y.location,g=c.dragableArea.startPoint,h=c.dragableArea.endPoint;a.preventDefault(),c.val=d._isHorizontal?d._isRtl?c.constrainValue(e,g,h,h>e):c.constrainValue(e,g,h,e>=h):c.constrainValue(f,h,g,h>=f),c.oldVal!=c.val&&(c.oldVal=c.val,c.type?("firstHandle"==c.type?c.selectionStart=c.val<c.selectionEnd?c.val:c.selectionEnd=c.val:c.val>c.selectionStart?c.selectionEnd=c.val:c.selectionStart=c.selectionEnd=c.val,b={values:[c.selectionStart,c.selectionEnd],value:[c.selectionStart,c.selectionEnd]}):b={value:c.val},d.trigger(B,b)),c._updateTooltip(c.val)},_updateTooltip:function(a){var b=this,c=b.options,d=c.tooltip,e="";d.enabled&&(b.tooltipDiv||b._createTooltip(),e=b.owner._getFormattedValue(j(a),b),b.type||(e+=b.tooltipInnerDiv),b.tooltipDiv.html(e),b.moveTooltip())},dragcancel:function(){return this.owner._refresh(),a(document.documentElement).css("cursor",""),this._end()},dragend:function(){var b=this,c=b.owner;return a(document.documentElement).css("cursor",""),b.type?c._update(b.selectionStart,b.selectionEnd):(c._update(b.val),b.draggable.userEvents._disposeAll()),b._end()},_end:function(){var a=this,b=a.owner;return b._focusWithMouse(a.element),b.element.on(K),!1},_removeTooltip:function(b){var c=this,d=c.owner;c.tooltipDiv&&d.options.tooltip.enabled&&d.options.enabled&&(b?(c.tooltipDiv.remove(),c.tooltipDiv=null):c.tooltipDiv.fadeOut("slow",function(){a(this).remove(),c.tooltipDiv=null}))},moveTooltip:function(){var b,c,d,e,f=this,g=f.owner,h=0,i=0,j=f.element,k=m.getOffset(j),l=8,n=a(window),o=f.tooltipDiv.find(".k-callout"),p=f.tooltipDiv.outerWidth(),q=f.tooltipDiv.outerHeight();f.type?(b=g.wrapper.find(N),k=m.getOffset(b.eq(0)),c=m.getOffset(b.eq(1)),g._isHorizontal?(h=c.top,i=k.left+(c.left-k.left)/2):(h=k.top+(c.top-k.top)/2,i=c.left),e=b.eq(0).outerWidth()+2*l):(h=k.top,i=k.left,e=j.outerWidth()+2*l),g._isHorizontal?(i-=parseInt((p-j[g._outerSize]())/2,10),h-=q+o.height()+l):(h-=parseInt((q-j[g._outerSize]())/2,10),i-=p+o.width()+l),g._isHorizontal?(d=f._flip(h,q,e,n.outerHeight()+f._scrollOffset.top),h+=d,i+=f._fit(i,p,n.outerWidth()+f._scrollOffset.left)):(d=f._flip(i,p,e,n.outerWidth()+f._scrollOffset.left),h+=f._fit(h,q,n.outerHeight()+f._scrollOffset.top),i+=d),d>0&&o&&(o.removeClass(),o.addClass("k-callout k-callout-"+(g._isHorizontal?"n":"w"))),f.tooltipDiv.css({top:h,left:i})},_fit:function(a,b,c){var d=0;return a+b>c&&(d=c-(a+b)),0>a&&(d=-a),d},_flip:function(a,b,c,d){var e=0;return a+b>d&&(e+=-(c+b)),0>a+e&&(e+=c+b),e},constrainValue:function(a,b,c,d){var e=this,f=0;return f=a>b&&c>a?e.owner._getValueFromPosition(a,e.dragableArea):d?e.options.max:e.options.min}},m.ui.plugin($);var _=Z.extend({init:function(c,d){var e=this,f=a(c).find("input"),g=f.eq(0)[0],h=f.eq(1)[0];g.type="text",h.type="text",d=r({},{selectionStart:k(g,"value"),min:k(g,"min"),max:k(g,"max"),smallStep:k(g,"step")},{selectionEnd:k(h,"value"),min:k(h,"min"),max:k(h,"max"),smallStep:k(h,"step")},d),d&&d.enabled===b&&(d.enabled=!f.is("[disabled]")),Z.fn.init.call(e,c,d),d=e.options,l(d.selectionStart)&&null!==d.selectionStart||(d.selectionStart=d.min,f.eq(0).val(d.min)),l(d.selectionEnd)&&null!==d.selectionEnd||(d.selectionEnd=d.max,f.eq(1).val(d.max));
var i=e.wrapper.find(N);new _.Selection(i,e,d),e._firstHandleDrag=new $.Drag(i.eq(0),"firstHandle",e,d),e._lastHandleDrag=new $.Drag(i.eq(1),"lastHandle",e,d)},options:{name:"RangeSlider",leftDragHandleTitle:"drag",rightDragHandleTitle:"drag",tooltip:{format:"{0:#,#.##}"},selectionStart:null,selectionEnd:null},enable:function(b){var c,d=this,e=d.options;d.disable(),b!==!1&&(d.wrapper.removeClass(T).addClass(S),d.wrapper.find("input").removeAttr(V),c=function(b){var c=Y(b)[0];if(c){var f,g,h,i=d._isHorizontal?c.location.pageX:c.location.pageY,j=d._getDraggableArea(),k=d._getValueFromPosition(i,j),l=a(b.target);if(l.hasClass("k-draghandle")){return void l.addClass(R+" "+Q)}k<e.selectionStart?(f=k,g=e.selectionEnd,h=d._firstHandleDrag):k>d.selectionEnd?(f=e.selectionStart,g=k,h=d._lastHandleDrag):k-e.selectionStart<=e.selectionEnd-k?(f=k,g=e.selectionEnd,h=d._firstHandleDrag):(f=e.selectionStart,g=k,h=d._lastHandleDrag),h.dragstart(b),d._setValueInRange(f,g),d._focusWithMouse(h.element)}},d.wrapper.find(P+", "+O).on(E,c).end().on(E,function(){a(document.documentElement).one("selectstart",m.preventDefault)}).on(G,function(){d._activeDragHandle&&d._activeDragHandle._end()}),d.wrapper.find(N).attr(X,0).on(F,function(){d._setTooltipTimeout()}).on(J,function(a){d._focusWithMouse(a.target),a.preventDefault()}).on(L,u(d._focus,d)).on(M,u(d._blur,d)),d.wrapper.find(N).off(I,m.preventDefault).eq(0).on(I,u(function(a){this._keydown(a,"firstHandle")},d)).end().eq(1).on(I,u(function(a){this._keydown(a,"lastHandle")},d)),d.options.enabled=!0)},disable:function(){var a=this;a.wrapper.removeClass(S).addClass(T),a.wrapper.find("input").prop(V,V),a.wrapper.find(P+", "+O).off(E).off(G),a.wrapper.find(N).attr(X,-1).off(F).off(I).off(J).off(L).off(M),a.options.enabled=!1},_keydown:function(a,b){var c,d,e,f=this,g=f.options.selectionStart,h=f.options.selectionEnd;a.keyCode in f._keyMap&&(f._clearTooltipTimeout(),"firstHandle"==b?(e=f._activeHandleDrag=f._firstHandleDrag,g=f._keyMap[a.keyCode](g),g>h&&(h=g)):(e=f._activeHandleDrag=f._lastHandleDrag,h=f._keyMap[a.keyCode](h),g>h&&(g=h)),f._setValueInRange(g,h),c=Math.max(g,f.options.selectionStart),d=Math.min(h,f.options.selectionEnd),e.selectionEnd=Math.max(d,f.options.selectionStart),e.selectionStart=Math.min(c,f.options.selectionEnd),e._updateTooltip(f.value()[f._activeHandle]),a.preventDefault())},_update:function(a,b){var c=this,d=c.value(),e=d[0]!=a||d[1]!=b;c.value([a,b]),e&&c.trigger(A,{values:[a,b],value:[a,b]})},value:function(a){return a&&a.length?this._value(a[0],a[1]):this._value()},_value:function(a,b){var c=this,d=c.options,e=d.selectionStart,f=d.selectionEnd;return isNaN(a)&&isNaN(b)?[e,f]:(a=j(a),b=j(b),void (a>=d.min&&a<=d.max&&b>=d.min&&b<=d.max&&b>=a&&(e!=a||f!=b)&&(c.element.find("input").eq(0).prop("value",i(a)).end().eq(1).prop("value",i(b)),d.selectionStart=a,d.selectionEnd=b,c._refresh(),c._refreshAriaAttr(a,b))))},values:function(a,b){return v(a)?this._value(a[0],a[1]):this._value(a,b)},_refresh:function(){var a=this,b=a.options;a.trigger(H,{values:[b.selectionStart,b.selectionEnd],value:[b.selectionStart,b.selectionEnd]}),b.selectionStart==b.max&&b.selectionEnd==b.max&&a._setZIndex("firstHandle")},_refreshAriaAttr:function(a,b){var c,d=this,e=d.wrapper.find(N),f=d._activeHandleDrag;c=d._getFormattedValue([a,b],f),e.eq(0).attr("aria-valuenow",a),e.eq(1).attr("aria-valuenow",b),e.attr("aria-valuetext",c)},_setValueInRange:function(a,b){var c=this.options;a=w.max(w.min(a,c.max),c.min),b=w.max(w.min(b,c.max),c.min),a==c.max&&b==c.max&&this._setZIndex("firstHandle"),this._update(w.min(a,b),w.max(a,b))},_setZIndex:function(b){this.wrapper.find(N).each(function(c){a(this).css("z-index","firstHandle"==b?1-c:c)})},destroy:function(){var a=this;o.fn.destroy.call(a),a.wrapper.off(C).find(P+", "+O).off(C).end().find(N).off(C),a._firstHandleDrag.draggable.destroy(),a._lastHandleDrag.draggable.destroy()}});_.Selection=function(a,b,c){function d(d){d=d||[];var f=d[0]-c.min,g=d[1]-c.min,h=w.ceil(j(f/c.smallStep)),i=w.ceil(j(g/c.smallStep)),k=b._pixelSteps[h],l=b._pixelSteps[i],m=parseInt(a.eq(0)[b._outerSize]()/2,10),n=b._isRtl?2:0;a.eq(0).css(b._position,k-m-n).end().eq(1).css(b._position,l-m-n),e(k,l)}function e(a,c){var d,e,f=b._trackDiv.find(".k-slider-selection");d=w.abs(a-c),f[b._sizeFn](d),b._isRtl?(e=w.max(a,c),f.css("right",b._maxSelection-e-1)):(e=w.min(a,c),f.css(b._position,e-1))}d(b.value()),b.bind([A,B,H],function(a){d(a.values)})},m.ui.plugin(_)}(jQuery),function(a,b){function c(b){return a.map(d(b),function(a){return a.name}).join(", ")}function d(a){var b=a[0];return b.files?e(b.files):[{name:h(b.value),extension:g(b.value),size:null}]}function e(b){return a.map(b,function(a){return f(a)})}function f(a){var b=a.name||a.fileName;return{name:q.htmlEncode(b),extension:g(b),size:a.size||a.fileSize,rawFile:a}}function g(a){var b=a.match(u);return b?b[0]:""}function h(a){var b=a.lastIndexOf("\\");return -1!=b?a.substr(b+1):a}function i(a,b,c){if(b._supportsRemove()){var d=a.data("fileNames"),e=a.data("id");b._submitRemove(e,c,function(c,f,g){b._removeFileEntry(a),b._removeItem(e),b.trigger(y,{operation:"remove",files:d,response:c,XMLHttpRequest:g})},function(a){b.trigger(z,{operation:"remove",files:d,XMLHttpRequest:a}),s("Server response: "+a.responseText)})}}function j(b,c,d){var e=!1,f="";try{f=a.parseJSON(k(b)),e=!0}catch(g){d()}e&&c(f)}function k(a){return("undefined"==typeof a||""===a)&&(a="{}"),a}function l(a){a.stopPropagation(),a.preventDefault()}function m(a,b,c,d){var e,f;a.on("dragenter"+b,function(){c(),f=new Date,e||(e=setInterval(function(){var a=new Date-f;a>100&&(d(),clearInterval(e),e=null)},100))}).on("dragover"+b,function(){f=new Date})}function n(a){return a.is(".k-file-progress, .k-file-success, .k-file-error")}function o(b){return a(b.target).closest(".k-file")}function p(){var c={},d=a("meta[name=csrf-token]").attr("content"),e=a("meta[name=csrf-param]").attr("content");return a("input[name^='__RequestVerificationToken']").each(function(){c[this.name]=this.value}),e!==b&&d!==b&&(c[e]=d),c}var q=window.joy,r=q.ui.Widget,s=q.logToConsole,t=q.ui.FormElement,u=/\.([^\.]+)$/,v=".joyUpload",w="select",x="upload",y="success",z="error",A=(a.proxy,"complete"),B="cancel",C="progress",D=(new Array,q.getPluginLang()),E="remove",F="change",G=t.extend({init:function(b,c){var d=this;r.fn.init.call(d,b,c),d.name=b.name,d.multiple=d.options.multiple,d.localization=d.options.localization;var e=d.element;d.wrapper=e.closest(".k-upload"),0===d.wrapper.length&&(d.wrapper=d._wrapInput(e)),d._activeInput(e),d.toggle(d.options.enabled);var f=d._ns=v+"-"+q.guid();if(e.closest("form").on("submit"+f,a.proxy(d._onParentFormSubmit,d)).on("reset"+f,a.proxy(d._onParentFormReset,d)),d.options.async.saveUrl){d._module=d._supportsFormData()?new J(d):new I(d),d._async=!0;var g=d.options.files;g.length>0&&d._renderInitialFiles(g)}else{d._module=new H(d)}d._initFormElement(),d._supportsDrop()&&d._setupDropZone(),d.wrapper.on("click",".k-upload-action",a.proxy(d._onFileAction,d)).on("click",".k-upload-selected",a.proxy(d._onUploadSelected,d))},events:[w,x,y,z,A,B,C,E,F],options:{name:"Upload",enabled:!0,multiple:!0,showFileList:!0,autoValidatable:!0,template:"",allowType:"",maxSize:"",maxNameSize:"50",subject:"",label:"",required:!1,placeholder:"",files:[],async:{removeVerb:"POST",autoUpload:!0},localization:{select:D.upload.select,cancel:D.upload.cancel,retry:D.upload.retry,remove:D.upload.remove,uploadSelectedFiles:D.upload.uploadSelectedFiles,dropFilesHere:D.upload.dropFilesHere,statusUploading:D.upload.statusUploading,statusUploaded:D.upload.statusUploaded,statusWarning:D.upload.statusWarning,statusFailed:D.upload.statusFailed,headerStatusUploading:D.upload.headerStatusUploading,headerStatusUploaded:D.upload.headerStatusUploaded}},setOptions:function(a){var b=this,c=b.element;r.fn.setOptions.call(b,a),b.multiple=b.options.multiple,c.attr("multiple",b._supportsMultiple()?b.multiple:!1),b.toggle(b.options.enabled)},enable:function(a){a="undefined"==typeof a?!0:a,this.toggle(a)},disable:function(){this.toggle(!1)},value:function(a){return a!=b&&(this.items=a),this.items},_reflash:function(){a(".k-upload-files",this.wrapper).remove(),a(".k-dropzone",this.wrapper).find("strong").remove(),this.wrapper.addClass("k-upload-empty"),this._hideHeaderUploadstatus(),this._hideUploadButton(),this.items=""},_change:function(a){var b=this,a=b.value();a!==b._oldValue&&(b._oldValue=a,b.trigger(F),b.element.trigger(F))},_removeItem:function(a){for(var b=this.items,c=b.split(","),d="",e="",f=0;f<c.length;f++){c[f]!=a&&(d=d+e+c[f],e=",")}this.items=d,this._change()},toggle:function(a){a="undefined"==typeof a?a:!a,this.wrapper.toggleClass("k-state-disabled",a),this.element.prop("disabled",a)},destroy:function(){var b=this;a(document).add(a(".k-dropzone",b.wrapper)).add(b.wrapper.closest("form")).off(b._ns),a(b.element).off(v),r.fn.destroy.call(b)},_addInput:function(b){if(b[0].nodeType){var c=this,d=b.clone().val("");d.insertAfter(c.element).data("joyUpload",c),a(c.element).hide().removeAttr("id").off(v),c._activeInput(d)}},_activeInput:function(b){var c=this,d=c.wrapper;c.element=b,b.attr("multiple",c._supportsMultiple()?c.multiple:!1).attr("autocomplete","off").on("click"+v,function(a){d.hasClass("k-state-disabled")&&a.preventDefault()}).on("focus"+v,function(){a(this).parent().addClass("k-state-focused")}).on("blur"+v,function(){a(this).parent().removeClass("k-state-focused")}).on("change"+v,a.proxy(c._onInputChange,c))},_onInputChange:function(b){var c=this,e=a(b.target),f=c.trigger(w,{files:d(e)}),g=d(e);return c._validate(g)?void (f?(c._addInput(e),e.remove()):c._module.onSelect(b)):!1},_onDrop:function(b){var c=b.originalEvent.dataTransfer,d=this,f=c.files;l(b);var g=e(f);if(!d._validate(g)){return !1}if(f.length>0){var h=d.trigger(w,{files:e(f)});h||d._module.onSelect({target:a(".k-dropzone",d.wrapper)},f)}},_validate:function(a){for(var b=this.options.maxNameSize,c=this.options.maxSize,d=this.options.allowType,e=0;e<a.length;e++){if(file=a[e],!file.name){return !1}if(""!=b){var f=q.getByteLength(file.name)-q.getByteLength(file.extension);if(f>b){return q.showMessage(D.upload.maxNameSize+b,"error"),!1}}if(""!=c&&1024*c*1024<file.size){return q.showMessage(D.upload.maxSize+c+"M","error"),!1}if(""!=d){for(var g=d.split(","),h=!1,i=0;i<g.length;i++){"."+g[i].toLowerCase()==file.extension.toLowerCase()&&(h=!0)}if(!h){return q.showMessage(D.upload.allowType+d,"error"),!1}}}return !0},_renderInitialFiles:function(b){var c=this,d=0;for(d=0;d<b.length;d++){var e=b[d],f=c._enqueueFile(e.name,{fileNames:[e]});f.addClass("k-file-success").data("files",[b[d]]),a(".k-progress",f).width("100%"),a(".k-upload-status",f).prepend("<span class='k-upload-pct'>100%</span>"),c._fileAction(f,E)}},_prepareTemplateData:function(a,b){var c=b.fileNames,d={},e=0,f=0;for(f=0;f<c.length;f++){e+=c[f].size}return d.name=a,d.size=e,d.files=b.fileNames,d},_prepareDefaultFileEntryTemplate:function(b,c){var d="",e=a("<li class='k-file'><span class='k-progress'></span><span class='k-icon'></span><span class='k-filename' title='"+b+"'>"+b+"</span><strong class='k-upload-status'></strong></li>");return 1==c.fileNames.length&&c.fileNames[0].extension&&(d=c.fileNames[0].extension.substring(1),a(".k-icon",e).addClass("k-i-"+d)),e},_enqueueFile:function(b,c){var d,e,f,g=this,h=a(".k-upload-files",g.wrapper),i=g.options,j=i.template;return 0===h.length&&(h=a("<ul class='k-upload-files k-reset'></ul>").appendTo(g.wrapper),g.options.showFileList||h.hide(),g.wrapper.removeClass("k-upload-empty")),d=a(".k-file",h),j?(f=g._prepareTemplateData(b,c),j=q.template(j),e=a("<li class='k-file'>"+j(f)+"</li>"),e.find(".k-upload-action").addClass("k-button k-button-bare")):e=g._prepareDefaultFileEntryTemplate(b,c),e.appendTo(h).data(c),g._async||a(".k-progress",e).width("100%"),!g.multiple&&d.length>0&&g._module.onRemove({target:a(d,g.wrapper)}),e},_removeFileEntry:function(b){var c,d,e=this,f=b.closest(".k-upload-files");b.remove(),c=a(".k-file",f),d=a(".k-file-success, .k-file-error",f),d.length===c.length&&this._hideUploadButton(),0===c.length&&(f.remove(),e.wrapper.addClass("k-upload-empty"),e._hideHeaderUploadstatus())},_fileAction:function(a,b){var c={remove:"k-delete",cancel:"k-cancel",retry:"k-retry"},d={remove:"k-i-close",cancel:"k-i-close",retry:"k-i-refresh"};c.hasOwnProperty(b)&&(this._clearFileAction(a),this.options.template?a.find(".k-upload-action").addClass("k-button k-button-bare").append("<span class='k-icon "+d[b]+" "+c[b]+"' title='"+this.localization[b]+"'></span>").show():(a.find(".k-upload-status .k-upload-action").remove(),a.find(".k-upload-status").append(this._renderAction(c[b],this.localization[b],d[b]))))},_fileState:function(b,c){var d=this.localization,e={uploading:{text:d.statusUploading},uploaded:{text:d.statusUploaded},failed:{text:d.statusFailed}},f=e[c];f&&a(".k-icon:not(.k-delete, .k-cancel, .k-retry)",b).text(f.text)},_renderAction:function(b,c,d){return a(""!==b?"<button type='button' class='k-button k-button-bare k-upload-action'><span class='k-icon "+d+" "+b+"' title='"+c+"'></span></button>":"<button type='button' class='k-button'>"+c+"</button>")},_clearFileAction:function(b){a(".k-upload-action",b).empty().hide()},_onFileAction:function(b){var c=this;if(!c.wrapper.hasClass("k-state-disabled")){var d=a(b.target).closest(".k-upload-action"),e=d.find(".k-icon"),f=d.closest(".k-file"),g={files:f.data("fileNames")};e.hasClass("k-delete")?c.trigger(E,g)||c._module.onRemove({target:a(f,c.wrapper)},g.data):e.hasClass("k-cancel")?(c.trigger(B,g),c._module.onCancel({target:a(f,c.wrapper)}),this._checkAllComplete(),c._updateHeaderUploadStatus()):e.hasClass("k-retry")&&(a(".k-warning",f).remove(),c._module.onRetry({target:a(f,c.wrapper)}))}return !1},validate:function(){var a=this,b=a.options,c=a.element,d=a.value(),e=q.getPluginLang();return b.required&&""==d?(a.showInfo(q.format(e.form.requiredInfo,b.subject)),!1):(a.hideInfo(c),!0)},setSaveUrl:function(a){this.options.async.saveUrl=a},_onUploadSelected:function(){return this._module.onSaveSelected(),!1},_onFileProgress:function(b,c){var d;this.options.template?a(".k-progress",b.target).width(c+"%"):(d=a(".k-upload-pct",b.target),0===d.length&&a(".k-upload-status",b.target).prepend("<span class='k-upload-pct'></span>"),a(".k-upload-pct",b.target).text(c+"%"),a(".k-progress",b.target).width(c+"%")),this.trigger(C,{files:o(b).data("fileNames"),percentComplete:c})},_onUploadSuccess:function(a,b,c){b.success&&(b=b.resultObject),this.value(null!=this.value()&&""!=this.value()?this.value()+","+b:b),this._change();var d=o(a);this._fileState(d,"uploaded"),d.removeClass("k-file-progress").addClass("k-file-success"),this._updateHeaderUploadStatus(),d.data("id",b),this.trigger(y,{files:d.data("fileNames"),response:b,operation:"upload",XMLHttpRequest:c}),this._supportsRemove()?this._fileAction(d,E):this._clearFileAction(d),this._checkAllComplete()},_onUploadError:function(b,c){var d=o(b),e=a(".k-upload-pct",d);this._fileState(d,"failed"),d.removeClass("k-file-progress").addClass("k-file-error"),a(".k-progress",d).width("100%"),e.length>0?e.empty().removeClass("k-upload-pct").addClass("k-icon k-warning"):a(".k-upload-status",d).prepend("<span class='k-icon k-warning'></span>"),this._updateHeaderUploadStatus(),this._fileAction(d,"retry"),this.trigger(z,{operation:"upload",files:d.data("fileNames"),XMLHttpRequest:c}),s("Server response: "+c.responseText),this._checkAllComplete()},_showUploadButton:function(){var b=a(".k-upload-selected",this.wrapper);0===b.length&&(b=this._renderAction("",this.localization.uploadSelectedFiles).addClass("k-upload-selected")),this.wrapper.append(b)},_hideUploadButton:function(){a(".k-upload-selected",this.wrapper).remove()},_showHeaderUploadStatus:function(){var b=this.localization,c=a(".k-dropzone",this.wrapper),d=a(".k-upload-status-total",this.wrapper);0!==d.length&&d.remove(),d='<strong class="k-upload-status k-upload-status-total">'+b.headerStatusUploading+'<span class="k-icon k-loading">'+b.statusUploading+"</span></strong>",c.length>0?c.append(d):a(".k-upload-button",this.wrapper).after(d)},_updateHeaderUploadStatus:function(){var b,c,d,e=this,f=e.localization,g=a(".k-file",e.wrapper).not(".k-file-success, .k-file-error");0===g.length&&(b=a(".k-file.k-file-error",e.wrapper),c=a(".k-upload-status-total",e.wrapper),d=a(".k-icon",c).removeClass("k-loading").addClass(0!==b.length?"k-warning":"k-i-tick").text(0!==b.length?f.statusWarning:f.statusUploaded),c.text(e.localization.headerStatusUploaded).append(d))},_hideHeaderUploadstatus:function(){a(".k-upload-status-total",this.wrapper).remove()},_onParentFormSubmit:function(){var b=this,c=b.element;if("undefined"!=typeof this._module.onAbort&&this._module.onAbort(),!c.value){var d=a(c);d.attr("disabled","disabled"),window.setTimeout(function(){d.removeAttr("disabled")},0)}},_onParentFormReset:function(){a(".k-upload-files",this.wrapper).remove()},_supportsFormData:function(){return"undefined"!=typeof FormData},_supportsMultiple:function(){var a=this._userAgent().indexOf("Windows")>-1;return !(q.support.browser.opera||q.support.browser.safari&&a)},_supportsDrop:function(){var a=this._userAgent().toLowerCase(),b=/chrome/.test(a),c=!b&&/safari/.test(a),d=c&&/windows/.test(a);return !d&&this._supportsFormData()&&this.options.async.saveUrl},_userAgent:function(){return navigator.userAgent},_setupDropZone:function(){var b=this;a(".k-upload-button",this.wrapper).wrap("<div class='k-dropzone'></div>");var c=b._ns,d=a(".k-dropzone",b.wrapper).append(a("<em>"+b.localization.dropFilesHere+"</em>")).on("dragenter"+c,l).on("dragover"+c,function(a){a.preventDefault()}).on("drop"+c,a.proxy(this._onDrop,this));m(d,c,function(){d.addClass("k-dropzone-hovered")},function(){d.removeClass("k-dropzone-hovered")}),m(a(document),c,function(){d.addClass("k-dropzone-active"),d.closest(".k-upload").removeClass("k-upload-empty")},function(){d.removeClass("k-dropzone-active"),0===a("li.k-file",d.closest(".k-upload")).length&&d.closest(".k-upload").addClass("k-upload-empty")})},_supportsRemove:function(){return !!this.options.async.removeUrl},_submitRemove:function(b,c,d,e){var f=this,g=f.options.async.removeField||"id",h=a.extend(c,p());h[g]=b,jQuery.ajax({type:this.options.async.removeVerb,dataType:"json",dataFilter:k,url:this.options.async.removeUrl,traditional:!0,data:h,success:d,error:e})},_wrapInput:function(a){var b=this,c=b.options;return a.wrap("<div class='k-widget k-upload k-header'><div class='k-button k-upload-button'></div></div>"),c.async.saveUrl||a.closest(".k-upload").addClass("k-upload-sync"),a.closest(".k-upload").addClass("k-upload-empty"),a.closest(".k-button").append("<span>"+this.localization.select+"</span>"),a.closest(".k-upload")},_checkAllComplete:function(){0===a(".k-file.k-file-progress",this.wrapper).length&&this.trigger(A)}}),H=function(a){this.name="syncUploadModule",this.element=a.wrapper,this.upload=a,this.element.closest("form").attr("enctype","multipart/form-data").attr("encoding","multipart/form-data")};H.prototype={onSelect:function(b){var e=this.upload,f=a(b.target);e._addInput(f);var g=e._enqueueFile(c(f),{relatedInput:f,fileNames:d(f)});e._fileAction(g,E)},onRemove:function(a){var b=o(a);b.data("relatedInput").remove(),this.upload._removeFileEntry(b)}};var I=function(a){this.name="iframeUploadModule",this.element=a.wrapper,this.upload=a,this.iframes=[]};G._frameId=0,I.prototype={onSelect:function(b){var c=this.upload,d=a(b.target),e=this.prepareUpload(d);c.options.async.autoUpload?this.performUpload(e):(c._supportsRemove()&&this.upload._fileAction(e,E),c._showUploadButton())},prepareUpload:function(b){var e=this.upload,f=a(e.element),g=e.options.async.saveField||b.attr("name");e._addInput(b),b.attr("name",g);var h=this.createFrame(e.name+"_"+G._frameId++);this.registerFrame(h);var i=this.createForm(e.options.async.saveUrl,h.attr("name")).append(f),j=e._enqueueFile(c(b),{frame:h,relatedInput:f,fileNames:d(b),id:""});return h.data({form:i,file:j}),j},performUpload:function(b){var c={files:b.data("fileNames")},d=b.data("frame"),e=this.upload;if(e.trigger(x,c)){e._removeFileEntry(d.data("file")),this.cleanupFrame(d),this.unregisterFrame(d)}else{e._hideUploadButton(),e._showHeaderUploadStatus(),d.appendTo(document.body);var f=d.data("form").attr("action",e.options.async.saveUrl).appendTo(document.body);c.data=a.extend({},c.data,p());for(var g in c.data){var h=f.find("input[name='"+g+"']");0===h.length&&(h=a("<input>",{type:"hidden",name:g}).appendTo(f)),h.val(c.data[g])}e._fileAction(b,B),e._fileState(b,"uploading"),a(b).addClass("k-file-progress"),d.one("load",a.proxy(this.onIframeLoad,this)),f[0].submit()}},onSaveSelected:function(){var b=this;a(".k-file",this.element).each(function(){var c=a(this),d=n(c);d||b.performUpload(c)})},onIframeLoad:function(b){var c,d=a(b.target);try{c=d.contents().text()}catch(e){c="Error trying to get server response: "+e}this.processResponse(d,c)},processResponse:function(b,c){var d=b.data("file"),e=this,f={responseText:c};j(c,function(c){a.extend(f,{statusText:"OK",status:"200"}),e.upload._onFileProgress({target:a(d,e.upload.wrapper)},100),e.upload._onUploadSuccess({target:a(d,e.upload.wrapper)},c,f),e.cleanupFrame(b),e.unregisterFrame(b)},function(){a.extend(f,{statusText:"error",status:"500"}),e.upload._onUploadError({target:a(d,e.upload.wrapper)},f)})},onCancel:function(b){var c=a(b.target).data("frame");this.stopFrameSubmit(c),this.cleanupFrame(c),this.unregisterFrame(c),this.upload._removeFileEntry(c.data("file"))},onRetry:function(a){var b=o(a);this.performUpload(b)},onRemove:function(a,b){var c=o(a),d=c.data("frame");d?(this.unregisterFrame(d),this.upload._removeFileEntry(c),this.cleanupFrame(d)):i(c,this.upload,b)},onAbort:function(){var b=this.element,c=this;a.each(this.iframes,function(){a("input",this.data("form")).appendTo(b),c.stopFrameSubmit(this[0]),this.data("form").remove(),this.remove()}),this.iframes=[]},createFrame:function(b){return a("<iframe name='"+b+"' id='"+b+"' style='display:none;' />")},createForm:function(b,c){return a("<form enctype='multipart/form-data' method='POST' action='"+b+"' target='"+c+"'/>")},stopFrameSubmit:function(a){"undefined"!=typeof a.stop?a.stop():a.document&&a.document.execCommand("Stop")},registerFrame:function(a){this.iframes.push(a)},unregisterFrame:function(b){this.iframes=a.grep(this.iframes,function(a){return a.attr("name")!=b.attr("name")})},cleanupFrame:function(a){var b=a.data("form");a.data("file").data("frame",null),setTimeout(function(){b.remove(),a.remove()},1)}};var J=function(a){this.name="formDataUploadModule",this.element=a.wrapper,this.upload=a};J.prototype={onSelect:function(b,c){var d=this.upload,f=this,g=a(b.target),h=c?e(c):this.inputFiles(g),i=this.prepareUpload(g,h);a.each(i,function(){d.options.async.autoUpload?f.performUpload(this):(d._supportsRemove()&&d._fileAction(this,E),d._showUploadButton())})},prepareUpload:function(b,c){var d=this.enqueueFiles(c);return b.is("input")&&(a.each(d,function(){a(this).data("relatedInput",b)}),b.data("relatedFileEntries",d),this.upload._addInput(b)),d},enqueueFiles:function(b){var c,d,e,f,g=this.upload,h=b.length,i=[];if(g.options.async.batch===!0){c=a.map(b,function(a){return a.name}).join(", "),f=g._enqueueFile(c,{fileNames:b}),f.data("files",b),i.push(f)}else{for(d=0;h>d;d++){e=b[d],c=e.name,f=g._enqueueFile(c,{fileNames:[e]}),f.data("files",[e]),i.push(f)}}return i},inputFiles:function(a){return d(a)},performUpload:function(b){var c=this.upload,d=this.createFormData(b.data("files")),e=new XMLHttpRequest,f={files:b.data("fileNames"),XMLHttpRequest:e};if(c.trigger(x,f)){this.removeFileEntry(b)}else{c._fileAction(b,B),c._hideUploadButton(),c._showHeaderUploadStatus(),f.data=a.extend({},f.data,p());for(var g in f.data){d.append(g,f.data[g])}c._fileState(b,"uploading"),a(b).addClass("k-file-progress"),this.postFormData(c.options.async.saveUrl,d,b,e)}},onSaveSelected:function(){var b=this;a(".k-file",this.element).each(function(){var c=a(this),d=n(c);d||b.performUpload(c)})},onCancel:function(a){var b=o(a);this.stopUploadRequest(b),this.removeFileEntry(b)},onRetry:function(a){var b=o(a);this.performUpload(b)},onRemove:function(a,b){var c=o(a);c.hasClass("k-file-success")?i(c,this.upload,b):this.removeFileEntry(c)},postFormData:function(a,b,c,d){var e=this;c.data("request",d),d.addEventListener("load",function(a){e.onRequestSuccess.call(e,a,c)},!1),d.addEventListener(z,function(a){e.onRequestError.call(e,a,c)},!1),d.upload.addEventListener("progress",function(a){e.onRequestProgress.call(e,a,c)},!1),d.open("POST",a,!0),d.withCredentials="true",d.send(b)},createFormData:function(a){var b,c=new FormData,d=this.upload,e=a.length;for(b=0;e>b;b++){c.append(d.options.async.saveField||d.name,a[b].rawFile)}return c},onRequestSuccess:function(b,c){function d(){f.upload._onUploadError({target:a(c,f.upload.wrapper)},e)}var e=b.target,f=this;e.status>=200&&e.status<=299?j(e.responseText,function(b){b.success?(f.upload._onFileProgress({target:a(c,f.upload.wrapper)},100),f.upload._onUploadSuccess({target:a(c,f.upload.wrapper)},b.resultObject,e),f.cleanupFileEntry(c)):(q.showMessage(result.resultObject,"error"),d())},d):d()},onRequestError:function(b,c){var d=b.target;this.upload._onUploadError({target:a(c,this.upload.wrapper)},d)},cleanupFileEntry:function(b){var c=b.data("relatedInput"),d=!0;c&&(a.each(c.data("relatedFileEntries")||[],function(){this.parent().length>0&&this[0]!=b[0]&&(d=d&&this.hasClass("k-file-success"))}),d&&c.remove())},removeFileEntry:function(a){this.cleanupFileEntry(a),this.upload._removeFileEntry(a)},onRequestProgress:function(b,c){var d=Math.round(100*b.loaded/b.total);this.upload._onFileProgress({target:a(c,this.upload.wrapper)},d)},stopUploadRequest:function(a){a.data("request").abort()}},q.ui.plugin(G)}(jQuery),function(a,b){function c(a,b,c){return c?b.substring(0,a).split(c).length-1:0}function d(a,b,d){return b.split(d)[c(a,b,d)]}function e(a,b,d,e){var f=b.split(e);return f.splice(c(a,b,e),1,d),e&&""!==f[f.length-1]&&f.push(""),f.join(e)}var f=window.joy,g=(f.getPluginLang(),f.support),h=f.caret,i=f._activeElement,j=g.placeholder,k=f.ui,l=k.List,m=f.keys,n=f.data.DataSource,o="aria-disabled",p="aria-readonly",q="k-state-default",r="disabled",s="readonly",t="k-state-focused",u="k-state-selected",v="k-state-disabled",w="k-state-hover",x=".joyAutoComplete",y="mouseenter"+x+" mouseleave"+x,z=a.proxy,A=l.extend({init:function(b,c){var d,e=this;e.ns=x,c=a.isArray(c)?{dataSource:c}:c,l.fn.init.call(e,b,c),b=e.element,c=e.options,c.placeholder=c.placeholder||b.attr("placeholder"),j&&b.attr("placeholder",c.placeholder),e._wrapper(),e._loader(),e._dataSource(),e._ignoreCase(),b[0].type="text",d=e.wrapper,e._popup(),b.addClass("k-input").on("keydown"+x,z(e._keydown,e)).on("paste"+x,z(e._search,e)).on("focus"+x,function(){e._prev=e._accessor(),e._placeholder(!1),d.addClass(t)}).on("blur"+x,function(){e._change(),e._placeholder(),d.removeClass(t),e._blur()}).attr({autocomplete:"off",role:"textbox","aria-haspopup":!0}),e._enable(),e._old=e._accessor(),b[0].id&&b.attr("aria-owns",e.ul[0].id),e._aria(),e._placeholder(),f.notify(e)},options:{name:"AutoComplete",enabled:!0,suggest:!1,template:"",dataTextField:"",minLength:1,delay:200,height:200,filter:"startswith",ignoreCase:!0,highlightFirst:!1,separator:null,placeholder:"",animation:{},maxByte:"",minByte:"",required:!1,subject:"",value:null},_dataSource:function(){var a=this;a.dataSource&&a._refreshHandler?a._unbindDataSource():(a._refreshHandler=z(a.refresh,a),a._progressHandler=z(a._showBusy,a)),a.dataSource=n.create(a.options.dataSource).bind("change",a._refreshHandler).bind("progress",a._progressHandler)},setDataSource:function(a){this.options.dataSource=a,this._dataSource()},events:["open","close","change","select","dataBinding","dataBound"],setOptions:function(a){l.fn.setOptions.call(this,a),this._template(),this._accessors(),this._aria()},_editable:function(a){var b=this,c=b.element,d=b.wrapper.off(x),e=a.readonly,f=a.disable;e||f?(d.addClass(f?v:q).removeClass(f?q:v),c.attr(r,f).attr(s,e).attr(o,f).attr(p,e)):(d.addClass(q).removeClass(v).on(y,b._toggleHover),c.removeAttr(r).removeAttr(s).attr(o,!1).attr(p,!1))},close:function(){var a=this,b=a._current;b&&b.removeClass(u),a.current(null),a.popup.close()},destroy:function(){var a=this;a.element.off(x),a.wrapper.off(x),l.fn.destroy.call(a)},refresh:function(){var c,d=this,e=d.ul[0],g=d.popup,h=d.options,j=d._data(),k=j.length;d.trigger("dataBinding"),e.innerHTML=f.render(d.template,j),d._height(k),g.visible()&&g._position(),k&&(h.highlightFirst&&d.current(a(e.firstChild)),h.suggest&&d.suggest(a(e.firstChild))),d._open&&(d._open=!1,c=k?"open":"close",d._typing&&d.element[0]!==i()&&(c="close"),g[c](),d._typing=b),d._touchScroller&&d._touchScroller.reset(),d._makeUnselectable(),d._hideBusy(),d.trigger("dataBound")},select:function(a){this._select(a)},search:function(a){var b,c=this,e=c.options,f=e.ignoreCase,g=e.separator;a=a||c._accessor(),c._current=null,clearTimeout(c._typing),g&&(a=d(h(c.element)[0],a,g)),b=a.length,b?b>=c.options.minLength&&(c._open=!0,c._filterSource({value:f?a.toLowerCase():a,operator:e.filter,field:e.dataTextField,ignoreCase:f})):c.popup.close()},suggest:function(a){var d,e=this,f=e._last,g=e._accessor(),j=e.element[0],k=h(j)[0],n=e.options.separator,o=g.split(n),p=c(k,g,n),q=k;return f==m.BACKSPACE||f==m.DELETE?void (e._last=b):(a=a||"","string"!=typeof a&&(d=l.inArray(a[0],e.ul[0]),a=d>-1?e._text(e._data()[d]):""),0>=k&&(k=g.toLowerCase().indexOf(a.toLowerCase())+1),d=g.substring(0,k).lastIndexOf(n),d=d>-1?k-(d+n.length):k,g=o[p].substring(0,d),a&&(d=a.toLowerCase().indexOf(g.toLowerCase()),d>-1&&(a=a.substring(d+g.length),q=k+a.length,g+=a),n&&""!==o[o.length-1]&&o.push("")),o[p]=g,e._accessor(o.join(n||"")),void (j===i()&&h(j,k,q)))},value:function(a){return a===b?this._accessor():(this._accessor(a),void (this._old=a))},_accessor:function(a){var c=this,d=c.element[0];return a===b?(a=d.value,d.className.indexOf("k-readonly")>-1&&a===c.options.placeholder?"":a):(d.value=null===a?"":a,void c._placeholder())},_accept:function(a){var b=this.element;this._focus(a),h(b,b.val().length)},_keydown:function(b){var c=this,d=c.ul[0],e=b.keyCode,f=c._current,g=c.popup.visible();c._last=e,e===m.DOWN?(g&&c._move(f?f.next():a(d.firstChild)),b.preventDefault()):e===m.UP?(g&&c._move(f?f.prev():a(d.lastChild)),b.preventDefault()):e===m.ENTER||e===m.TAB?(e===m.ENTER&&c.popup.visible()&&b.preventDefault(),c._accept(f)):e===m.ESC?(c.popup.visible()&&b.preventDefault(),c.close()):c._search()},_move:function(a){var b=this;a=a[0]?a:null,b.current(a),b.options.suggest&&b.suggest(a)},_hideBusy:function(){var a=this;clearTimeout(a._busy),a._loading.hide(),a.element.attr("aria-busy",!1),a._busy=null},_showBusy:function(){var a=this;a._busy||(a._busy=setTimeout(function(){a.element.attr("aria-busy",!0),a._loading.show()},100))},_placeholder:function(a){if(!j){var c,d=this,e=d.element,f=d.options.placeholder;if(f){if(c=e.val(),a===b&&(a=!c),a||(f=c!==f?c:""),c===d._old&&!a){return}e.toggleClass("k-readonly",a).val(f),f||e[0]!==document.activeElement||h(e[0],0,0)}}},_search:function(){var a=this;clearTimeout(a._typing),a._typing=setTimeout(function(){a._prev!==a._accessor()&&(a._prev=a._accessor(),a.search())},a.options.delay)},_select:function(b){var c,d,f=this,g=f.options.separator,i=f._data();b=a(b),b[0]&&!b.hasClass(u)&&(d=l.inArray(b[0],f.ul[0]),d>-1&&(i=i[d],c=f._text(i),g&&(c=e(h(f.element)[0],f._accessor(),c,g)),f._accessor(c),f._prev=f._accessor(),f.current(b.addClass(u))))},_loader:function(){this._loading=a('<span class="k-icon k-loading" style="display:none"></span>').insertAfter(this.element)},_toggleHover:function(b){a(b.currentTarget).toggleClass(w,"mouseenter"===b.type)},_wrapper:function(){var a,b=this,c=b.element,d=c[0];a=c.parent(),a.is("span.k-widget")||(a=c.wrap("<span />").parent()),a.attr("tabindex",-1),a.attr("role","presentation"),a[0].style.cssText=d.style.cssText,c.css({width:"100%",height:d.style.height}),b._focused=b.element,b.wrapper=a.addClass("k-widget k-autocomplete k-header").addClass(d.className)
},_blur:function(){var a=this,b=a.element.data("joyFormObject");b&&1==b.options.autoValidatable&&a.validate()},validate:function(){var a=this,b=a.options,c=a.element,d=c.val(),e=f.getPluginLang(),g=a.element.data("joyFormObject");if(b.required&&""==d){return g.showInfo(c,a.wrapper,f.format(e.form.requiredInfo,b.subject)),!1}var h=f.getByteLength(c.val());return""!=b.minByte&&h<parseInt(b.minByte)?(g.showInfo(c,a.wrapper,f.format(e.form.minByteInfo,b.minByte,h)),!1):""!=b.maxByte&&h>parseInt(b.maxByte)?(g.showInfo(c,a.wrapper,f.format(e.form.maxByteInfo,b.maxByte,h)),!1):(g.hideInfo(c),!0)}});k.plugin(A)}(jQuery);